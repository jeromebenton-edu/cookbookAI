2026-01-12 16:57:05,225 [INFO] Using v3 label taxonomy: 10 labels
2026-01-12 16:57:05,225 [INFO] Loading dataset from data/datasets/boston_layoutlmv3_v3/dataset_dict...
2026-01-12 16:57:05,258 [INFO] Dataset loaded:
2026-01-12 16:57:05,258 [INFO]   train: 463 examples
2026-01-12 16:57:05,258 [INFO]   validation: 92 examples
2026-01-12 16:57:05,258 [INFO]   test: 61 examples
2026-01-12 16:57:05,258 [INFO]   demo_eval: 7 examples
2026-01-12 16:57:05,258 [INFO] Initializing LayoutLMv3 processor and model...
/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Some weights of LayoutLMv3ForTokenClassification were not initialized from the model checkpoint at microsoft/layoutlmv3-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2026-01-12 16:57:06,544 [INFO] Model initialized with 10 labels
2026-01-12 16:57:06,544 [INFO] Computing class weights from training data...
2026-01-12 16:57:07,543 [INFO] Class weights computed:
2026-01-12 16:57:07,544 [INFO]   PAGE_HEADER         : weight=5.05, count=2193
2026-01-12 16:57:07,544 [INFO]   SECTION_HEADER      : weight=481.77, count=22
2026-01-12 16:57:07,544 [INFO]   RECIPE_TITLE        : weight=6.22, count=1781
2026-01-12 16:57:07,544 [INFO]   INGREDIENT_LINE     : weight=0.62, count=18009
2026-01-12 16:57:07,544 [INFO]   INSTRUCTION_STEP    : weight=0.81, count=13691
2026-01-12 16:57:07,544 [INFO]   TIME                : weight=11080.60, count=0
2026-01-12 16:57:07,544 [INFO]   TEMP                : weight=481.77, count=22
2026-01-12 16:57:07,544 [INFO]   SERVINGS            : weight=357.44, count=30
2026-01-12 16:57:07,544 [INFO]   NOTE                : weight=11080.60, count=0
2026-01-12 16:57:07,544 [INFO]   O                   : weight=0.15, count=75058
/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2026-01-12 16:57:08,354 [INFO] Starting training...
  0%|          | 0/2320 [00:00<?, ?it/s]/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 1/2320 [00:01<1:13:05,  1.89s/it]  0%|          | 2/2320 [00:02<46:25,  1.20s/it]    0%|          | 3/2320 [00:03<37:56,  1.02it/s]  0%|          | 4/2320 [00:04<34:37,  1.11it/s]  0%|          | 5/2320 [00:04<31:51,  1.21it/s]  0%|          | 6/2320 [00:05<29:55,  1.29it/s]  0%|          | 7/2320 [00:06<28:47,  1.34it/s]  0%|          | 8/2320 [00:06<27:49,  1.38it/s]  0%|          | 9/2320 [00:07<27:19,  1.41it/s]  0%|          | 10/2320 [00:08<27:09,  1.42it/s]  0%|          | 11/2320 [00:08<26:49,  1.43it/s]  1%|          | 12/2320 [00:09<26:57,  1.43it/s]  1%|          | 13/2320 [00:10<27:32,  1.40it/s]  1%|          | 14/2320 [00:11<27:33,  1.39it/s]  1%|          | 15/2320 [00:11<27:03,  1.42it/s]  1%|          | 16/2320 [00:12<26:52,  1.43it/s]  1%|          | 17/2320 [00:13<26:53,  1.43it/s]  1%|          | 18/2320 [00:13<26:43,  1.44it/s]  1%|          | 19/2320 [00:14<26:27,  1.45it/s]  1%|          | 20/2320 [00:15<26:37,  1.44it/s]  1%|          | 21/2320 [00:15<26:59,  1.42it/s]  1%|          | 22/2320 [00:16<26:33,  1.44it/s]  1%|          | 23/2320 [00:17<26:28,  1.45it/s]  1%|          | 24/2320 [00:17<26:25,  1.45it/s]  1%|          | 25/2320 [00:18<26:12,  1.46it/s]  1%|          | 26/2320 [00:19<26:25,  1.45it/s]  1%|          | 27/2320 [00:20<26:45,  1.43it/s]  1%|          | 28/2320 [00:20<26:28,  1.44it/s]  1%|â–         | 29/2320 [00:21<26:35,  1.44it/s]  1%|â–         | 30/2320 [00:22<26:48,  1.42it/s]  1%|â–         | 31/2320 [00:22<26:36,  1.43it/s]  1%|â–         | 32/2320 [00:23<26:54,  1.42it/s]  1%|â–         | 33/2320 [00:24<27:32,  1.38it/s]  1%|â–         | 34/2320 [00:25<26:59,  1.41it/s]  2%|â–         | 35/2320 [00:25<27:10,  1.40it/s]  2%|â–         | 36/2320 [00:26<27:18,  1.39it/s]  2%|â–         | 37/2320 [00:27<27:11,  1.40it/s]  2%|â–         | 38/2320 [00:27<27:06,  1.40it/s]  2%|â–         | 39/2320 [00:28<26:40,  1.43it/s]  2%|â–         | 40/2320 [00:29<26:52,  1.41it/s]  2%|â–         | 41/2320 [00:29<26:56,  1.41it/s]  2%|â–         | 42/2320 [00:30<27:17,  1.39it/s]  2%|â–         | 43/2320 [00:31<27:00,  1.41it/s]  2%|â–         | 44/2320 [00:32<26:47,  1.42it/s]  2%|â–         | 45/2320 [00:32<26:27,  1.43it/s]  2%|â–         | 46/2320 [00:33<26:06,  1.45it/s]  2%|â–         | 47/2320 [00:34<26:28,  1.43it/s]  2%|â–         | 48/2320 [00:34<26:31,  1.43it/s]  2%|â–         | 49/2320 [00:35<26:22,  1.44it/s]  2%|â–         | 50/2320 [00:36<26:33,  1.42it/s]                                                   2%|â–         | 50/2320 [00:36<26:33,  1.42it/s]  2%|â–         | 51/2320 [00:36<26:24,  1.43it/s]  2%|â–         | 52/2320 [00:37<26:27,  1.43it/s]  2%|â–         | 53/2320 [00:38<26:42,  1.41it/s]  2%|â–         | 54/2320 [00:39<26:49,  1.41it/s]  2%|â–         | 55/2320 [00:39<26:29,  1.42it/s]  2%|â–         | 56/2320 [00:40<26:27,  1.43it/s]  2%|â–         | 57/2320 [00:41<26:22,  1.43it/s]  2%|â–Ž         | 58/2320 [00:41<26:22,  1.43it/s]  3%|â–Ž         | 59/2320 [00:42<26:17,  1.43it/s]  3%|â–Ž         | 60/2320 [00:43<26:12,  1.44it/s]  3%|â–Ž         | 61/2320 [00:44<26:23,  1.43it/s]  3%|â–Ž         | 62/2320 [00:44<26:16,  1.43it/s]  3%|â–Ž         | 63/2320 [00:45<26:20,  1.43it/s]  3%|â–Ž         | 64/2320 [00:46<26:23,  1.42it/s]  3%|â–Ž         | 65/2320 [00:46<26:39,  1.41it/s]  3%|â–Ž         | 66/2320 [00:47<26:26,  1.42it/s]  3%|â–Ž         | 67/2320 [00:48<26:23,  1.42it/s]  3%|â–Ž         | 68/2320 [00:48<26:36,  1.41it/s]  3%|â–Ž         | 69/2320 [00:49<26:58,  1.39it/s]  3%|â–Ž         | 70/2320 [00:50<27:05,  1.38it/s]  3%|â–Ž         | 71/2320 [00:51<26:49,  1.40it/s]  3%|â–Ž         | 72/2320 [00:52<31:05,  1.21it/s]  3%|â–Ž         | 73/2320 [00:52<29:24,  1.27it/s]  3%|â–Ž         | 74/2320 [00:53<28:40,  1.31it/s]  3%|â–Ž         | 75/2320 [00:54<27:33,  1.36it/s]  3%|â–Ž         | 76/2320 [00:55<28:00,  1.34it/s]  3%|â–Ž         | 77/2320 [00:55<27:17,  1.37it/s]  3%|â–Ž         | 78/2320 [00:56<26:52,  1.39it/s]  3%|â–Ž         | 79/2320 [00:57<26:40,  1.40it/s]  3%|â–Ž         | 80/2320 [00:57<26:16,  1.42it/s]  3%|â–Ž         | 81/2320 [00:58<26:42,  1.40it/s]  4%|â–Ž         | 82/2320 [00:59<26:23,  1.41it/s]  4%|â–Ž         | 83/2320 [01:00<27:07,  1.37it/s]  4%|â–Ž         | 84/2320 [01:00<26:49,  1.39it/s]  4%|â–Ž         | 85/2320 [01:01<26:40,  1.40it/s]  4%|â–Ž         | 86/2320 [01:02<27:09,  1.37it/s]  4%|â–         | 87/2320 [01:03<27:52,  1.34it/s]  4%|â–         | 88/2320 [01:03<27:49,  1.34it/s]  4%|â–         | 89/2320 [01:04<27:29,  1.35it/s]  4%|â–         | 90/2320 [01:05<27:24,  1.36it/s]  4%|â–         | 91/2320 [01:05<27:04,  1.37it/s]  4%|â–         | 92/2320 [01:06<26:48,  1.38it/s]  4%|â–         | 93/2320 [01:07<26:48,  1.38it/s]  4%|â–         | 94/2320 [01:08<26:51,  1.38it/s]  4%|â–         | 95/2320 [01:08<27:11,  1.36it/s]  4%|â–         | 96/2320 [01:09<27:12,  1.36it/s]  4%|â–         | 97/2320 [01:10<27:24,  1.35it/s]  4%|â–         | 98/2320 [01:11<27:06,  1.37it/s]  4%|â–         | 99/2320 [01:11<27:02,  1.37it/s]  4%|â–         | 100/2320 [01:12<27:02,  1.37it/s]                                                    4%|â–         | 100/2320 [01:12<27:02,  1.37it/s]  4%|â–         | 101/2320 [01:13<27:29,  1.35it/s]  4%|â–         | 102/2320 [01:13<26:58,  1.37it/s]  4%|â–         | 103/2320 [01:14<26:59,  1.37it/s]  4%|â–         | 104/2320 [01:15<26:48,  1.38it/s]  5%|â–         | 105/2320 [01:16<26:46,  1.38it/s]  5%|â–         | 106/2320 [01:16<26:45,  1.38it/s]  5%|â–         | 107/2320 [01:17<26:33,  1.39it/s]  5%|â–         | 108/2320 [01:18<27:07,  1.36it/s]  5%|â–         | 109/2320 [01:19<27:05,  1.36it/s]  5%|â–         | 110/2320 [01:19<26:52,  1.37it/s]  5%|â–         | 111/2320 [01:20<26:40,  1.38it/s]  5%|â–         | 112/2320 [01:21<26:29,  1.39it/s]  5%|â–         | 113/2320 [01:21<26:16,  1.40it/s]  5%|â–         | 114/2320 [01:22<26:16,  1.40it/s]  5%|â–         | 115/2320 [01:23<25:45,  1.43it/s]  5%|â–Œ         | 116/2320 [01:23<23:08,  1.59it/s]{'loss': 1.9801, 'grad_norm': 5.0130791664123535, 'learning_rate': 1.0775862068965516e-05, 'epoch': 0.43}
{'loss': 1.6899, 'grad_norm': 6.732377052307129, 'learning_rate': 2.1551724137931033e-05, 'epoch': 0.86}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.80it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.11it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.47it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.22it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.12it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.00it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.92it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.82it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.84it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.84it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.83it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.82it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.82it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.82it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.82it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.84it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.83it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.89it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.84it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.84it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.83it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.25it/s][A                                                  
                                               [A  5%|â–Œ         | 116/2320 [01:32<23:08,  1.59it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.25it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  5%|â–Œ         | 117/2320 [01:38<2:53:08,  4.72s/it]  5%|â–Œ         | 118/2320 [01:38<2:08:57,  3.51s/it]  5%|â–Œ         | 119/2320 [01:39<1:38:05,  2.67s/it]  5%|â–Œ         | 120/2320 [01:40<1:16:42,  2.09s/it]  5%|â–Œ         | 121/2320 [01:40<1:01:44,  1.68s/it]  5%|â–Œ         | 122/2320 [01:41<51:07,  1.40s/it]    5%|â–Œ         | 123/2320 [01:42<43:52,  1.20s/it]  5%|â–Œ         | 124/2320 [01:43<38:44,  1.06s/it]  5%|â–Œ         | 125/2320 [01:43<35:02,  1.04it/s]  5%|â–Œ         | 126/2320 [01:44<32:46,  1.12it/s]  5%|â–Œ         | 127/2320 [01:45<30:57,  1.18it/s]  6%|â–Œ         | 128/2320 [01:46<30:02,  1.22it/s]  6%|â–Œ         | 129/2320 [01:46<29:05,  1.26it/s]  6%|â–Œ         | 130/2320 [01:47<28:24,  1.28it/s]  6%|â–Œ         | 131/2320 [01:48<27:48,  1.31it/s]  6%|â–Œ         | 132/2320 [01:48<27:26,  1.33it/s]  6%|â–Œ         | 133/2320 [01:49<27:20,  1.33it/s]  6%|â–Œ         | 134/2320 [01:50<27:01,  1.35it/s]  6%|â–Œ         | 135/2320 [01:51<26:43,  1.36it/s]  6%|â–Œ         | 136/2320 [01:51<26:28,  1.38it/s]  6%|â–Œ         | 137/2320 [01:52<26:16,  1.38it/s]  6%|â–Œ         | 138/2320 [01:53<26:12,  1.39it/s]  6%|â–Œ         | 139/2320 [01:54<26:07,  1.39it/s]  6%|â–Œ         | 140/2320 [01:54<26:40,  1.36it/s]  6%|â–Œ         | 141/2320 [01:55<26:34,  1.37it/s]  6%|â–Œ         | 142/2320 [01:56<26:41,  1.36it/s]  6%|â–Œ         | 143/2320 [01:57<26:45,  1.36it/s]  6%|â–Œ         | 144/2320 [01:57<26:24,  1.37it/s]  6%|â–‹         | 145/2320 [01:58<26:04,  1.39it/s]  6%|â–‹         | 146/2320 [01:59<25:56,  1.40it/s]  6%|â–‹         | 147/2320 [01:59<26:03,  1.39it/s]  6%|â–‹         | 148/2320 [02:00<25:50,  1.40it/s]  6%|â–‹         | 149/2320 [02:01<25:53,  1.40it/s]  6%|â–‹         | 150/2320 [02:01<25:48,  1.40it/s]                                                    6%|â–‹         | 150/2320 [02:02<25:48,  1.40it/s]  7%|â–‹         | 151/2320 [02:02<26:08,  1.38it/s]  7%|â–‹         | 152/2320 [02:03<26:16,  1.37it/s]  7%|â–‹         | 153/2320 [02:04<25:55,  1.39it/s]  7%|â–‹         | 154/2320 [02:04<25:56,  1.39it/s]  7%|â–‹         | 155/2320 [02:05<26:03,  1.38it/s]  7%|â–‹         | 156/2320 [02:06<25:58,  1.39it/s]  7%|â–‹         | 157/2320 [02:07<26:07,  1.38it/s]  7%|â–‹         | 158/2320 [02:07<26:57,  1.34it/s]  7%|â–‹         | 159/2320 [02:08<26:56,  1.34it/s]  7%|â–‹         | 160/2320 [02:09<27:13,  1.32it/s]  7%|â–‹         | 161/2320 [02:10<26:46,  1.34it/s]  7%|â–‹         | 162/2320 [02:10<26:40,  1.35it/s]  7%|â–‹         | 163/2320 [02:11<26:49,  1.34it/s]  7%|â–‹         | 164/2320 [02:12<26:27,  1.36it/s]  7%|â–‹         | 165/2320 [02:13<26:23,  1.36it/s]  7%|â–‹         | 166/2320 [02:13<26:03,  1.38it/s]  7%|â–‹         | 167/2320 [02:14<26:11,  1.37it/s]  7%|â–‹         | 168/2320 [02:15<26:07,  1.37it/s]  7%|â–‹         | 169/2320 [02:15<25:58,  1.38it/s]  7%|â–‹         | 170/2320 [02:16<27:06,  1.32it/s]  7%|â–‹         | 171/2320 [02:17<27:37,  1.30it/s]  7%|â–‹         | 172/2320 [02:18<27:30,  1.30it/s]  7%|â–‹         | 173/2320 [02:19<27:11,  1.32it/s]  8%|â–Š         | 174/2320 [02:19<27:06,  1.32it/s]  8%|â–Š         | 175/2320 [02:20<26:59,  1.32it/s]  8%|â–Š         | 176/2320 [02:21<27:12,  1.31it/s]  8%|â–Š         | 177/2320 [02:22<27:19,  1.31it/s]  8%|â–Š         | 178/2320 [02:22<27:39,  1.29it/s]  8%|â–Š         | 179/2320 [02:23<27:25,  1.30it/s]  8%|â–Š         | 180/2320 [02:24<27:37,  1.29it/s]  8%|â–Š         | 181/2320 [02:25<27:17,  1.31it/s]  8%|â–Š         | 182/2320 [02:25<26:53,  1.32it/s]  8%|â–Š         | 183/2320 [02:26<27:15,  1.31it/s]  8%|â–Š         | 184/2320 [02:27<27:19,  1.30it/s]  8%|â–Š         | 185/2320 [02:28<27:05,  1.31it/s]  8%|â–Š         | 186/2320 [02:28<26:46,  1.33it/s]  8%|â–Š         | 187/2320 [02:29<26:30,  1.34it/s]  8%|â–Š         | 188/2320 [02:30<26:33,  1.34it/s]  8%|â–Š         | 189/2320 [02:31<26:57,  1.32it/s]  8%|â–Š         | 190/2320 [02:32<27:34,  1.29it/s]  8%|â–Š         | 191/2320 [02:32<27:31,  1.29it/s]  8%|â–Š         | 192/2320 [02:33<27:01,  1.31it/s]  8%|â–Š         | 193/2320 [02:34<26:43,  1.33it/s]  8%|â–Š         | 194/2320 [02:35<27:22,  1.29it/s]  8%|â–Š         | 195/2320 [02:35<27:14,  1.30it/s]  8%|â–Š         | 196/2320 [02:36<26:47,  1.32it/s]  8%|â–Š         | 197/2320 [02:37<26:38,  1.33it/s]  9%|â–Š         | 198/2320 [02:38<26:51,  1.32it/s]  9%|â–Š         | 199/2320 [02:38<26:26,  1.34it/s]  9%|â–Š         | 200/2320 [02:39<26:23,  1.34it/s]                                                    9%|â–Š         | 200/2320 [02:39<26:23,  1.34it/s]  9%|â–Š         | 201/2320 [02:40<26:31,  1.33it/s]  9%|â–Š         | 202/2320 [02:41<26:17,  1.34it/s]  9%|â–‰         | 203/2320 [02:41<26:42,  1.32it/s]  9%|â–‰         | 204/2320 [02:42<26:39,  1.32it/s]  9%|â–‰         | 205/2320 [02:43<26:09,  1.35it/s]  9%|â–‰         | 206/2320 [02:44<25:57,  1.36it/s]  9%|â–‰         | 207/2320 [02:44<25:55,  1.36it/s]  9%|â–‰         | 208/2320 [02:45<26:25,  1.33it/s]  9%|â–‰         | 209/2320 [02:46<26:49,  1.31it/s]  9%|â–‰         | 210/2320 [02:47<26:46,  1.31it/s]  9%|â–‰         | 211/2320 [02:47<26:42,  1.32it/s]  9%|â–‰         | 212/2320 [02:48<26:57,  1.30it/s]  9%|â–‰         | 213/2320 [02:49<26:45,  1.31it/s]  9%|â–‰         | 214/2320 [02:50<26:24,  1.33it/s]  9%|â–‰         | 215/2320 [02:50<26:06,  1.34it/s]  9%|â–‰         | 216/2320 [02:51<26:15,  1.34it/s]  9%|â–‰         | 217/2320 [02:52<26:11,  1.34it/s]  9%|â–‰         | 218/2320 [02:53<26:07,  1.34it/s]  9%|â–‰         | 219/2320 [02:53<26:43,  1.31it/s]  9%|â–‰         | 220/2320 [02:54<27:00,  1.30it/s] 10%|â–‰         | 221/2320 [02:55<26:53,  1.30it/s] 10%|â–‰         | 222/2320 [02:56<26:21,  1.33it/s] 10%|â–‰         | 223/2320 [02:56<26:38,  1.31it/s] 10%|â–‰         | 224/2320 [02:57<26:17,  1.33it/s] 10%|â–‰         | 225/2320 [02:58<26:14,  1.33it/s] 10%|â–‰         | 226/2320 [02:59<25:55,  1.35it/s] 10%|â–‰         | 227/2320 [02:59<26:10,  1.33it/s] 10%|â–‰         | 228/2320 [03:00<25:58,  1.34it/s] 10%|â–‰         | 229/2320 [03:01<25:53,  1.35it/s] 10%|â–‰         | 230/2320 [03:02<25:49,  1.35it/s] 10%|â–‰         | 231/2320 [03:02<25:15,  1.38it/s] 10%|â–ˆ         | 232/2320 [03:03<22:39,  1.54it/s]{'eval_loss': 1.4609827995300293, 'eval_precision': 0.7510322047894302, 'eval_recall': 0.2508446528304489, 'eval_f1': 0.37607897865302115, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'INGREDIENT_LINE': {'precision': 0.3430200977729495, 'recall': 0.48614318706697457, 'f1-score': 0.40222929936305735, 'support': 2598.0}, 'INSTRUCTION_STEP': {'precision': 0.8482142857142857, 'recall': 0.1994960100797984, 'f1-score': 0.32301938116286977, 'support': 11905.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.33719892952720787, 'recall': 0.711452149992761, 'f1-score': 0.45754189944134077, 'support': 6907.0}, 'accuracy': 0.3994395142456796, 'macro avg': {'precision': 0.21834761614492043, 'recall': 0.1995844781627906, 'f1-score': 0.1689700828524668, 'support': 21410.0}, 'weighted avg': {'precision': 0.6220546609849191, 'recall': 0.3994395142456796, 'f1-score': 0.37602892816116434, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [12, 0, 0, 1263, 176, 0, 1147], [0, 0, 0, 1018, 2375, 0, 8512], [0, 0, 0, 0, 0, 0, 0], [201, 1, 133, 1401, 249, 8, 4914]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 9940, 'INSTRUCTION_STEP': 9489, 'INGREDIENT_LINE': 2767}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.6516, 'eval_samples_per_second': 10.634, 'eval_steps_per_second': 2.658, 'epoch': 1.0}
{'loss': 1.5064, 'grad_norm': 4.092883586883545, 'learning_rate': 3.232758620689655e-05, 'epoch': 1.29}
{'loss': 1.4333, 'grad_norm': 3.9589407444000244, 'learning_rate': 4.3103448275862066e-05, 'epoch': 1.72}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.55it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.07it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.47it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.11it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.09it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.08it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.98it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.90it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.88it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.86it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.86it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.81it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.81it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.77it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.78it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.77it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.77it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.80it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.80it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.81it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.18it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.62it/s][A                                                  
                                               [A 10%|â–ˆ         | 232/2320 [03:12<22:39,  1.54it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.62it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 10%|â–ˆ         | 233/2320 [03:18<2:58:49,  5.14s/it] 10%|â–ˆ         | 234/2320 [03:19<2:12:35,  3.81s/it] 10%|â–ˆ         | 235/2320 [03:20<1:40:20,  2.89s/it] 10%|â–ˆ         | 236/2320 [03:21<1:17:53,  2.24s/it] 10%|â–ˆ         | 237/2320 [03:21<1:02:05,  1.79s/it] 10%|â–ˆ         | 238/2320 [03:22<51:30,  1.48s/it]   10%|â–ˆ         | 239/2320 [03:23<43:32,  1.26s/it] 10%|â–ˆ         | 240/2320 [03:24<38:04,  1.10s/it] 10%|â–ˆ         | 241/2320 [03:24<34:24,  1.01it/s] 10%|â–ˆ         | 242/2320 [03:25<31:19,  1.11it/s] 10%|â–ˆ         | 243/2320 [03:26<29:25,  1.18it/s] 11%|â–ˆ         | 244/2320 [03:26<28:18,  1.22it/s] 11%|â–ˆ         | 245/2320 [03:27<27:36,  1.25it/s] 11%|â–ˆ         | 246/2320 [03:28<26:34,  1.30it/s] 11%|â–ˆ         | 247/2320 [03:29<25:52,  1.33it/s] 11%|â–ˆ         | 248/2320 [03:29<25:26,  1.36it/s] 11%|â–ˆ         | 249/2320 [03:30<24:55,  1.38it/s] 11%|â–ˆ         | 250/2320 [03:31<25:02,  1.38it/s]                                                   11%|â–ˆ         | 250/2320 [03:31<25:02,  1.38it/s] 11%|â–ˆ         | 251/2320 [03:32<25:31,  1.35it/s] 11%|â–ˆ         | 252/2320 [03:32<25:14,  1.37it/s] 11%|â–ˆ         | 253/2320 [03:33<24:56,  1.38it/s] 11%|â–ˆ         | 254/2320 [03:34<24:49,  1.39it/s] 11%|â–ˆ         | 255/2320 [03:34<24:59,  1.38it/s] 11%|â–ˆ         | 256/2320 [03:35<24:51,  1.38it/s] 11%|â–ˆ         | 257/2320 [03:36<24:48,  1.39it/s] 11%|â–ˆ         | 258/2320 [03:37<24:58,  1.38it/s] 11%|â–ˆ         | 259/2320 [03:37<25:18,  1.36it/s] 11%|â–ˆ         | 260/2320 [03:38<25:55,  1.32it/s] 11%|â–ˆâ–        | 261/2320 [03:39<25:58,  1.32it/s] 11%|â–ˆâ–        | 262/2320 [03:40<26:14,  1.31it/s] 11%|â–ˆâ–        | 263/2320 [03:40<26:09,  1.31it/s] 11%|â–ˆâ–        | 264/2320 [03:41<26:16,  1.30it/s] 11%|â–ˆâ–        | 265/2320 [03:42<25:58,  1.32it/s] 11%|â–ˆâ–        | 266/2320 [03:43<25:40,  1.33it/s] 12%|â–ˆâ–        | 267/2320 [03:43<25:43,  1.33it/s] 12%|â–ˆâ–        | 268/2320 [03:44<26:16,  1.30it/s] 12%|â–ˆâ–        | 269/2320 [03:45<26:28,  1.29it/s] 12%|â–ˆâ–        | 270/2320 [03:46<26:53,  1.27it/s] 12%|â–ˆâ–        | 271/2320 [03:47<27:08,  1.26it/s] 12%|â–ˆâ–        | 272/2320 [03:47<27:30,  1.24it/s] 12%|â–ˆâ–        | 273/2320 [03:48<27:32,  1.24it/s] 12%|â–ˆâ–        | 274/2320 [03:49<27:09,  1.26it/s] 12%|â–ˆâ–        | 275/2320 [03:50<26:38,  1.28it/s] 12%|â–ˆâ–        | 276/2320 [03:51<26:55,  1.26it/s] 12%|â–ˆâ–        | 277/2320 [03:51<26:54,  1.27it/s] 12%|â–ˆâ–        | 278/2320 [03:52<26:47,  1.27it/s] 12%|â–ˆâ–        | 279/2320 [03:53<27:14,  1.25it/s] 12%|â–ˆâ–        | 280/2320 [03:54<27:26,  1.24it/s] 12%|â–ˆâ–        | 281/2320 [03:55<27:09,  1.25it/s] 12%|â–ˆâ–        | 282/2320 [03:55<27:07,  1.25it/s] 12%|â–ˆâ–        | 283/2320 [03:56<26:39,  1.27it/s] 12%|â–ˆâ–        | 284/2320 [03:57<26:11,  1.30it/s] 12%|â–ˆâ–        | 285/2320 [03:58<26:37,  1.27it/s] 12%|â–ˆâ–        | 286/2320 [03:59<27:02,  1.25it/s] 12%|â–ˆâ–        | 287/2320 [03:59<27:29,  1.23it/s] 12%|â–ˆâ–        | 288/2320 [04:00<27:26,  1.23it/s] 12%|â–ˆâ–        | 289/2320 [04:01<26:34,  1.27it/s] 12%|â–ˆâ–Ž        | 290/2320 [04:02<27:03,  1.25it/s] 13%|â–ˆâ–Ž        | 291/2320 [04:03<27:19,  1.24it/s] 13%|â–ˆâ–Ž        | 292/2320 [04:03<26:44,  1.26it/s] 13%|â–ˆâ–Ž        | 293/2320 [04:04<26:30,  1.27it/s] 13%|â–ˆâ–Ž        | 294/2320 [04:05<26:17,  1.28it/s] 13%|â–ˆâ–Ž        | 295/2320 [04:06<26:28,  1.27it/s] 13%|â–ˆâ–Ž        | 296/2320 [04:06<26:15,  1.28it/s] 13%|â–ˆâ–Ž        | 297/2320 [04:07<26:10,  1.29it/s] 13%|â–ˆâ–Ž        | 298/2320 [04:08<26:20,  1.28it/s] 13%|â–ˆâ–Ž        | 299/2320 [04:09<26:16,  1.28it/s] 13%|â–ˆâ–Ž        | 300/2320 [04:10<26:12,  1.28it/s]                                                   13%|â–ˆâ–Ž        | 300/2320 [04:10<26:12,  1.28it/s] 13%|â–ˆâ–Ž        | 301/2320 [04:10<26:26,  1.27it/s] 13%|â–ˆâ–Ž        | 302/2320 [04:11<26:12,  1.28it/s] 13%|â–ˆâ–Ž        | 303/2320 [04:12<26:23,  1.27it/s] 13%|â–ˆâ–Ž        | 304/2320 [04:13<26:22,  1.27it/s] 13%|â–ˆâ–Ž        | 305/2320 [04:13<25:55,  1.30it/s] 13%|â–ˆâ–Ž        | 306/2320 [04:14<26:15,  1.28it/s] 13%|â–ˆâ–Ž        | 307/2320 [04:15<26:11,  1.28it/s] 13%|â–ˆâ–Ž        | 308/2320 [04:16<26:01,  1.29it/s] 13%|â–ˆâ–Ž        | 309/2320 [04:17<25:54,  1.29it/s] 13%|â–ˆâ–Ž        | 310/2320 [04:17<26:29,  1.26it/s] 13%|â–ˆâ–Ž        | 311/2320 [04:18<26:20,  1.27it/s] 13%|â–ˆâ–Ž        | 312/2320 [04:19<26:08,  1.28it/s] 13%|â–ˆâ–Ž        | 313/2320 [04:20<26:02,  1.28it/s] 14%|â–ˆâ–Ž        | 314/2320 [04:20<25:48,  1.30it/s] 14%|â–ˆâ–Ž        | 315/2320 [04:21<26:18,  1.27it/s] 14%|â–ˆâ–Ž        | 316/2320 [04:22<26:07,  1.28it/s] 14%|â–ˆâ–Ž        | 317/2320 [04:23<25:55,  1.29it/s] 14%|â–ˆâ–Ž        | 318/2320 [04:24<25:45,  1.30it/s] 14%|â–ˆâ–        | 319/2320 [04:24<25:31,  1.31it/s] 14%|â–ˆâ–        | 320/2320 [04:25<25:28,  1.31it/s] 14%|â–ˆâ–        | 321/2320 [04:26<25:38,  1.30it/s] 14%|â–ˆâ–        | 322/2320 [04:27<26:03,  1.28it/s] 14%|â–ˆâ–        | 323/2320 [04:28<26:09,  1.27it/s] 14%|â–ˆâ–        | 324/2320 [04:28<25:57,  1.28it/s] 14%|â–ˆâ–        | 325/2320 [04:29<25:50,  1.29it/s] 14%|â–ˆâ–        | 326/2320 [04:30<25:50,  1.29it/s] 14%|â–ˆâ–        | 327/2320 [04:31<25:18,  1.31it/s] 14%|â–ˆâ–        | 328/2320 [04:31<25:15,  1.31it/s] 14%|â–ˆâ–        | 329/2320 [04:32<25:32,  1.30it/s] 14%|â–ˆâ–        | 330/2320 [04:33<25:45,  1.29it/s] 14%|â–ˆâ–        | 331/2320 [04:34<26:06,  1.27it/s] 14%|â–ˆâ–        | 332/2320 [04:34<25:52,  1.28it/s] 14%|â–ˆâ–        | 333/2320 [04:35<25:52,  1.28it/s] 14%|â–ˆâ–        | 334/2320 [04:36<26:25,  1.25it/s] 14%|â–ˆâ–        | 335/2320 [04:37<26:38,  1.24it/s] 14%|â–ˆâ–        | 336/2320 [04:38<26:05,  1.27it/s] 15%|â–ˆâ–        | 337/2320 [04:38<26:00,  1.27it/s] 15%|â–ˆâ–        | 338/2320 [04:39<25:40,  1.29it/s] 15%|â–ˆâ–        | 339/2320 [04:40<25:22,  1.30it/s] 15%|â–ˆâ–        | 340/2320 [04:41<25:22,  1.30it/s] 15%|â–ˆâ–        | 341/2320 [04:42<25:42,  1.28it/s] 15%|â–ˆâ–        | 342/2320 [04:42<25:15,  1.31it/s] 15%|â–ˆâ–        | 343/2320 [04:43<25:04,  1.31it/s] 15%|â–ˆâ–        | 344/2320 [04:44<25:30,  1.29it/s] 15%|â–ˆâ–        | 345/2320 [04:45<26:15,  1.25it/s] 15%|â–ˆâ–        | 346/2320 [04:45<26:05,  1.26it/s] 15%|â–ˆâ–        | 347/2320 [04:46<25:38,  1.28it/s] 15%|â–ˆâ–Œ        | 348/2320 [04:47<22:34,  1.46it/s]{'eval_loss': 1.1802396774291992, 'eval_precision': 0.8376231331426756, 'eval_recall': 0.3161998440592575, 'eval_f1': 0.45909348195236643, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 229.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'INGREDIENT_LINE': {'precision': 0.8508962520369364, 'recall': 0.3656629318394024, 'f1-score': 0.5115102040816326, 'support': 8568.0}, 'INSTRUCTION_STEP': {'precision': 0.7639285714285714, 'recall': 0.27186070157600406, 'f1-score': 0.40101237345331836, 'support': 7868.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.28779249296644477, 'recall': 0.8853704876504117, 'f1-score': 0.43438632832729157, 'support': 4737.0}, 'accuracy': 0.44212984586641757, 'macro avg': {'precision': 0.27180247377599326, 'recall': 0.2175563030094026, 'f1-score': 0.19241555798032037, 'support': 21410.0}, 'weighted avg': {'precision': 0.6849295715382775, 'recall': 0.44212984586641757, 'f1-score': 0.4481771518070302, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 3], [29, 0, 14, 16, 0, 0, 170], [0, 0, 0, 0, 0, 0, 5], [76, 1, 55, 3133, 442, 8, 4853], [0, 0, 0, 381, 2139, 0, 5348], [0, 0, 0, 0, 0, 0, 0], [108, 0, 64, 152, 219, 0, 4194]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 5124, 'INGREDIENT_LINE': 10371, 'INSTRUCTION_STEP': 6218, 'SECTION_HEADER': 471, 'PAGE_HEADER': 4, 'RECIPE_TITLE': 8}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.9798, 'eval_samples_per_second': 10.245, 'eval_steps_per_second': 2.561, 'epoch': 2.0}
{'loss': 1.1811, 'grad_norm': 10.933441162109375, 'learning_rate': 4.9568965517241384e-05, 'epoch': 2.16}
{'loss': 1.1929, 'grad_norm': 13.676913261413574, 'learning_rate': 4.837164750957854e-05, 'epoch': 2.59}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.29it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.54it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.10it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.90it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:06,  2.77it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.74it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.73it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.57it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.63it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.72it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.76it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.76it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.75it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.61it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.61it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.60it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.66it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.78it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.72it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.72it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.78it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.18it/s][A                                                  
                                               [A 15%|â–ˆâ–Œ        | 348/2320 [04:56<22:34,  1.46it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.18it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 15%|â–ˆâ–Œ        | 349/2320 [05:02<2:51:27,  5.22s/it] 15%|â–ˆâ–Œ        | 350/2320 [05:03<2:06:56,  3.87s/it]                                                     15%|â–ˆâ–Œ        | 350/2320 [05:03<2:06:56,  3.87s/it] 15%|â–ˆâ–Œ        | 351/2320 [05:04<1:35:50,  2.92s/it] 15%|â–ˆâ–Œ        | 352/2320 [05:05<1:14:06,  2.26s/it] 15%|â–ˆâ–Œ        | 353/2320 [05:05<58:54,  1.80s/it]   15%|â–ˆâ–Œ        | 354/2320 [05:06<48:14,  1.47s/it] 15%|â–ˆâ–Œ        | 355/2320 [05:07<40:46,  1.25s/it] 15%|â–ˆâ–Œ        | 356/2320 [05:07<35:47,  1.09s/it] 15%|â–ˆâ–Œ        | 357/2320 [05:08<33:00,  1.01s/it] 15%|â–ˆâ–Œ        | 358/2320 [05:09<30:31,  1.07it/s] 15%|â–ˆâ–Œ        | 359/2320 [05:10<28:43,  1.14it/s] 16%|â–ˆâ–Œ        | 360/2320 [05:11<27:35,  1.18it/s] 16%|â–ˆâ–Œ        | 361/2320 [05:11<26:34,  1.23it/s] 16%|â–ˆâ–Œ        | 362/2320 [05:12<25:39,  1.27it/s] 16%|â–ˆâ–Œ        | 363/2320 [05:13<25:20,  1.29it/s] 16%|â–ˆâ–Œ        | 364/2320 [05:14<25:28,  1.28it/s] 16%|â–ˆâ–Œ        | 365/2320 [05:14<24:52,  1.31it/s] 16%|â–ˆâ–Œ        | 366/2320 [05:15<24:40,  1.32it/s] 16%|â–ˆâ–Œ        | 367/2320 [05:16<24:15,  1.34it/s] 16%|â–ˆâ–Œ        | 368/2320 [05:17<24:20,  1.34it/s] 16%|â–ˆâ–Œ        | 369/2320 [05:17<24:08,  1.35it/s] 16%|â–ˆâ–Œ        | 370/2320 [05:18<24:01,  1.35it/s] 16%|â–ˆâ–Œ        | 371/2320 [05:19<24:17,  1.34it/s] 16%|â–ˆâ–Œ        | 372/2320 [05:19<24:00,  1.35it/s] 16%|â–ˆâ–Œ        | 373/2320 [05:20<24:09,  1.34it/s] 16%|â–ˆâ–Œ        | 374/2320 [05:21<24:36,  1.32it/s] 16%|â–ˆâ–Œ        | 375/2320 [05:22<24:37,  1.32it/s] 16%|â–ˆâ–Œ        | 376/2320 [05:23<24:30,  1.32it/s] 16%|â–ˆâ–‹        | 377/2320 [05:23<24:16,  1.33it/s] 16%|â–ˆâ–‹        | 378/2320 [05:24<24:14,  1.33it/s] 16%|â–ˆâ–‹        | 379/2320 [05:25<23:59,  1.35it/s] 16%|â–ˆâ–‹        | 380/2320 [05:25<23:58,  1.35it/s] 16%|â–ˆâ–‹        | 381/2320 [05:26<23:52,  1.35it/s] 16%|â–ˆâ–‹        | 382/2320 [05:27<24:02,  1.34it/s] 17%|â–ˆâ–‹        | 383/2320 [05:28<25:00,  1.29it/s] 17%|â–ˆâ–‹        | 384/2320 [05:29<25:15,  1.28it/s] 17%|â–ˆâ–‹        | 385/2320 [05:29<25:00,  1.29it/s] 17%|â–ˆâ–‹        | 386/2320 [05:30<24:44,  1.30it/s] 17%|â–ˆâ–‹        | 387/2320 [05:31<24:49,  1.30it/s] 17%|â–ˆâ–‹        | 388/2320 [05:32<24:56,  1.29it/s] 17%|â–ˆâ–‹        | 389/2320 [05:32<24:54,  1.29it/s] 17%|â–ˆâ–‹        | 390/2320 [05:33<25:37,  1.26it/s] 17%|â–ˆâ–‹        | 391/2320 [05:34<25:22,  1.27it/s] 17%|â–ˆâ–‹        | 392/2320 [05:35<25:13,  1.27it/s] 17%|â–ˆâ–‹        | 393/2320 [05:36<25:22,  1.27it/s] 17%|â–ˆâ–‹        | 394/2320 [05:36<25:14,  1.27it/s] 17%|â–ˆâ–‹        | 395/2320 [05:37<25:09,  1.28it/s] 17%|â–ˆâ–‹        | 396/2320 [05:38<24:58,  1.28it/s] 17%|â–ˆâ–‹        | 397/2320 [05:39<24:56,  1.28it/s] 17%|â–ˆâ–‹        | 398/2320 [05:39<24:25,  1.31it/s] 17%|â–ˆâ–‹        | 399/2320 [05:40<24:42,  1.30it/s] 17%|â–ˆâ–‹        | 400/2320 [05:41<24:32,  1.30it/s]                                                   17%|â–ˆâ–‹        | 400/2320 [05:41<24:32,  1.30it/s] 17%|â–ˆâ–‹        | 401/2320 [05:42<28:15,  1.13it/s] 17%|â–ˆâ–‹        | 402/2320 [05:43<27:16,  1.17it/s] 17%|â–ˆâ–‹        | 403/2320 [05:44<26:07,  1.22it/s] 17%|â–ˆâ–‹        | 404/2320 [05:44<25:22,  1.26it/s] 17%|â–ˆâ–‹        | 405/2320 [05:45<25:13,  1.27it/s] 18%|â–ˆâ–Š        | 406/2320 [05:46<25:39,  1.24it/s] 18%|â–ˆâ–Š        | 407/2320 [05:47<25:51,  1.23it/s] 18%|â–ˆâ–Š        | 408/2320 [05:48<25:31,  1.25it/s] 18%|â–ˆâ–Š        | 409/2320 [05:48<24:36,  1.29it/s] 18%|â–ˆâ–Š        | 410/2320 [05:49<24:12,  1.31it/s] 18%|â–ˆâ–Š        | 411/2320 [05:50<24:18,  1.31it/s] 18%|â–ˆâ–Š        | 412/2320 [05:51<24:28,  1.30it/s] 18%|â–ˆâ–Š        | 413/2320 [05:51<23:57,  1.33it/s] 18%|â–ˆâ–Š        | 414/2320 [05:52<23:39,  1.34it/s] 18%|â–ˆâ–Š        | 415/2320 [05:53<23:28,  1.35it/s] 18%|â–ˆâ–Š        | 416/2320 [05:54<23:40,  1.34it/s] 18%|â–ˆâ–Š        | 417/2320 [05:54<24:17,  1.31it/s] 18%|â–ˆâ–Š        | 418/2320 [05:55<24:30,  1.29it/s] 18%|â–ˆâ–Š        | 419/2320 [05:56<24:16,  1.30it/s] 18%|â–ˆâ–Š        | 420/2320 [05:57<24:26,  1.30it/s] 18%|â–ˆâ–Š        | 421/2320 [05:57<24:00,  1.32it/s] 18%|â–ˆâ–Š        | 422/2320 [05:58<23:46,  1.33it/s] 18%|â–ˆâ–Š        | 423/2320 [05:59<23:35,  1.34it/s] 18%|â–ˆâ–Š        | 424/2320 [06:00<23:52,  1.32it/s] 18%|â–ˆâ–Š        | 425/2320 [06:00<23:59,  1.32it/s] 18%|â–ˆâ–Š        | 426/2320 [06:01<24:22,  1.29it/s] 18%|â–ˆâ–Š        | 427/2320 [06:02<24:39,  1.28it/s] 18%|â–ˆâ–Š        | 428/2320 [06:03<24:08,  1.31it/s] 18%|â–ˆâ–Š        | 429/2320 [06:04<24:38,  1.28it/s] 19%|â–ˆâ–Š        | 430/2320 [06:04<24:40,  1.28it/s] 19%|â–ˆâ–Š        | 431/2320 [06:05<24:18,  1.30it/s] 19%|â–ˆâ–Š        | 432/2320 [06:06<23:53,  1.32it/s] 19%|â–ˆâ–Š        | 433/2320 [06:07<24:00,  1.31it/s] 19%|â–ˆâ–Š        | 434/2320 [06:07<23:53,  1.32it/s] 19%|â–ˆâ–‰        | 435/2320 [06:08<24:31,  1.28it/s] 19%|â–ˆâ–‰        | 436/2320 [06:09<25:15,  1.24it/s] 19%|â–ˆâ–‰        | 437/2320 [06:10<25:00,  1.25it/s] 19%|â–ˆâ–‰        | 438/2320 [06:11<25:16,  1.24it/s] 19%|â–ˆâ–‰        | 439/2320 [06:11<25:04,  1.25it/s] 19%|â–ˆâ–‰        | 440/2320 [06:12<24:52,  1.26it/s] 19%|â–ˆâ–‰        | 441/2320 [06:13<24:52,  1.26it/s] 19%|â–ˆâ–‰        | 442/2320 [06:14<24:43,  1.27it/s] 19%|â–ˆâ–‰        | 443/2320 [06:15<24:14,  1.29it/s] 19%|â–ˆâ–‰        | 444/2320 [06:15<24:08,  1.29it/s] 19%|â–ˆâ–‰        | 445/2320 [06:16<23:43,  1.32it/s] 19%|â–ˆâ–‰        | 446/2320 [06:17<24:16,  1.29it/s] 19%|â–ˆâ–‰        | 447/2320 [06:18<24:37,  1.27it/s] 19%|â–ˆâ–‰        | 448/2320 [06:18<23:57,  1.30it/s] 19%|â–ˆâ–‰        | 449/2320 [06:19<23:52,  1.31it/s] 19%|â–ˆâ–‰        | 450/2320 [06:20<23:52,  1.31it/s]                                                   19%|â–ˆâ–‰        | 450/2320 [06:20<23:52,  1.31it/s] 19%|â–ˆâ–‰        | 451/2320 [06:21<24:10,  1.29it/s] 19%|â–ˆâ–‰        | 452/2320 [06:22<24:15,  1.28it/s] 20%|â–ˆâ–‰        | 453/2320 [06:22<24:26,  1.27it/s] 20%|â–ˆâ–‰        | 454/2320 [06:23<23:54,  1.30it/s] 20%|â–ˆâ–‰        | 455/2320 [06:24<24:07,  1.29it/s] 20%|â–ˆâ–‰        | 456/2320 [06:25<23:36,  1.32it/s] 20%|â–ˆâ–‰        | 457/2320 [06:25<23:50,  1.30it/s] 20%|â–ˆâ–‰        | 458/2320 [06:26<24:22,  1.27it/s] 20%|â–ˆâ–‰        | 459/2320 [06:27<24:25,  1.27it/s] 20%|â–ˆâ–‰        | 460/2320 [06:28<23:54,  1.30it/s] 20%|â–ˆâ–‰        | 461/2320 [06:28<23:38,  1.31it/s] 20%|â–ˆâ–‰        | 462/2320 [06:29<23:55,  1.29it/s] 20%|â–ˆâ–‰        | 463/2320 [06:30<23:22,  1.32it/s] 20%|â–ˆâ–ˆ        | 464/2320 [06:30<20:42,  1.49it/s]{'eval_loss': 0.9888901114463806, 'eval_precision': 0.9220072551390568, 'eval_recall': 0.5813953488372093, 'eval_f1': 0.713116670563479, 'eval_report': {'PAGE_HEADER': {'precision': 0.11737089201877934, 'recall': 0.2358490566037736, 'f1-score': 0.15673981191222572, 'support': 106.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 34.0}, 'RECIPE_TITLE': {'precision': 0.022556390977443608, 'recall': 0.046875, 'f1-score': 0.030456852791878174, 'support': 64.0}, 'INGREDIENT_LINE': {'precision': 0.7715915263443781, 'recall': 0.5970996216897856, 'f1-score': 0.6732227488151659, 'support': 4758.0}, 'INSTRUCTION_STEP': {'precision': 0.6092857142857143, 'recall': 0.586859305125559, 'f1-score': 0.5978622743998598, 'support': 2907.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8005215123859192, 'recall': 0.8615316446348128, 'f1-score': 0.8299068079960162, 'support': 13541.0}, 'accuracy': 0.7585707613264829, 'macro avg': {'precision': 0.33161800514460493, 'recall': 0.3326020897219902, 'f1-score': 0.3268840708450208, 'support': 21410.0}, 'weighted avg': {'precision': 0.761147724267604, 'recall': 0.7585707613264829, 'f1-score': 0.7565395243464915, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[25, 0, 5, 12, 0, 0, 64], [0, 0, 5, 0, 0, 0, 29], [0, 0, 3, 15, 0, 0, 46], [66, 1, 46, 2841, 171, 2, 1631], [0, 0, 0, 64, 1706, 0, 1137], [0, 0, 0, 0, 0, 0, 0], [122, 0, 74, 750, 923, 6, 11666]], 'eval_PAGE_HEADER_precision': 0.12650602409638553, 'eval_PAGE_HEADER_recall': 0.0958904109589041, 'eval_PAGE_HEADER_f1': 0.10909090909090909, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.013888888888888888, 'eval_header_title_confusion_count': 2, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13730, 'INGREDIENT_LINE': 5948, 'INSTRUCTION_STEP': 2217, 'PAGE_HEADER': 166, 'RECIPE_TITLE': 81, 'SECTION_HEADER': 54}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.1854, 'eval_samples_per_second': 10.016, 'eval_steps_per_second': 2.504, 'epoch': 3.0}
{'loss': 1.1333, 'grad_norm': 5.81136417388916, 'learning_rate': 4.717432950191571e-05, 'epoch': 3.02}
{'loss': 0.8355, 'grad_norm': 13.685807228088379, 'learning_rate': 4.597701149425287e-05, 'epoch': 3.45}
{'loss': 1.0543, 'grad_norm': 4.998208522796631, 'learning_rate': 4.477969348659004e-05, 'epoch': 3.88}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.65it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.94it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.28it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.11it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.96it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.85it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.82it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.78it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.74it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.76it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.75it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.75it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.74it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.79it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.83it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.83it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.83it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.83it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.78it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.79it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.80it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.18it/s][A                                                  
                                               [A 20%|â–ˆâ–ˆ        | 464/2320 [06:39<20:42,  1.49it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.18it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 20%|â–ˆâ–ˆ        | 465/2320 [06:46<2:42:37,  5.26s/it] 20%|â–ˆâ–ˆ        | 466/2320 [06:47<2:00:23,  3.90s/it] 20%|â–ˆâ–ˆ        | 467/2320 [06:48<1:30:57,  2.95s/it] 20%|â–ˆâ–ˆ        | 468/2320 [06:49<1:10:19,  2.28s/it] 20%|â–ˆâ–ˆ        | 469/2320 [06:49<55:47,  1.81s/it]   20%|â–ˆâ–ˆ        | 470/2320 [06:50<45:46,  1.48s/it] 20%|â–ˆâ–ˆ        | 471/2320 [06:51<38:40,  1.25s/it] 20%|â–ˆâ–ˆ        | 472/2320 [06:51<33:37,  1.09s/it] 20%|â–ˆâ–ˆ        | 473/2320 [06:52<30:36,  1.01it/s] 20%|â–ˆâ–ˆ        | 474/2320 [06:53<27:47,  1.11it/s] 20%|â–ˆâ–ˆ        | 475/2320 [06:54<26:14,  1.17it/s] 21%|â–ˆâ–ˆ        | 476/2320 [06:54<24:51,  1.24it/s] 21%|â–ˆâ–ˆ        | 477/2320 [06:55<23:50,  1.29it/s] 21%|â–ˆâ–ˆ        | 478/2320 [06:56<23:13,  1.32it/s] 21%|â–ˆâ–ˆ        | 479/2320 [06:56<22:46,  1.35it/s] 21%|â–ˆâ–ˆ        | 480/2320 [06:57<22:39,  1.35it/s] 21%|â–ˆâ–ˆ        | 481/2320 [06:58<22:15,  1.38it/s] 21%|â–ˆâ–ˆ        | 482/2320 [06:59<22:54,  1.34it/s] 21%|â–ˆâ–ˆ        | 483/2320 [06:59<22:53,  1.34it/s] 21%|â–ˆâ–ˆ        | 484/2320 [07:00<22:53,  1.34it/s] 21%|â–ˆâ–ˆ        | 485/2320 [07:01<23:00,  1.33it/s] 21%|â–ˆâ–ˆ        | 486/2320 [07:02<22:55,  1.33it/s] 21%|â–ˆâ–ˆ        | 487/2320 [07:02<22:42,  1.34it/s] 21%|â–ˆâ–ˆ        | 488/2320 [07:03<22:50,  1.34it/s] 21%|â–ˆâ–ˆ        | 489/2320 [07:04<22:39,  1.35it/s] 21%|â–ˆâ–ˆ        | 490/2320 [07:05<22:55,  1.33it/s] 21%|â–ˆâ–ˆ        | 491/2320 [07:05<23:09,  1.32it/s] 21%|â–ˆâ–ˆ        | 492/2320 [07:06<23:36,  1.29it/s] 21%|â–ˆâ–ˆâ–       | 493/2320 [07:07<23:58,  1.27it/s] 21%|â–ˆâ–ˆâ–       | 494/2320 [07:08<24:15,  1.25it/s] 21%|â–ˆâ–ˆâ–       | 495/2320 [07:09<24:07,  1.26it/s] 21%|â–ˆâ–ˆâ–       | 496/2320 [07:09<24:07,  1.26it/s] 21%|â–ˆâ–ˆâ–       | 497/2320 [07:10<24:04,  1.26it/s] 21%|â–ˆâ–ˆâ–       | 498/2320 [07:11<23:51,  1.27it/s] 22%|â–ˆâ–ˆâ–       | 499/2320 [07:12<23:38,  1.28it/s] 22%|â–ˆâ–ˆâ–       | 500/2320 [07:13<23:18,  1.30it/s]                                                   22%|â–ˆâ–ˆâ–       | 500/2320 [07:13<23:18,  1.30it/s] 22%|â–ˆâ–ˆâ–       | 501/2320 [07:13<24:00,  1.26it/s] 22%|â–ˆâ–ˆâ–       | 502/2320 [07:14<23:55,  1.27it/s] 22%|â–ˆâ–ˆâ–       | 503/2320 [07:15<23:34,  1.28it/s] 22%|â–ˆâ–ˆâ–       | 504/2320 [07:16<23:53,  1.27it/s] 22%|â–ˆâ–ˆâ–       | 505/2320 [07:17<23:59,  1.26it/s] 22%|â–ˆâ–ˆâ–       | 506/2320 [07:17<24:34,  1.23it/s] 22%|â–ˆâ–ˆâ–       | 507/2320 [07:18<24:20,  1.24it/s] 22%|â–ˆâ–ˆâ–       | 508/2320 [07:19<24:00,  1.26it/s] 22%|â–ˆâ–ˆâ–       | 509/2320 [07:20<23:42,  1.27it/s] 22%|â–ˆâ–ˆâ–       | 510/2320 [07:20<23:10,  1.30it/s] 22%|â–ˆâ–ˆâ–       | 511/2320 [07:21<23:40,  1.27it/s] 22%|â–ˆâ–ˆâ–       | 512/2320 [07:22<23:55,  1.26it/s] 22%|â–ˆâ–ˆâ–       | 513/2320 [07:23<23:52,  1.26it/s] 22%|â–ˆâ–ˆâ–       | 514/2320 [07:24<24:19,  1.24it/s] 22%|â–ˆâ–ˆâ–       | 515/2320 [07:25<24:32,  1.23it/s] 22%|â–ˆâ–ˆâ–       | 516/2320 [07:25<24:21,  1.23it/s] 22%|â–ˆâ–ˆâ–       | 517/2320 [07:26<24:14,  1.24it/s] 22%|â–ˆâ–ˆâ–       | 518/2320 [07:27<23:58,  1.25it/s] 22%|â–ˆâ–ˆâ–       | 519/2320 [07:28<24:35,  1.22it/s] 22%|â–ˆâ–ˆâ–       | 520/2320 [07:29<24:21,  1.23it/s] 22%|â–ˆâ–ˆâ–       | 521/2320 [07:29<23:36,  1.27it/s] 22%|â–ˆâ–ˆâ–Ž       | 522/2320 [07:30<23:23,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 523/2320 [07:31<23:19,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 524/2320 [07:32<23:14,  1.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 525/2320 [07:32<23:09,  1.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 526/2320 [07:33<23:54,  1.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 527/2320 [07:34<23:49,  1.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 528/2320 [07:35<23:21,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 529/2320 [07:36<23:18,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 530/2320 [07:36<23:50,  1.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 531/2320 [07:37<23:54,  1.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 532/2320 [07:38<23:43,  1.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 533/2320 [07:39<23:39,  1.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 534/2320 [07:40<23:33,  1.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 535/2320 [07:40<23:37,  1.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 536/2320 [07:41<23:36,  1.26it/s] 23%|â–ˆâ–ˆâ–Ž       | 537/2320 [07:42<23:44,  1.25it/s] 23%|â–ˆâ–ˆâ–Ž       | 538/2320 [07:43<23:17,  1.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 539/2320 [07:44<23:19,  1.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 540/2320 [07:44<23:08,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 541/2320 [07:45<22:52,  1.30it/s] 23%|â–ˆâ–ˆâ–Ž       | 542/2320 [07:46<23:09,  1.28it/s] 23%|â–ˆâ–ˆâ–Ž       | 543/2320 [07:47<23:02,  1.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 544/2320 [07:47<23:00,  1.29it/s] 23%|â–ˆâ–ˆâ–Ž       | 545/2320 [07:48<22:59,  1.29it/s] 24%|â–ˆâ–ˆâ–Ž       | 546/2320 [07:49<22:52,  1.29it/s] 24%|â–ˆâ–ˆâ–Ž       | 547/2320 [07:50<23:10,  1.27it/s] 24%|â–ˆâ–ˆâ–Ž       | 548/2320 [07:51<24:10,  1.22it/s] 24%|â–ˆâ–ˆâ–Ž       | 549/2320 [07:52<25:08,  1.17it/s] 24%|â–ˆâ–ˆâ–Ž       | 550/2320 [07:52<24:41,  1.20it/s]                                                   24%|â–ˆâ–ˆâ–Ž       | 550/2320 [07:52<24:41,  1.20it/s] 24%|â–ˆâ–ˆâ–       | 551/2320 [07:53<24:34,  1.20it/s] 24%|â–ˆâ–ˆâ–       | 552/2320 [07:54<24:34,  1.20it/s] 24%|â–ˆâ–ˆâ–       | 553/2320 [07:55<24:00,  1.23it/s] 24%|â–ˆâ–ˆâ–       | 554/2320 [07:56<23:31,  1.25it/s] 24%|â–ˆâ–ˆâ–       | 555/2320 [07:56<23:26,  1.25it/s] 24%|â–ˆâ–ˆâ–       | 556/2320 [07:57<23:04,  1.27it/s] 24%|â–ˆâ–ˆâ–       | 557/2320 [07:58<23:02,  1.27it/s] 24%|â–ˆâ–ˆâ–       | 558/2320 [07:59<23:13,  1.26it/s] 24%|â–ˆâ–ˆâ–       | 559/2320 [08:00<27:18,  1.07it/s] 24%|â–ˆâ–ˆâ–       | 560/2320 [08:01<25:42,  1.14it/s] 24%|â–ˆâ–ˆâ–       | 561/2320 [08:02<24:42,  1.19it/s] 24%|â–ˆâ–ˆâ–       | 562/2320 [08:02<23:48,  1.23it/s] 24%|â–ˆâ–ˆâ–       | 563/2320 [08:03<23:56,  1.22it/s] 24%|â–ˆâ–ˆâ–       | 564/2320 [08:04<23:28,  1.25it/s] 24%|â–ˆâ–ˆâ–       | 565/2320 [08:05<23:03,  1.27it/s] 24%|â–ˆâ–ˆâ–       | 566/2320 [08:05<22:41,  1.29it/s] 24%|â–ˆâ–ˆâ–       | 567/2320 [08:06<22:44,  1.28it/s] 24%|â–ˆâ–ˆâ–       | 568/2320 [08:07<22:44,  1.28it/s] 25%|â–ˆâ–ˆâ–       | 569/2320 [08:08<22:55,  1.27it/s] 25%|â–ˆâ–ˆâ–       | 570/2320 [08:08<22:26,  1.30it/s] 25%|â–ˆâ–ˆâ–       | 571/2320 [08:09<22:08,  1.32it/s] 25%|â–ˆâ–ˆâ–       | 572/2320 [08:10<21:58,  1.33it/s] 25%|â–ˆâ–ˆâ–       | 573/2320 [08:11<22:33,  1.29it/s] 25%|â–ˆâ–ˆâ–       | 574/2320 [08:12<23:05,  1.26it/s] 25%|â–ˆâ–ˆâ–       | 575/2320 [08:12<22:37,  1.29it/s] 25%|â–ˆâ–ˆâ–       | 576/2320 [08:13<22:52,  1.27it/s] 25%|â–ˆâ–ˆâ–       | 577/2320 [08:14<22:49,  1.27it/s] 25%|â–ˆâ–ˆâ–       | 578/2320 [08:15<22:37,  1.28it/s] 25%|â–ˆâ–ˆâ–       | 579/2320 [08:15<22:00,  1.32it/s] 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [08:16<19:40,  1.47it/s]{'eval_loss': 1.0127415657043457, 'eval_precision': 0.9216855087358684, 'eval_recall': 0.5451671732522796, 'eval_f1': 0.6851031321619557, 'eval_report': {'PAGE_HEADER': {'precision': 0.2300469483568075, 'recall': 0.1821561338289963, 'f1-score': 0.2033195020746888, 'support': 269.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 80.0}, 'RECIPE_TITLE': {'precision': 0.11278195488721804, 'recall': 0.03225806451612903, 'f1-score': 0.05016722408026756, 'support': 465.0}, 'INGREDIENT_LINE': {'precision': 0.6512764801738186, 'recall': 0.7634511302133079, 'f1-score': 0.7029166055987103, 'support': 3141.0}, 'INSTRUCTION_STEP': {'precision': 0.7221428571428572, 'recall': 0.47353629976580797, 'f1-score': 0.571994342291372, 'support': 4270.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7694366293831058, 'recall': 0.8504361016306409, 'f1-score': 0.807911232797752, 'support': 13185.0}, 'accuracy': 0.733162073797291, 'macro avg': {'precision': 0.35509783856340105, 'recall': 0.328833961422126, 'f1-score': 0.33375841526325584, 'support': 21410.0}, 'weighted avg': {'precision': 0.7187556104984938, 'recall': 0.733162073797291, 'f1-score': 0.7183842694751744, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[49, 0, 5, 30, 0, 0, 185], [0, 0, 13, 4, 0, 0, 63], [5, 0, 15, 58, 0, 0, 387], [34, 1, 23, 2398, 38, 7, 640], [2, 0, 0, 161, 2022, 0, 2085], [0, 0, 0, 0, 0, 0, 0], [123, 0, 77, 1031, 740, 1, 11213]], 'eval_PAGE_HEADER_precision': 0.13861386138613863, 'eval_PAGE_HEADER_recall': 0.1917808219178082, 'eval_PAGE_HEADER_f1': 0.16091954022988508, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0074211502782931356, 'eval_RECIPE_TITLE_recall': 0.028169014084507043, 'eval_RECIPE_TITLE_f1': 0.011747430249632892, 'eval_header_false_positive_rate': 0.018796992481203006, 'eval_title_false_negative_rate': 0.05806451612903226, 'eval_header_title_confusion_count': 14, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13845, 'INGREDIENT_LINE': 3782, 'INSTRUCTION_STEP': 3586, 'PAGE_HEADER': 303, 'RECIPE_TITLE': 539, 'SECTION_HEADER': 141}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.9149, 'eval_samples_per_second': 10.32, 'eval_steps_per_second': 2.58, 'epoch': 4.0}
{'loss': 0.8271, 'grad_norm': 4.392544746398926, 'learning_rate': 4.3582375478927204e-05, 'epoch': 4.31}
{'loss': 0.8152, 'grad_norm': 18.097068786621094, 'learning_rate': 4.238505747126437e-05, 'epoch': 4.74}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.60it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.13it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.46it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.14it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.04it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.93it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.81it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.71it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.77it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.78it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.75it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.70it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.68it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.77it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.59it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.51it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.63it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.64it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.61it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.73it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.71it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.02it/s][A                                                  
                                               [A 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [08:25<19:40,  1.47it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.02it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 25%|â–ˆâ–ˆâ–Œ       | 581/2320 [08:31<2:27:59,  5.11s/it] 25%|â–ˆâ–ˆâ–Œ       | 582/2320 [08:32<1:49:53,  3.79s/it] 25%|â–ˆâ–ˆâ–Œ       | 583/2320 [08:33<1:23:07,  2.87s/it] 25%|â–ˆâ–ˆâ–Œ       | 584/2320 [08:34<1:04:42,  2.24s/it] 25%|â–ˆâ–ˆâ–Œ       | 585/2320 [08:34<51:37,  1.79s/it]   25%|â–ˆâ–ˆâ–Œ       | 586/2320 [08:35<42:25,  1.47s/it] 25%|â–ˆâ–ˆâ–Œ       | 587/2320 [08:36<36:22,  1.26s/it] 25%|â–ˆâ–ˆâ–Œ       | 588/2320 [08:36<31:19,  1.09s/it] 25%|â–ˆâ–ˆâ–Œ       | 589/2320 [08:37<28:23,  1.02it/s] 25%|â–ˆâ–ˆâ–Œ       | 590/2320 [08:38<26:16,  1.10it/s] 25%|â–ˆâ–ˆâ–Œ       | 591/2320 [08:39<24:45,  1.16it/s] 26%|â–ˆâ–ˆâ–Œ       | 592/2320 [08:39<23:41,  1.22it/s] 26%|â–ˆâ–ˆâ–Œ       | 593/2320 [08:40<22:59,  1.25it/s] 26%|â–ˆâ–ˆâ–Œ       | 594/2320 [08:41<22:10,  1.30it/s] 26%|â–ˆâ–ˆâ–Œ       | 595/2320 [08:42<22:01,  1.30it/s] 26%|â–ˆâ–ˆâ–Œ       | 596/2320 [08:42<21:45,  1.32it/s] 26%|â–ˆâ–ˆâ–Œ       | 597/2320 [08:43<21:41,  1.32it/s] 26%|â–ˆâ–ˆâ–Œ       | 598/2320 [08:44<21:49,  1.31it/s] 26%|â–ˆâ–ˆâ–Œ       | 599/2320 [08:45<22:26,  1.28it/s] 26%|â–ˆâ–ˆâ–Œ       | 600/2320 [08:45<22:01,  1.30it/s]                                                   26%|â–ˆâ–ˆâ–Œ       | 600/2320 [08:45<22:01,  1.30it/s] 26%|â–ˆâ–ˆâ–Œ       | 601/2320 [08:46<21:40,  1.32it/s] 26%|â–ˆâ–ˆâ–Œ       | 602/2320 [08:47<21:29,  1.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 603/2320 [08:48<21:29,  1.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 604/2320 [08:48<21:14,  1.35it/s] 26%|â–ˆâ–ˆâ–Œ       | 605/2320 [08:49<21:45,  1.31it/s] 26%|â–ˆâ–ˆâ–Œ       | 606/2320 [08:50<21:39,  1.32it/s] 26%|â–ˆâ–ˆâ–Œ       | 607/2320 [08:51<22:09,  1.29it/s] 26%|â–ˆâ–ˆâ–Œ       | 608/2320 [08:52<22:00,  1.30it/s] 26%|â–ˆâ–ˆâ–‹       | 609/2320 [08:52<22:11,  1.28it/s] 26%|â–ˆâ–ˆâ–‹       | 610/2320 [08:53<22:06,  1.29it/s] 26%|â–ˆâ–ˆâ–‹       | 611/2320 [08:54<21:39,  1.31it/s] 26%|â–ˆâ–ˆâ–‹       | 612/2320 [08:55<21:24,  1.33it/s] 26%|â–ˆâ–ˆâ–‹       | 613/2320 [08:55<21:48,  1.31it/s] 26%|â–ˆâ–ˆâ–‹       | 614/2320 [08:56<21:58,  1.29it/s] 27%|â–ˆâ–ˆâ–‹       | 615/2320 [08:57<21:43,  1.31it/s] 27%|â–ˆâ–ˆâ–‹       | 616/2320 [08:58<22:11,  1.28it/s] 27%|â–ˆâ–ˆâ–‹       | 617/2320 [08:58<21:53,  1.30it/s] 27%|â–ˆâ–ˆâ–‹       | 618/2320 [08:59<22:02,  1.29it/s] 27%|â–ˆâ–ˆâ–‹       | 619/2320 [09:00<22:17,  1.27it/s] 27%|â–ˆâ–ˆâ–‹       | 620/2320 [09:01<22:12,  1.28it/s] 27%|â–ˆâ–ˆâ–‹       | 621/2320 [09:02<22:27,  1.26it/s] 27%|â–ˆâ–ˆâ–‹       | 622/2320 [09:02<22:51,  1.24it/s] 27%|â–ˆâ–ˆâ–‹       | 623/2320 [09:03<23:09,  1.22it/s] 27%|â–ˆâ–ˆâ–‹       | 624/2320 [09:04<23:09,  1.22it/s] 27%|â–ˆâ–ˆâ–‹       | 625/2320 [09:05<22:28,  1.26it/s] 27%|â–ˆâ–ˆâ–‹       | 626/2320 [09:06<22:16,  1.27it/s] 27%|â–ˆâ–ˆâ–‹       | 627/2320 [09:06<21:58,  1.28it/s] 27%|â–ˆâ–ˆâ–‹       | 628/2320 [09:07<21:20,  1.32it/s] 27%|â–ˆâ–ˆâ–‹       | 629/2320 [09:08<21:37,  1.30it/s] 27%|â–ˆâ–ˆâ–‹       | 630/2320 [09:09<21:37,  1.30it/s] 27%|â–ˆâ–ˆâ–‹       | 631/2320 [09:09<21:39,  1.30it/s] 27%|â–ˆâ–ˆâ–‹       | 632/2320 [09:10<22:09,  1.27it/s] 27%|â–ˆâ–ˆâ–‹       | 633/2320 [09:11<21:54,  1.28it/s] 27%|â–ˆâ–ˆâ–‹       | 634/2320 [09:12<21:18,  1.32it/s] 27%|â–ˆâ–ˆâ–‹       | 635/2320 [09:12<21:05,  1.33it/s] 27%|â–ˆâ–ˆâ–‹       | 636/2320 [09:13<21:10,  1.33it/s] 27%|â–ˆâ–ˆâ–‹       | 637/2320 [09:14<21:15,  1.32it/s] 28%|â–ˆâ–ˆâ–Š       | 638/2320 [09:15<21:33,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 639/2320 [09:16<21:42,  1.29it/s] 28%|â–ˆâ–ˆâ–Š       | 640/2320 [09:16<21:45,  1.29it/s] 28%|â–ˆâ–ˆâ–Š       | 641/2320 [09:17<21:23,  1.31it/s] 28%|â–ˆâ–ˆâ–Š       | 642/2320 [09:18<21:21,  1.31it/s] 28%|â–ˆâ–ˆâ–Š       | 643/2320 [09:19<21:30,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 644/2320 [09:19<21:58,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 645/2320 [09:20<21:46,  1.28it/s] 28%|â–ˆâ–ˆâ–Š       | 646/2320 [09:21<21:28,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 647/2320 [09:22<21:23,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 648/2320 [09:22<21:15,  1.31it/s] 28%|â–ˆâ–ˆâ–Š       | 649/2320 [09:23<21:49,  1.28it/s] 28%|â–ˆâ–ˆâ–Š       | 650/2320 [09:24<21:54,  1.27it/s]                                                   28%|â–ˆâ–ˆâ–Š       | 650/2320 [09:24<21:54,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 651/2320 [09:25<21:19,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 652/2320 [09:26<21:26,  1.30it/s] 28%|â–ˆâ–ˆâ–Š       | 653/2320 [09:26<21:46,  1.28it/s] 28%|â–ˆâ–ˆâ–Š       | 654/2320 [09:27<21:47,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 655/2320 [09:28<21:48,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 656/2320 [09:29<21:32,  1.29it/s] 28%|â–ˆâ–ˆâ–Š       | 657/2320 [09:30<21:48,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 658/2320 [09:30<21:50,  1.27it/s] 28%|â–ˆâ–ˆâ–Š       | 659/2320 [09:31<22:17,  1.24it/s] 28%|â–ˆâ–ˆâ–Š       | 660/2320 [09:32<22:28,  1.23it/s] 28%|â–ˆâ–ˆâ–Š       | 661/2320 [09:33<22:14,  1.24it/s] 29%|â–ˆâ–ˆâ–Š       | 662/2320 [09:34<22:20,  1.24it/s] 29%|â–ˆâ–ˆâ–Š       | 663/2320 [09:34<22:11,  1.24it/s] 29%|â–ˆâ–ˆâ–Š       | 664/2320 [09:35<21:45,  1.27it/s] 29%|â–ˆâ–ˆâ–Š       | 665/2320 [09:36<21:49,  1.26it/s] 29%|â–ˆâ–ˆâ–Š       | 666/2320 [09:37<21:46,  1.27it/s] 29%|â–ˆâ–ˆâ–‰       | 667/2320 [09:38<21:19,  1.29it/s] 29%|â–ˆâ–ˆâ–‰       | 668/2320 [09:38<21:15,  1.30it/s] 29%|â–ˆâ–ˆâ–‰       | 669/2320 [09:39<21:07,  1.30it/s] 29%|â–ˆâ–ˆâ–‰       | 670/2320 [09:40<21:06,  1.30it/s] 29%|â–ˆâ–ˆâ–‰       | 671/2320 [09:41<20:47,  1.32it/s] 29%|â–ˆâ–ˆâ–‰       | 672/2320 [09:41<20:47,  1.32it/s] 29%|â–ˆâ–ˆâ–‰       | 673/2320 [09:42<20:51,  1.32it/s] 29%|â–ˆâ–ˆâ–‰       | 674/2320 [09:43<20:55,  1.31it/s] 29%|â–ˆâ–ˆâ–‰       | 675/2320 [09:44<21:01,  1.30it/s] 29%|â–ˆâ–ˆâ–‰       | 676/2320 [09:44<21:16,  1.29it/s] 29%|â–ˆâ–ˆâ–‰       | 677/2320 [09:45<21:23,  1.28it/s] 29%|â–ˆâ–ˆâ–‰       | 678/2320 [09:46<20:59,  1.30it/s] 29%|â–ˆâ–ˆâ–‰       | 679/2320 [09:47<20:56,  1.31it/s] 29%|â–ˆâ–ˆâ–‰       | 680/2320 [09:47<21:16,  1.29it/s] 29%|â–ˆâ–ˆâ–‰       | 681/2320 [09:48<21:18,  1.28it/s] 29%|â–ˆâ–ˆâ–‰       | 682/2320 [09:49<21:27,  1.27it/s] 29%|â–ˆâ–ˆâ–‰       | 683/2320 [09:50<21:36,  1.26it/s] 29%|â–ˆâ–ˆâ–‰       | 684/2320 [09:51<21:23,  1.27it/s] 30%|â–ˆâ–ˆâ–‰       | 685/2320 [09:51<21:14,  1.28it/s] 30%|â–ˆâ–ˆâ–‰       | 686/2320 [09:52<20:53,  1.30it/s] 30%|â–ˆâ–ˆâ–‰       | 687/2320 [09:53<20:44,  1.31it/s] 30%|â–ˆâ–ˆâ–‰       | 688/2320 [09:54<20:42,  1.31it/s] 30%|â–ˆâ–ˆâ–‰       | 689/2320 [09:54<20:37,  1.32it/s] 30%|â–ˆâ–ˆâ–‰       | 690/2320 [09:55<20:44,  1.31it/s] 30%|â–ˆâ–ˆâ–‰       | 691/2320 [09:56<20:28,  1.33it/s] 30%|â–ˆâ–ˆâ–‰       | 692/2320 [09:57<20:46,  1.31it/s] 30%|â–ˆâ–ˆâ–‰       | 693/2320 [09:57<20:40,  1.31it/s] 30%|â–ˆâ–ˆâ–‰       | 694/2320 [09:58<20:34,  1.32it/s] 30%|â–ˆâ–ˆâ–‰       | 695/2320 [09:59<20:16,  1.34it/s] 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [09:59<17:50,  1.52it/s]{'eval_loss': 0.93803870677948, 'eval_precision': 0.914400438036138, 'eval_recall': 0.5347422350304195, 'eval_f1': 0.6748383620689655, 'eval_report': {'PAGE_HEADER': {'precision': 0.6291079812206573, 'recall': 0.2718052738336714, 'f1-score': 0.37960339943342775, 'support': 493.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.6240601503759399, 'recall': 0.16370808678500987, 'f1-score': 0.259375, 'support': 507.0}, 'INGREDIENT_LINE': {'precision': 0.7300380228136882, 'recall': 0.7145135566188198, 'f1-score': 0.722192369693713, 'support': 3762.0}, 'INSTRUCTION_STEP': {'precision': 0.7517857142857143, 'recall': 0.4575092371223647, 'f1-score': 0.5688420483718416, 'support': 4601.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7330680024703218, 'recall': 0.8872186695457188, 'f1-score': 0.8028105508379049, 'support': 12041.0}, 'accuracy': 0.7329752452125176, 'macro avg': {'precision': 0.4954371244523316, 'recall': 0.35639354627222636, 'f1-score': 0.390403338333841, 'support': 21410.0}, 'weighted avg': {'precision': 0.7313773779533488, 'recall': 0.7329752452125176, 'f1-score': 0.7155263616490651, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[134, 0, 13, 52, 17, 2, 275], [0, 0, 0, 0, 0, 0, 6], [25, 0, 83, 30, 18, 4, 347], [41, 1, 34, 2688, 77, 2, 919], [2, 0, 0, 151, 2105, 0, 2343], [0, 0, 0, 0, 0, 0, 0], [11, 0, 3, 761, 583, 0, 10683]], 'eval_PAGE_HEADER_precision': 0.1836734693877551, 'eval_PAGE_HEADER_recall': 0.4931506849315068, 'eval_PAGE_HEADER_f1': 0.2676579925650558, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.07102803738317758, 'eval_RECIPE_TITLE_recall': 0.2676056338028169, 'eval_RECIPE_TITLE_f1': 0.11225997045790251, 'eval_header_false_positive_rate': 0.13031914893617022, 'eval_title_false_negative_rate': 0.1891891891891892, 'eval_header_title_confusion_count': 91, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 12483, 'INGREDIENT_LINE': 4574, 'INSTRUCTION_STEP': 4005, 'PAGE_HEADER': 588, 'RECIPE_TITLE': 535, 'SECTION_HEADER': 11}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.0169, 'eval_samples_per_second': 10.203, 'eval_steps_per_second': 2.551, 'epoch': 5.0}
{'loss': 0.8017, 'grad_norm': 23.438825607299805, 'learning_rate': 4.1187739463601534e-05, 'epoch': 5.17}
{'loss': 0.6155, 'grad_norm': 7.802823543548584, 'learning_rate': 3.99904214559387e-05, 'epoch': 5.6}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.47it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.05it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.33it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.05it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.84it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.82it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:07,  1.96it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.18it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:04<00:05,  2.36it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.47it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:04,  2.49it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.47it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.61it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:06<00:02,  2.63it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.57it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.64it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:07<00:01,  2.69it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.65it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.66it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.05it/s][A                                                  
                                               [A 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [10:09<17:50,  1.52it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:09<00:00,  3.05it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 30%|â–ˆâ–ˆâ–ˆ       | 697/2320 [10:16<2:29:16,  5.52s/it] 30%|â–ˆâ–ˆâ–ˆ       | 698/2320 [10:17<1:50:20,  4.08s/it] 30%|â–ˆâ–ˆâ–ˆ       | 699/2320 [10:18<1:23:01,  3.07s/it] 30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [10:18<1:03:41,  2.36s/it]                                                     30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [10:18<1:03:41,  2.36s/it] 30%|â–ˆâ–ˆâ–ˆ       | 701/2320 [10:19<50:37,  1.88s/it]   30%|â–ˆâ–ˆâ–ˆ       | 702/2320 [10:20<41:06,  1.52s/it] 30%|â–ˆâ–ˆâ–ˆ       | 703/2320 [10:21<34:46,  1.29s/it] 30%|â–ˆâ–ˆâ–ˆ       | 704/2320 [10:21<30:01,  1.11s/it] 30%|â–ˆâ–ˆâ–ˆ       | 705/2320 [10:22<27:00,  1.00s/it] 30%|â–ˆâ–ˆâ–ˆ       | 706/2320 [10:23<25:01,  1.07it/s] 30%|â–ˆâ–ˆâ–ˆ       | 707/2320 [10:24<23:08,  1.16it/s] 31%|â–ˆâ–ˆâ–ˆ       | 708/2320 [10:24<21:49,  1.23it/s] 31%|â–ˆâ–ˆâ–ˆ       | 709/2320 [10:25<20:50,  1.29it/s] 31%|â–ˆâ–ˆâ–ˆ       | 710/2320 [10:26<20:15,  1.32it/s] 31%|â–ˆâ–ˆâ–ˆ       | 711/2320 [10:26<19:56,  1.34it/s] 31%|â–ˆâ–ˆâ–ˆ       | 712/2320 [10:27<19:49,  1.35it/s] 31%|â–ˆâ–ˆâ–ˆ       | 713/2320 [10:28<19:31,  1.37it/s] 31%|â–ˆâ–ˆâ–ˆ       | 714/2320 [10:29<20:10,  1.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 715/2320 [10:29<20:12,  1.32it/s] 31%|â–ˆâ–ˆâ–ˆ       | 716/2320 [10:30<20:03,  1.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 717/2320 [10:31<20:02,  1.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 718/2320 [10:32<19:57,  1.34it/s] 31%|â–ˆâ–ˆâ–ˆ       | 719/2320 [10:32<20:09,  1.32it/s] 31%|â–ˆâ–ˆâ–ˆ       | 720/2320 [10:33<20:03,  1.33it/s] 31%|â–ˆâ–ˆâ–ˆ       | 721/2320 [10:34<20:22,  1.31it/s] 31%|â–ˆâ–ˆâ–ˆ       | 722/2320 [10:35<20:40,  1.29it/s] 31%|â–ˆâ–ˆâ–ˆ       | 723/2320 [10:35<20:41,  1.29it/s] 31%|â–ˆâ–ˆâ–ˆ       | 724/2320 [10:36<20:48,  1.28it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 725/2320 [10:37<20:30,  1.30it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 726/2320 [10:38<20:34,  1.29it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 727/2320 [10:39<20:30,  1.29it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 728/2320 [10:39<20:41,  1.28it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 729/2320 [10:40<20:43,  1.28it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 730/2320 [10:41<21:02,  1.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 731/2320 [10:42<20:44,  1.28it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 732/2320 [10:42<20:19,  1.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 733/2320 [10:43<20:21,  1.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 734/2320 [10:44<20:37,  1.28it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 735/2320 [10:45<20:32,  1.29it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 736/2320 [10:46<20:21,  1.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 737/2320 [10:46<20:41,  1.28it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 738/2320 [10:47<20:40,  1.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 739/2320 [10:48<20:47,  1.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 740/2320 [10:49<20:45,  1.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 741/2320 [10:50<20:44,  1.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 742/2320 [10:50<20:21,  1.29it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 743/2320 [10:51<20:07,  1.31it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 744/2320 [10:52<20:27,  1.28it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 745/2320 [10:53<20:28,  1.28it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 746/2320 [10:53<20:10,  1.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 747/2320 [10:54<20:17,  1.29it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 748/2320 [10:55<20:49,  1.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 749/2320 [10:56<21:27,  1.22it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [10:57<21:19,  1.23it/s]                                                   32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [10:57<21:19,  1.23it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 751/2320 [10:57<20:34,  1.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 752/2320 [10:58<20:10,  1.30it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 753/2320 [10:59<20:39,  1.26it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 754/2320 [11:00<20:37,  1.27it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 755/2320 [11:01<20:29,  1.27it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 756/2320 [11:01<20:34,  1.27it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 757/2320 [11:02<19:53,  1.31it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 758/2320 [11:03<20:38,  1.26it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 759/2320 [11:04<20:55,  1.24it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 760/2320 [11:04<20:51,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 761/2320 [11:05<20:38,  1.26it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 762/2320 [11:06<20:42,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 763/2320 [11:07<20:46,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 764/2320 [11:08<20:48,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 765/2320 [11:08<20:36,  1.26it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 766/2320 [11:09<20:39,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 767/2320 [11:10<20:38,  1.25it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 768/2320 [11:11<20:29,  1.26it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 769/2320 [11:12<20:13,  1.28it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 770/2320 [11:12<20:04,  1.29it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 771/2320 [11:13<19:45,  1.31it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 772/2320 [11:14<19:26,  1.33it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 773/2320 [11:15<19:29,  1.32it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 774/2320 [11:15<19:58,  1.29it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 775/2320 [11:16<20:24,  1.26it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 776/2320 [11:17<20:41,  1.24it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 777/2320 [11:18<20:37,  1.25it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 778/2320 [11:19<20:43,  1.24it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 779/2320 [11:20<20:52,  1.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 780/2320 [11:20<21:02,  1.22it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 781/2320 [11:21<20:55,  1.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 782/2320 [11:22<20:49,  1.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 783/2320 [11:23<20:46,  1.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 784/2320 [11:24<20:24,  1.25it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 785/2320 [11:24<20:11,  1.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 786/2320 [11:25<20:03,  1.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 787/2320 [11:26<20:10,  1.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 788/2320 [11:27<20:19,  1.26it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 789/2320 [11:28<20:21,  1.25it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 790/2320 [11:28<20:19,  1.26it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 791/2320 [11:29<20:11,  1.26it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 792/2320 [11:30<20:37,  1.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 793/2320 [11:31<20:26,  1.25it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 794/2320 [11:31<20:09,  1.26it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 795/2320 [11:32<20:27,  1.24it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 796/2320 [11:33<20:11,  1.26it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 797/2320 [11:34<19:56,  1.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 798/2320 [11:35<20:02,  1.27it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 799/2320 [11:35<19:51,  1.28it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [11:36<19:41,  1.29it/s]                                                   34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [11:36<19:41,  1.29it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 801/2320 [11:37<20:22,  1.24it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 802/2320 [11:38<20:43,  1.22it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 803/2320 [11:39<20:24,  1.24it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 804/2320 [11:40<20:31,  1.23it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 805/2320 [11:40<20:20,  1.24it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 806/2320 [11:41<19:54,  1.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 807/2320 [11:42<19:46,  1.27it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 808/2320 [11:43<19:26,  1.30it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 809/2320 [11:43<19:20,  1.30it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 810/2320 [11:44<19:11,  1.31it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 811/2320 [11:45<18:59,  1.32it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [11:45<17:02,  1.48it/s]{'eval_loss': 1.097749948501587, 'eval_precision': 0.8943646882365546, 'eval_recall': 0.5907997169143666, 'eval_f1': 0.7115581316058643, 'eval_report': {'PAGE_HEADER': {'precision': 0.704225352112676, 'recall': 0.28790786948176583, 'f1-score': 0.4087193460490463, 'support': 521.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 50.0}, 'RECIPE_TITLE': {'precision': 0.5714285714285714, 'recall': 0.1953727506426735, 'f1-score': 0.29118773946360155, 'support': 389.0}, 'INGREDIENT_LINE': {'precision': 0.5448126018468223, 'recall': 0.8536170212765958, 'f1-score': 0.6651193633952255, 'support': 2350.0}, 'INSTRUCTION_STEP': {'precision': 0.6935714285714286, 'recall': 0.5171770972037284, 'f1-score': 0.5925247902364608, 'support': 3755.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8354491182323475, 'recall': 0.8487277797141861, 'f1-score': 0.8420361020817484, 'support': 14345.0}, 'accuracy': 0.7636151331153667, 'macro avg': {'precision': 0.4784981531702637, 'recall': 0.38611464547413565, 'f1-score': 0.39994104874658326, 'support': 21410.0}, 'weighted avg': {'precision': 0.7687237296779631, 'recall': 0.7636151331153667, 'f1-score': 0.7563374024111288, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[150, 0, 20, 76, 22, 1, 252], [1, 0, 13, 3, 0, 0, 33], [20, 0, 76, 98, 14, 0, 181], [30, 1, 24, 2006, 33, 7, 249], [0, 0, 0, 130, 1942, 0, 1683], [0, 0, 0, 0, 0, 0, 0], [12, 0, 0, 1369, 789, 0, 12175]], 'eval_PAGE_HEADER_precision': 0.1728, 'eval_PAGE_HEADER_recall': 0.4931506849315068, 'eval_PAGE_HEADER_f1': 0.2559241706161137, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.07142857142857142, 'eval_RECIPE_TITLE_recall': 0.24647887323943662, 'eval_RECIPE_TITLE_f1': 0.1107594936708861, 'eval_header_false_positive_rate': 0.11141304347826086, 'eval_title_false_negative_rate': 0.23043478260869565, 'eval_header_title_confusion_count': 94, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14938, 'INGREDIENT_LINE': 2920, 'INSTRUCTION_STEP': 3142, 'PAGE_HEADER': 625, 'RECIPE_TITLE': 490, 'SECTION_HEADER': 81}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.8124, 'eval_samples_per_second': 9.376, 'eval_steps_per_second': 2.344, 'epoch': 6.0}
{'loss': 0.6067, 'grad_norm': 6.616220474243164, 'learning_rate': 3.8793103448275865e-05, 'epoch': 6.03}
{'loss': 0.5339, 'grad_norm': 40.74597930908203, 'learning_rate': 3.759578544061303e-05, 'epoch': 6.47}
{'loss': 0.5308, 'grad_norm': 5.617910861968994, 'learning_rate': 3.6398467432950195e-05, 'epoch': 6.9}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.73it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.09it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.34it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.08it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.01it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.85it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.69it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.69it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.75it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.76it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.75it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.63it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.66it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.74it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.76it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.83it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.88it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.87it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.84it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.84it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.81it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.09it/s][A                                                  
                                               [A 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [11:54<17:02,  1.48it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.09it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 813/2320 [12:01<2:07:23,  5.07s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 814/2320 [12:01<1:34:46,  3.78s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 815/2320 [12:02<1:11:46,  2.86s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 816/2320 [12:03<55:36,  2.22s/it]   35%|â–ˆâ–ˆâ–ˆâ–Œ      | 817/2320 [12:04<44:24,  1.77s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 818/2320 [12:04<36:23,  1.45s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 819/2320 [12:05<30:34,  1.22s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 820/2320 [12:06<26:51,  1.07s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 821/2320 [12:06<24:02,  1.04it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 822/2320 [12:07<22:24,  1.11it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 823/2320 [12:08<21:31,  1.16it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 824/2320 [12:09<21:03,  1.18it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 825/2320 [12:09<20:20,  1.23it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 826/2320 [12:10<19:46,  1.26it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 827/2320 [12:11<19:21,  1.29it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 828/2320 [12:12<18:53,  1.32it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 829/2320 [12:12<19:03,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 830/2320 [12:13<19:05,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 831/2320 [12:14<18:50,  1.32it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 832/2320 [12:15<19:07,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 833/2320 [12:16<18:53,  1.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 834/2320 [12:16<19:16,  1.28it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 835/2320 [12:17<19:05,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 836/2320 [12:18<18:52,  1.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 837/2320 [12:19<18:52,  1.31it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 838/2320 [12:19<19:00,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 839/2320 [12:20<19:04,  1.29it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 840/2320 [12:21<19:00,  1.30it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 841/2320 [12:22<19:31,  1.26it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 842/2320 [12:23<19:35,  1.26it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 843/2320 [12:23<19:17,  1.28it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 844/2320 [12:24<19:25,  1.27it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 845/2320 [12:25<19:21,  1.27it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 846/2320 [12:26<19:51,  1.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 847/2320 [12:27<20:08,  1.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 848/2320 [12:28<20:49,  1.18it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 849/2320 [12:29<23:12,  1.06it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [12:29<22:02,  1.11it/s]                                                   37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [12:30<22:02,  1.11it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 851/2320 [12:30<21:26,  1.14it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 852/2320 [12:31<20:58,  1.17it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 853/2320 [12:32<20:14,  1.21it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 854/2320 [12:33<19:38,  1.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 855/2320 [12:33<19:23,  1.26it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 856/2320 [12:34<19:46,  1.23it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 857/2320 [12:35<19:57,  1.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 858/2320 [12:36<19:47,  1.23it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 859/2320 [12:37<19:26,  1.25it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 860/2320 [12:37<19:13,  1.27it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 861/2320 [12:38<19:03,  1.28it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 862/2320 [12:39<19:04,  1.27it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 863/2320 [12:40<19:28,  1.25it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 864/2320 [12:41<19:54,  1.22it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 865/2320 [12:41<19:37,  1.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 866/2320 [12:42<19:31,  1.24it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 867/2320 [12:43<19:38,  1.23it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 868/2320 [12:44<19:00,  1.27it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 869/2320 [12:45<19:00,  1.27it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 870/2320 [12:45<19:16,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 871/2320 [12:46<19:20,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 872/2320 [12:47<19:14,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 873/2320 [12:48<19:18,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 874/2320 [12:49<19:32,  1.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 875/2320 [12:49<19:26,  1.24it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 876/2320 [12:50<19:22,  1.24it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 877/2320 [12:51<19:14,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 878/2320 [12:52<18:48,  1.28it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 879/2320 [12:53<19:06,  1.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 880/2320 [12:53<19:16,  1.24it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 881/2320 [12:54<19:12,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 882/2320 [12:55<19:11,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 883/2320 [12:56<18:50,  1.27it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 884/2320 [12:57<18:57,  1.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 885/2320 [12:57<18:26,  1.30it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 886/2320 [12:58<18:39,  1.28it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 887/2320 [12:59<18:51,  1.27it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 888/2320 [13:00<19:02,  1.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 889/2320 [13:01<18:54,  1.26it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 890/2320 [13:01<19:23,  1.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 891/2320 [13:02<19:28,  1.22it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 892/2320 [13:03<19:25,  1.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 893/2320 [13:04<19:34,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 894/2320 [13:05<19:25,  1.22it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 895/2320 [13:05<19:11,  1.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 896/2320 [13:06<19:04,  1.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 897/2320 [13:07<19:09,  1.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 898/2320 [13:08<19:06,  1.24it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 899/2320 [13:09<19:31,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [13:10<19:54,  1.19it/s]                                                   39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [13:10<19:54,  1.19it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 901/2320 [13:10<19:40,  1.20it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 902/2320 [13:11<19:42,  1.20it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 903/2320 [13:12<19:43,  1.20it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 904/2320 [13:13<19:39,  1.20it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 905/2320 [13:14<19:33,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 906/2320 [13:15<19:36,  1.20it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 907/2320 [13:15<19:26,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 908/2320 [13:16<19:21,  1.22it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 909/2320 [13:17<19:27,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 910/2320 [13:18<19:21,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 911/2320 [13:19<19:23,  1.21it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 912/2320 [13:20<19:16,  1.22it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 913/2320 [13:20<19:12,  1.22it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 914/2320 [13:21<19:13,  1.22it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 915/2320 [13:22<19:00,  1.23it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 916/2320 [13:23<18:56,  1.24it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 917/2320 [13:24<18:41,  1.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 918/2320 [13:24<18:31,  1.26it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 919/2320 [13:25<18:52,  1.24it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 920/2320 [13:26<18:41,  1.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 921/2320 [13:27<18:24,  1.27it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 922/2320 [13:27<17:57,  1.30it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 923/2320 [13:28<18:30,  1.26it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 924/2320 [13:29<18:20,  1.27it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 925/2320 [13:30<18:16,  1.27it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 926/2320 [13:31<18:37,  1.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 927/2320 [13:31<18:32,  1.25it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [13:32<16:39,  1.39it/s]{'eval_loss': 1.0476577281951904, 'eval_precision': 0.9026168224299066, 'eval_recall': 0.587112462006079, 'eval_f1': 0.7114548802946593, 'eval_report': {'PAGE_HEADER': {'precision': 0.26291079812206575, 'recall': 0.417910447761194, 'f1-score': 0.3227665706051873, 'support': 134.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9.0}, 'RECIPE_TITLE': {'precision': 0.38345864661654133, 'recall': 0.3953488372093023, 'f1-score': 0.3893129770992366, 'support': 129.0}, 'INGREDIENT_LINE': {'precision': 0.7838131450298751, 'recall': 0.570694087403599, 'f1-score': 0.6604874699622383, 'support': 5057.0}, 'INSTRUCTION_STEP': {'precision': 0.6557142857142857, 'recall': 0.6339779005524862, 'f1-score': 0.6446629213483146, 'support': 2896.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.802717354010842, 'recall': 0.8872203261281759, 'f1-score': 0.8428561135528496, 'support': 13185.0}, 'accuracy': 0.7719290051377861, 'macro avg': {'precision': 0.41265917564194426, 'recall': 0.4150216570078224, 'f1-score': 0.40858372179540375, 'support': 21410.0}, 'weighted avg': {'precision': 0.7721259304455624, 'recall': 0.7719290051377861, 'f1-score': 0.7666304954472198, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[56, 0, 4, 56, 1, 0, 17], [2, 0, 0, 0, 0, 0, 7], [7, 0, 51, 42, 5, 0, 24], [73, 1, 48, 2886, 197, 8, 1844], [0, 0, 0, 77, 1836, 0, 983], [0, 0, 0, 0, 0, 0, 0], [75, 0, 30, 621, 761, 0, 11698]], 'eval_PAGE_HEADER_precision': 0.23036649214659685, 'eval_PAGE_HEADER_recall': 0.2009132420091324, 'eval_PAGE_HEADER_f1': 0.21463414634146338, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09595959595959595, 'eval_RECIPE_TITLE_recall': 0.13380281690140844, 'eval_RECIPE_TITLE_f1': 0.11176470588235293, 'eval_header_false_positive_rate': 0.05054151624548736, 'eval_title_false_negative_rate': 0.052941176470588235, 'eval_header_title_confusion_count': 23, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13759, 'INGREDIENT_LINE': 5668, 'INSTRUCTION_STEP': 2364, 'PAGE_HEADER': 191, 'SECTION_HEADER': 16, 'RECIPE_TITLE': 198}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.8865, 'eval_samples_per_second': 10.353, 'eval_steps_per_second': 2.588, 'epoch': 7.0}
{'loss': 0.4731, 'grad_norm': 10.388585090637207, 'learning_rate': 3.5201149425287353e-05, 'epoch': 7.33}
{'loss': 0.4579, 'grad_norm': 4.6437458992004395, 'learning_rate': 3.400383141762452e-05, 'epoch': 7.76}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.30it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.75it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.19it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.04it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.98it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.94it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.82it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.74it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.72it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.76it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.85it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.77it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.72it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.75it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.76it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.79it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.82it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.70it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.56it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.60it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.64it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.95it/s][A                                                  
                                               [A 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [13:41<16:39,  1.39it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.95it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 929/2320 [13:48<2:03:44,  5.34s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 930/2320 [13:49<1:31:45,  3.96s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 931/2320 [13:50<1:09:20,  3.00s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 932/2320 [13:50<53:32,  2.31s/it]   40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 933/2320 [13:51<42:30,  1.84s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 934/2320 [13:52<34:36,  1.50s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 935/2320 [13:52<29:00,  1.26s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 936/2320 [13:53<25:16,  1.10s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 937/2320 [13:54<22:26,  1.03it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 938/2320 [13:55<20:36,  1.12it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 939/2320 [13:55<19:28,  1.18it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 940/2320 [13:56<18:46,  1.23it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 941/2320 [13:57<17:55,  1.28it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 942/2320 [13:57<17:34,  1.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 943/2320 [13:58<17:51,  1.28it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 944/2320 [13:59<17:45,  1.29it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 945/2320 [14:00<17:50,  1.28it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 946/2320 [14:01<17:45,  1.29it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 947/2320 [14:01<17:31,  1.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 948/2320 [14:02<17:16,  1.32it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 949/2320 [14:03<17:26,  1.31it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [14:04<17:56,  1.27it/s]                                                   41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [14:04<17:56,  1.27it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 951/2320 [14:04<17:55,  1.27it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 952/2320 [14:05<17:46,  1.28it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 953/2320 [14:06<18:19,  1.24it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 954/2320 [14:07<18:38,  1.22it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 955/2320 [14:08<19:00,  1.20it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 956/2320 [14:09<18:43,  1.21it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 957/2320 [14:09<18:15,  1.24it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 958/2320 [14:10<18:04,  1.26it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 959/2320 [14:11<17:57,  1.26it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 960/2320 [14:12<17:23,  1.30it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 961/2320 [14:12<17:29,  1.29it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 962/2320 [14:13<17:36,  1.29it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 963/2320 [14:14<17:40,  1.28it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 964/2320 [14:15<17:52,  1.26it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 965/2320 [14:16<18:28,  1.22it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 966/2320 [14:17<18:45,  1.20it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 967/2320 [14:17<18:33,  1.22it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 968/2320 [14:18<18:23,  1.23it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 969/2320 [14:19<18:09,  1.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 970/2320 [14:20<17:58,  1.25it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 971/2320 [14:21<18:03,  1.25it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 972/2320 [14:21<18:11,  1.23it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 973/2320 [14:22<18:14,  1.23it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 974/2320 [14:23<17:31,  1.28it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 975/2320 [14:24<17:49,  1.26it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 976/2320 [14:25<17:59,  1.25it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 977/2320 [14:25<18:02,  1.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 978/2320 [14:26<18:18,  1.22it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 979/2320 [14:27<18:11,  1.23it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 980/2320 [14:28<17:56,  1.25it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 981/2320 [14:29<18:05,  1.23it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 982/2320 [14:29<17:57,  1.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 983/2320 [14:30<17:38,  1.26it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 984/2320 [14:31<17:13,  1.29it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 985/2320 [14:32<17:52,  1.24it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 986/2320 [14:33<20:15,  1.10it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 987/2320 [14:34<19:20,  1.15it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 988/2320 [14:35<18:45,  1.18it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 989/2320 [14:35<18:18,  1.21it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 990/2320 [14:36<18:00,  1.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 991/2320 [14:37<17:39,  1.25it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 992/2320 [14:38<17:38,  1.26it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 993/2320 [14:38<17:33,  1.26it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 994/2320 [14:39<17:47,  1.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 995/2320 [14:40<17:55,  1.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 996/2320 [14:41<17:55,  1.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 997/2320 [14:42<17:49,  1.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 998/2320 [14:42<17:32,  1.26it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 999/2320 [14:43<17:45,  1.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [14:44<17:49,  1.23it/s]                                                    43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [14:44<17:49,  1.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1001/2320 [14:45<17:26,  1.26it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1002/2320 [14:46<17:52,  1.23it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1003/2320 [14:47<17:59,  1.22it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1004/2320 [14:47<18:05,  1.21it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1005/2320 [14:48<18:04,  1.21it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1006/2320 [14:49<17:36,  1.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1007/2320 [14:50<17:24,  1.26it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1008/2320 [14:51<17:34,  1.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1009/2320 [14:51<17:39,  1.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1010/2320 [14:52<17:54,  1.22it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1011/2320 [14:53<17:43,  1.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1012/2320 [14:54<17:52,  1.22it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1013/2320 [14:55<17:46,  1.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1014/2320 [14:55<17:24,  1.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1015/2320 [14:56<17:36,  1.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1016/2320 [14:57<17:45,  1.22it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1017/2320 [14:58<17:36,  1.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1018/2320 [14:59<17:25,  1.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1019/2320 [14:59<17:02,  1.27it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1020/2320 [15:00<17:13,  1.26it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1021/2320 [15:01<17:13,  1.26it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1022/2320 [15:02<17:16,  1.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1023/2320 [15:03<17:40,  1.22it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1024/2320 [15:04<18:01,  1.20it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1025/2320 [15:04<18:05,  1.19it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1026/2320 [15:05<17:51,  1.21it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1027/2320 [15:06<17:31,  1.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1028/2320 [15:07<17:10,  1.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1029/2320 [15:08<17:11,  1.25it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1030/2320 [15:08<17:19,  1.24it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1031/2320 [15:09<17:29,  1.23it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1032/2320 [15:10<17:14,  1.24it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1033/2320 [15:11<17:25,  1.23it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1034/2320 [15:12<16:57,  1.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1035/2320 [15:12<16:49,  1.27it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1036/2320 [15:13<16:29,  1.30it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1037/2320 [15:14<16:22,  1.31it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1038/2320 [15:15<16:59,  1.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1039/2320 [15:15<16:52,  1.27it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1040/2320 [15:16<16:58,  1.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1041/2320 [15:17<17:10,  1.24it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1042/2320 [15:18<17:08,  1.24it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1043/2320 [15:19<16:51,  1.26it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [15:19<15:00,  1.42it/s]{'eval_loss': 1.131636142730713, 'eval_precision': 0.8764552562988706, 'eval_recall': 0.4465692784417884, 'eval_f1': 0.5916715542521994, 'eval_report': {'PAGE_HEADER': {'precision': 0.29577464788732394, 'recall': 0.1794871794871795, 'f1-score': 0.22340425531914893, 'support': 351.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9.0}, 'RECIPE_TITLE': {'precision': 0.48872180451127817, 'recall': 0.1497695852534562, 'f1-score': 0.2292768959435626, 'support': 434.0}, 'INGREDIENT_LINE': {'precision': 0.7232482346550788, 'recall': 0.6474592754680282, 'f1-score': 0.6832584990378447, 'support': 4113.0}, 'INSTRUCTION_STEP': {'precision': 0.8046428571428571, 'recall': 0.3526925485284909, 'f1-score': 0.4904222899434044, 'support': 6388.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.6198449186852398, 'recall': 0.8930301532377657, 'f1-score': 0.7317725210628645, 'support': 10115.0}, 'accuracy': 0.6574964969640354, 'macro avg': {'precision': 0.41889035184025397, 'recall': 0.31749124885356006, 'f1-score': 0.33687635161526075, 'support': 21410.0}, 'weighted avg': {'precision': 0.6866152301556495, 'recall': 0.6574964969640354, 'f1-score': 0.6316141948485999, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[63, 0, 3, 8, 0, 0, 277], [1, 0, 0, 1, 0, 0, 7], [15, 0, 65, 84, 9, 0, 261], [108, 1, 63, 2663, 119, 8, 1151], [0, 0, 0, 291, 2253, 0, 3844], [0, 0, 0, 0, 0, 0, 0], [26, 0, 2, 635, 419, 0, 9033]], 'eval_PAGE_HEADER_precision': 0.12686567164179105, 'eval_PAGE_HEADER_recall': 0.2328767123287671, 'eval_PAGE_HEADER_f1': 0.1642512077294686, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.06297709923664122, 'eval_RECIPE_TITLE_recall': 0.2323943661971831, 'eval_RECIPE_TITLE_f1': 0.0990990990990991, 'eval_header_false_positive_rate': 0.1118421052631579, 'eval_title_false_negative_rate': 0.07407407407407407, 'eval_header_title_confusion_count': 48, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 11244, 'INGREDIENT_LINE': 4714, 'INSTRUCTION_STEP': 5296, 'PAGE_HEADER': 402, 'RECIPE_TITLE': 524, 'SECTION_HEADER': 16}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.0218, 'eval_samples_per_second': 10.198, 'eval_steps_per_second': 2.549, 'epoch': 8.0}
{'loss': 0.3404, 'grad_norm': 2.7927169799804688, 'learning_rate': 3.2806513409961684e-05, 'epoch': 8.19}
{'loss': 0.3459, 'grad_norm': 7.964045524597168, 'learning_rate': 3.160919540229885e-05, 'epoch': 8.62}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.07it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  4.00it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.27it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.04it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.87it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:06,  2.55it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.53it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.49it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.53it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.55it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.56it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.56it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.60it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.62it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.55it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.56it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.57it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:07<00:01,  2.62it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.58it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.70it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.75it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.16it/s][A                                                   
                                               [A 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [15:29<15:00,  1.42it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.16it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1045/2320 [15:35<1:48:45,  5.12s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1046/2320 [15:35<1:20:46,  3.80s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1047/2320 [15:36<1:01:27,  2.90s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1048/2320 [15:37<47:32,  2.24s/it]   45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1049/2320 [15:38<37:58,  1.79s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [15:38<31:08,  1.47s/it]                                                    45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [15:38<31:08,  1.47s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1051/2320 [15:39<26:16,  1.24s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1052/2320 [15:40<23:23,  1.11s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1053/2320 [15:41<21:04,  1.00it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1054/2320 [15:41<19:45,  1.07it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1055/2320 [15:42<18:32,  1.14it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1056/2320 [15:43<17:34,  1.20it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1057/2320 [15:44<17:07,  1.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1058/2320 [15:44<16:29,  1.28it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1059/2320 [15:45<16:12,  1.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1060/2320 [15:46<16:13,  1.29it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1061/2320 [15:47<16:04,  1.31it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1062/2320 [15:47<16:00,  1.31it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1063/2320 [15:48<16:28,  1.27it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1064/2320 [15:49<16:21,  1.28it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1065/2320 [15:50<16:11,  1.29it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1066/2320 [15:50<15:58,  1.31it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1067/2320 [15:51<15:48,  1.32it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1068/2320 [15:52<16:00,  1.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1069/2320 [15:53<15:49,  1.32it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1070/2320 [15:54<16:16,  1.28it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1071/2320 [15:54<15:50,  1.31it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1072/2320 [15:55<15:53,  1.31it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1073/2320 [15:56<15:58,  1.30it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1074/2320 [15:57<16:18,  1.27it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1075/2320 [15:58<16:54,  1.23it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1076/2320 [15:58<17:02,  1.22it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1077/2320 [15:59<16:57,  1.22it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1078/2320 [16:00<16:28,  1.26it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1079/2320 [16:01<16:32,  1.25it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1080/2320 [16:02<16:37,  1.24it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1081/2320 [16:02<16:35,  1.24it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1082/2320 [16:03<16:33,  1.25it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1083/2320 [16:04<16:40,  1.24it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1084/2320 [16:05<16:25,  1.25it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1085/2320 [16:06<16:33,  1.24it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1086/2320 [16:06<16:26,  1.25it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1087/2320 [16:07<16:14,  1.26it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1088/2320 [16:08<16:00,  1.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1089/2320 [16:09<15:50,  1.29it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1090/2320 [16:09<16:03,  1.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1091/2320 [16:10<15:58,  1.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1092/2320 [16:11<15:53,  1.29it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1093/2320 [16:12<15:54,  1.29it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1094/2320 [16:13<16:03,  1.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1095/2320 [16:13<15:53,  1.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1096/2320 [16:14<15:56,  1.28it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1097/2320 [16:15<16:05,  1.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1098/2320 [16:16<16:04,  1.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1099/2320 [16:16<16:02,  1.27it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [16:17<16:26,  1.24it/s]                                                    47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [16:17<16:26,  1.24it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1101/2320 [16:18<16:21,  1.24it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1102/2320 [16:19<15:59,  1.27it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1103/2320 [16:20<15:45,  1.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1104/2320 [16:20<15:44,  1.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1105/2320 [16:21<15:47,  1.28it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1106/2320 [16:22<15:21,  1.32it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1107/2320 [16:23<16:06,  1.26it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1108/2320 [16:24<16:12,  1.25it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1109/2320 [16:24<16:09,  1.25it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1110/2320 [16:25<16:16,  1.24it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1111/2320 [16:26<16:17,  1.24it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1112/2320 [16:27<15:59,  1.26it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1113/2320 [16:28<15:54,  1.26it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1114/2320 [16:28<15:50,  1.27it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1115/2320 [16:29<15:49,  1.27it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1116/2320 [16:30<15:40,  1.28it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1117/2320 [16:31<15:34,  1.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1118/2320 [16:31<15:20,  1.31it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1119/2320 [16:32<15:23,  1.30it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1120/2320 [16:33<15:34,  1.28it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1121/2320 [16:34<15:48,  1.26it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1122/2320 [16:35<18:21,  1.09it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1123/2320 [16:36<17:24,  1.15it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1124/2320 [16:37<16:51,  1.18it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1125/2320 [16:37<16:26,  1.21it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1126/2320 [16:38<16:06,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1127/2320 [16:39<16:09,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1128/2320 [16:40<15:50,  1.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1129/2320 [16:41<15:44,  1.26it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1130/2320 [16:41<16:09,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1131/2320 [16:42<16:15,  1.22it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1132/2320 [16:43<16:26,  1.20it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1133/2320 [16:44<16:12,  1.22it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1134/2320 [16:45<16:03,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1135/2320 [16:45<15:46,  1.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1136/2320 [16:46<15:51,  1.24it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1137/2320 [16:47<15:48,  1.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1138/2320 [16:48<15:46,  1.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1139/2320 [16:49<15:54,  1.24it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1140/2320 [16:49<15:56,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1141/2320 [16:50<15:58,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1142/2320 [16:51<15:55,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1143/2320 [16:52<15:42,  1.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1144/2320 [16:53<15:56,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1145/2320 [16:54<15:48,  1.24it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1146/2320 [16:54<15:42,  1.24it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1147/2320 [16:55<15:55,  1.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1148/2320 [16:56<15:56,  1.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1149/2320 [16:57<16:03,  1.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [16:58<16:12,  1.20it/s]                                                    50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [16:58<16:12,  1.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1151/2320 [16:58<16:01,  1.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1152/2320 [16:59<15:42,  1.24it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1153/2320 [17:00<15:42,  1.24it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1154/2320 [17:01<15:45,  1.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1155/2320 [17:02<15:48,  1.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1156/2320 [17:02<15:36,  1.24it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1157/2320 [17:03<15:34,  1.24it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1158/2320 [17:04<15:25,  1.26it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1159/2320 [17:05<15:06,  1.28it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [17:05<13:46,  1.40it/s]{'eval_loss': 1.1930674314498901, 'eval_precision': 0.9161713465874155, 'eval_recall': 0.6130005485463522, 'eval_f1': 0.7345329060882425, 'eval_report': {'PAGE_HEADER': {'precision': 0.323943661971831, 'recall': 0.18449197860962566, 'f1-score': 0.23509369676320271, 'support': 374.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.3007518796992481, 'recall': 0.15503875968992248, 'f1-score': 0.20460358056265984, 'support': 258.0}, 'INGREDIENT_LINE': {'precision': 0.6876697447039652, 'recall': 0.6368209255533199, 'f1-score': 0.6612692609036301, 'support': 3976.0}, 'INSTRUCTION_STEP': {'precision': 0.6532142857142857, 'recall': 0.6839940164547494, 'f1-score': 0.6682499086591158, 'support': 2674.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.834419817470665, 'recall': 0.8613118005383199, 'f1-score': 0.8476525739779025, 'support': 14118.0}, 'accuracy': 0.7767398411957029, 'macro avg': {'precision': 0.3499999236949994, 'recall': 0.3152071851057422, 'f1-score': 0.3271086276083139, 'support': 21410.0}, 'weighted avg': {'precision': 0.7687976554196023, 'recall': 0.7767398411957029, 'f1-score': 0.7717878861701046, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[69, 0, 2, 42, 5, 0, 0, 256], [0, 0, 0, 0, 0, 0, 0, 6], [3, 0, 40, 18, 9, 0, 0, 188], [69, 1, 59, 2532, 91, 0, 8, 1216], [0, 0, 0, 102, 1829, 0, 0, 743], [0, 0, 0, 0, 0, 0, 0, 4], [0, 0, 0, 0, 0, 0, 0, 0], [72, 0, 32, 988, 866, 0, 0, 12160]], 'eval_PAGE_HEADER_precision': 0.09438202247191012, 'eval_PAGE_HEADER_recall': 0.1917808219178082, 'eval_PAGE_HEADER_f1': 0.12650602409638553, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.04792332268370607, 'eval_RECIPE_TITLE_recall': 0.1056338028169014, 'eval_RECIPE_TITLE_f1': 0.06593406593406594, 'eval_header_false_positive_rate': 0.04395604395604396, 'eval_title_false_negative_rate': 0.07100591715976332, 'eval_header_title_confusion_count': 24, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14445, 'INGREDIENT_LINE': 4840, 'INSTRUCTION_STEP': 2138, 'PAGE_HEADER': 445, 'RECIPE_TITLE': 313, 'SECTION_HEADER': 11, 'TEMP': 4}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.3359, 'eval_samples_per_second': 9.854, 'eval_steps_per_second': 2.464, 'epoch': 9.0}
{'loss': 0.3554, 'grad_norm': 11.247507095336914, 'learning_rate': 3.0411877394636018e-05, 'epoch': 9.05}
{'loss': 0.2987, 'grad_norm': 2.6988279819488525, 'learning_rate': 2.9214559386973183e-05, 'epoch': 9.48}
{'loss': 0.2397, 'grad_norm': 2.271676778793335, 'learning_rate': 2.8017241379310345e-05, 'epoch': 9.91}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  4.93it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.63it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.17it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.97it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.95it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.88it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.82it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.72it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.76it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.81it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.61it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.58it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.58it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.61it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.58it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.60it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.63it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.67it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.70it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.69it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.03it/s][A                                                   
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [17:14<13:46,  1.40it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.03it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1161/2320 [17:21<1:38:37,  5.11s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1162/2320 [17:21<1:13:09,  3.79s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1163/2320 [17:22<55:23,  2.87s/it]   50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1164/2320 [17:23<43:08,  2.24s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1165/2320 [17:24<34:22,  1.79s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1166/2320 [17:24<28:13,  1.47s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1167/2320 [17:25<24:05,  1.25s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1168/2320 [17:26<21:05,  1.10s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1169/2320 [17:27<19:05,  1.00it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1170/2320 [17:27<17:40,  1.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1171/2320 [17:28<16:50,  1.14it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1172/2320 [17:29<16:23,  1.17it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1173/2320 [17:30<15:57,  1.20it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1174/2320 [17:30<15:24,  1.24it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1175/2320 [17:31<15:14,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1176/2320 [17:32<15:00,  1.27it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1177/2320 [17:33<14:38,  1.30it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1178/2320 [17:33<14:34,  1.31it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1179/2320 [17:34<14:56,  1.27it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1180/2320 [17:35<15:19,  1.24it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1181/2320 [17:36<15:17,  1.24it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1182/2320 [17:37<15:10,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1183/2320 [17:38<15:08,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1184/2320 [17:38<15:17,  1.24it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1185/2320 [17:39<15:08,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1186/2320 [17:40<15:04,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1187/2320 [17:41<14:52,  1.27it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1188/2320 [17:42<14:53,  1.27it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1189/2320 [17:42<15:01,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1190/2320 [17:43<15:02,  1.25it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1191/2320 [17:44<14:53,  1.26it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1192/2320 [17:45<14:43,  1.28it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1193/2320 [17:45<14:55,  1.26it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1194/2320 [17:46<14:48,  1.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1195/2320 [17:47<14:40,  1.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1196/2320 [17:48<14:36,  1.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1197/2320 [17:49<14:21,  1.30it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1198/2320 [17:49<14:21,  1.30it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1199/2320 [17:50<14:33,  1.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [17:51<14:24,  1.30it/s]                                                    52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [17:51<14:24,  1.30it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1201/2320 [17:52<14:07,  1.32it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1202/2320 [17:52<14:04,  1.32it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1203/2320 [17:53<14:17,  1.30it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1204/2320 [17:54<14:07,  1.32it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1205/2320 [17:55<14:35,  1.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1206/2320 [17:56<14:30,  1.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1207/2320 [17:56<14:36,  1.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1208/2320 [17:57<14:37,  1.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1209/2320 [17:58<14:27,  1.28it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1210/2320 [17:59<14:17,  1.29it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1211/2320 [17:59<14:32,  1.27it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1212/2320 [18:00<14:38,  1.26it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1213/2320 [18:01<14:54,  1.24it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1214/2320 [18:02<14:48,  1.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1215/2320 [18:03<14:47,  1.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1216/2320 [18:03<14:43,  1.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1217/2320 [18:04<14:40,  1.25it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1218/2320 [18:05<14:31,  1.26it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1219/2320 [18:06<14:14,  1.29it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1220/2320 [18:07<14:26,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1221/2320 [18:07<14:19,  1.28it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1222/2320 [18:08<14:32,  1.26it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1223/2320 [18:09<14:41,  1.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1224/2320 [18:10<14:27,  1.26it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1225/2320 [18:11<14:17,  1.28it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1226/2320 [18:11<14:23,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1227/2320 [18:12<14:29,  1.26it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1228/2320 [18:13<14:40,  1.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1229/2320 [18:14<14:55,  1.22it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1230/2320 [18:15<14:58,  1.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1231/2320 [18:16<15:00,  1.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1232/2320 [18:16<14:44,  1.23it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1233/2320 [18:17<14:15,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1234/2320 [18:18<14:14,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1235/2320 [18:19<14:13,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1236/2320 [18:19<14:13,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1237/2320 [18:20<14:12,  1.27it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1238/2320 [18:21<14:01,  1.29it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1239/2320 [18:22<14:20,  1.26it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1240/2320 [18:23<14:21,  1.25it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1241/2320 [18:23<14:39,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1242/2320 [18:24<14:51,  1.21it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1243/2320 [18:25<14:22,  1.25it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1244/2320 [18:26<14:13,  1.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1245/2320 [18:27<14:12,  1.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1246/2320 [18:27<14:12,  1.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1247/2320 [18:28<14:31,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1248/2320 [18:29<14:37,  1.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1249/2320 [18:30<14:36,  1.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [18:31<14:40,  1.22it/s]                                                    54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [18:31<14:40,  1.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1251/2320 [18:31<14:25,  1.24it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1252/2320 [18:32<14:27,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1253/2320 [18:33<14:22,  1.24it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1254/2320 [18:34<14:25,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1255/2320 [18:35<14:22,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1256/2320 [18:35<14:02,  1.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1257/2320 [18:36<14:05,  1.26it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1258/2320 [18:37<14:19,  1.24it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1259/2320 [18:38<14:12,  1.24it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1260/2320 [18:39<14:21,  1.23it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1261/2320 [18:40<14:28,  1.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1262/2320 [18:40<14:27,  1.22it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1263/2320 [18:41<14:38,  1.20it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1264/2320 [18:42<16:18,  1.08it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1265/2320 [18:43<15:43,  1.12it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1266/2320 [18:44<15:03,  1.17it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1267/2320 [18:45<14:41,  1.19it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1268/2320 [18:46<14:26,  1.21it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1269/2320 [18:46<14:34,  1.20it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1270/2320 [18:47<14:23,  1.22it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1271/2320 [18:48<14:25,  1.21it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1272/2320 [18:49<14:30,  1.20it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1273/2320 [18:50<14:15,  1.22it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1274/2320 [18:51<14:25,  1.21it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1275/2320 [18:51<14:19,  1.22it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [18:52<12:50,  1.36it/s]{'eval_loss': 1.3709361553192139, 'eval_precision': 0.9001398042740164, 'eval_recall': 0.5788594913948112, 'eval_f1': 0.704604080356445, 'eval_report': {'PAGE_HEADER': {'precision': 0.18779342723004694, 'recall': 0.08113590263691683, 'f1-score': 0.11331444759206799, 'support': 493.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.24812030075187969, 'recall': 0.102803738317757, 'f1-score': 0.14537444933920704, 'support': 321.0}, 'INGREDIENT_LINE': {'precision': 0.6892992938620315, 'recall': 0.6714285714285714, 'f1-score': 0.6802465826856071, 'support': 3780.0}, 'INSTRUCTION_STEP': {'precision': 0.6771428571428572, 'recall': 0.5954773869346733, 'f1-score': 0.6336898395721925, 'support': 3184.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8093048788856104, 'recall': 0.8656782149148561, 'f1-score': 0.836542894634181, 'support': 13624.0}, 'accuracy': 0.761373190098085, 'macro avg': {'precision': 0.3264575947340532, 'recall': 0.28956547677909683, 'f1-score': 0.30114602672790697, 'support': 21410.0}, 'weighted avg': {'precision': 0.7454354336312311, 'recall': 0.761373190098085, 'f1-score': 0.7514521321413504, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[40, 0, 2, 37, 5, 0, 0, 409], [0, 0, 0, 0, 0, 0, 0, 4], [2, 0, 33, 25, 8, 0, 0, 253], [105, 1, 68, 2538, 113, 0, 8, 947], [0, 0, 0, 126, 1896, 0, 0, 1162], [0, 0, 0, 0, 0, 0, 0, 4], [0, 0, 0, 0, 0, 0, 0, 0], [66, 0, 30, 956, 778, 0, 0, 11794]], 'eval_PAGE_HEADER_precision': 0.057971014492753624, 'eval_PAGE_HEADER_recall': 0.1461187214611872, 'eval_PAGE_HEADER_f1': 0.08300907911802853, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.01971830985915493, 'eval_RECIPE_TITLE_recall': 0.04929577464788732, 'eval_RECIPE_TITLE_f1': 0.028169014084507046, 'eval_header_false_positive_rate': 0.038314176245210725, 'eval_title_false_negative_rate': 0.026143790849673203, 'eval_header_title_confusion_count': 14, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14173, 'INGREDIENT_LINE': 4486, 'INSTRUCTION_STEP': 2617, 'PAGE_HEADER': 552, 'RECIPE_TITLE': 355, 'SECTION_HEADER': 9, 'TEMP': 4}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.121, 'eval_samples_per_second': 10.087, 'eval_steps_per_second': 2.522, 'epoch': 10.0}
{'loss': 0.1924, 'grad_norm': 51.13750076293945, 'learning_rate': 2.681992337164751e-05, 'epoch': 10.34}
{'loss': 0.23, 'grad_norm': 2.2449798583984375, 'learning_rate': 2.5622605363984675e-05, 'epoch': 10.78}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.64it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.79it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.29it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.14it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.05it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.92it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.72it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.73it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.75it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.70it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.56it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.60it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.64it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.59it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.61it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.65it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.57it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.57it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.65it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.03it/s][A                                                   
                                               [A 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [19:01<12:50,  1.36it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.03it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1277/2320 [19:08<1:32:14,  5.31s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1278/2320 [19:09<1:09:27,  4.00s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1279/2320 [19:10<52:48,  3.04s/it]   55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1280/2320 [19:11<41:33,  2.40s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1281/2320 [19:11<32:52,  1.90s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1282/2320 [19:12<26:53,  1.55s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1283/2320 [19:13<22:36,  1.31s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1284/2320 [19:13<19:32,  1.13s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1285/2320 [19:14<17:32,  1.02s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1286/2320 [19:15<15:54,  1.08it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1287/2320 [19:16<14:58,  1.15it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1288/2320 [19:16<14:17,  1.20it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1289/2320 [19:17<14:03,  1.22it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1290/2320 [19:18<13:31,  1.27it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1291/2320 [19:19<13:15,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1292/2320 [19:19<12:52,  1.33it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1293/2320 [19:20<13:06,  1.31it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1294/2320 [19:21<12:57,  1.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1295/2320 [19:22<13:21,  1.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1296/2320 [19:23<13:20,  1.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1297/2320 [19:23<13:20,  1.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1298/2320 [19:24<13:14,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1299/2320 [19:25<13:14,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [19:26<13:11,  1.29it/s]                                                    56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [19:26<13:11,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1301/2320 [19:26<13:03,  1.30it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1302/2320 [19:27<13:07,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1303/2320 [19:28<13:08,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1304/2320 [19:29<13:13,  1.28it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1305/2320 [19:30<13:23,  1.26it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1306/2320 [19:30<13:08,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1307/2320 [19:31<12:54,  1.31it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1308/2320 [19:32<12:42,  1.33it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1309/2320 [19:32<12:43,  1.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1310/2320 [19:33<13:00,  1.29it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1311/2320 [19:34<13:16,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1312/2320 [19:35<13:39,  1.23it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1313/2320 [19:36<13:27,  1.25it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1314/2320 [19:37<13:10,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1315/2320 [19:37<13:07,  1.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1316/2320 [19:38<12:57,  1.29it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1317/2320 [19:39<13:10,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1318/2320 [19:40<13:02,  1.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1319/2320 [19:40<13:05,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1320/2320 [19:41<12:42,  1.31it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1321/2320 [19:42<12:46,  1.30it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1322/2320 [19:43<13:15,  1.25it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1323/2320 [19:44<13:30,  1.23it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1324/2320 [19:44<13:21,  1.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1325/2320 [19:45<13:06,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1326/2320 [19:46<12:58,  1.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1327/2320 [19:47<13:13,  1.25it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1328/2320 [19:48<13:18,  1.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1329/2320 [19:48<13:19,  1.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1330/2320 [19:49<13:21,  1.24it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1331/2320 [19:50<12:57,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1332/2320 [19:51<12:57,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1333/2320 [19:52<12:45,  1.29it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1334/2320 [19:52<12:52,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1335/2320 [19:53<12:54,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1336/2320 [19:54<12:55,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1337/2320 [19:55<12:54,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1338/2320 [19:55<12:42,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1339/2320 [19:56<12:44,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1340/2320 [19:57<12:45,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1341/2320 [19:58<12:51,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1342/2320 [19:59<12:43,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1343/2320 [19:59<12:36,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1344/2320 [20:00<12:44,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1345/2320 [20:01<12:25,  1.31it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1346/2320 [20:02<12:25,  1.31it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1347/2320 [20:02<12:34,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1348/2320 [20:03<12:36,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1349/2320 [20:04<12:40,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [20:05<12:35,  1.28it/s]                                                    58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [20:05<12:35,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1351/2320 [20:06<12:34,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1352/2320 [20:06<12:37,  1.28it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1353/2320 [20:07<12:41,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1354/2320 [20:08<12:51,  1.25it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1355/2320 [20:09<12:47,  1.26it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1356/2320 [20:10<13:03,  1.23it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1357/2320 [20:10<12:58,  1.24it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1358/2320 [20:11<12:47,  1.25it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1359/2320 [20:12<12:56,  1.24it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1360/2320 [20:13<13:10,  1.21it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1361/2320 [20:14<12:57,  1.23it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1362/2320 [20:14<12:46,  1.25it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1363/2320 [20:15<12:39,  1.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1364/2320 [20:16<12:23,  1.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1365/2320 [20:17<12:31,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1366/2320 [20:18<12:30,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1367/2320 [20:18<12:29,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1368/2320 [20:19<12:12,  1.30it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1369/2320 [20:20<12:14,  1.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1370/2320 [20:21<12:27,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1371/2320 [20:21<12:41,  1.25it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1372/2320 [20:22<13:07,  1.20it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1373/2320 [20:23<12:52,  1.23it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1374/2320 [20:24<12:36,  1.25it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1375/2320 [20:25<12:30,  1.26it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1376/2320 [20:25<12:03,  1.31it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1377/2320 [20:26<12:12,  1.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1378/2320 [20:27<12:08,  1.29it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1379/2320 [20:28<12:18,  1.27it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1380/2320 [20:29<12:25,  1.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1381/2320 [20:29<12:27,  1.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1382/2320 [20:30<12:41,  1.23it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1383/2320 [20:31<12:26,  1.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1384/2320 [20:32<12:09,  1.28it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1385/2320 [20:33<12:31,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1386/2320 [20:33<12:31,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1387/2320 [20:34<12:30,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1388/2320 [20:35<12:33,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1389/2320 [20:36<12:29,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1390/2320 [20:37<12:49,  1.21it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1391/2320 [20:37<12:30,  1.24it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [20:38<11:04,  1.40it/s]{'eval_loss': 1.330122947692871, 'eval_precision': 0.9114688128772636, 'eval_recall': 0.6412797281993206, 'eval_f1': 0.7528668771813196, 'eval_report': {'PAGE_HEADER': {'precision': 0.4647887323943662, 'recall': 0.19681908548707752, 'f1-score': 0.276536312849162, 'support': 503.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'RECIPE_TITLE': {'precision': 0.47368421052631576, 'recall': 0.1721311475409836, 'f1-score': 0.25250501002004005, 'support': 366.0}, 'INGREDIENT_LINE': {'precision': 0.6871265616512765, 'recall': 0.7593037214885955, 'f1-score': 0.7214143142286855, 'support': 3332.0}, 'INSTRUCTION_STEP': {'precision': 0.6564285714285715, 'recall': 0.6426573426573426, 'f1-score': 0.649469964664311, 'support': 2860.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8563096136691141, 'recall': 0.869859194200474, 'f1-score': 0.8630312251460978, 'support': 14346.0}, 'accuracy': 0.7944418496029892, 'macro avg': {'precision': 0.448333955667092, 'recall': 0.3772529273392104, 'f1-score': 0.39470811812975665, 'support': 21410.0}, 'weighted avg': {'precision': 0.7874201909786024, 'recall': 0.7944418496029892, 'f1-score': 0.7881269102721293, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[99, 0, 4, 39, 11, 2, 348], [0, 0, 0, 0, 0, 0, 3], [9, 0, 63, 27, 12, 0, 255], [55, 1, 44, 2530, 113, 6, 583], [0, 0, 0, 117, 1838, 0, 905], [0, 0, 0, 0, 0, 0, 0], [50, 0, 22, 969, 826, 0, 12479]], 'eval_PAGE_HEADER_precision': 0.10321489001692047, 'eval_PAGE_HEADER_recall': 0.2785388127853881, 'eval_PAGE_HEADER_f1': 0.15061728395061727, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.04215456674473068, 'eval_RECIPE_TITLE_recall': 0.1267605633802817, 'eval_RECIPE_TITLE_f1': 0.0632688927943761, 'eval_header_false_positive_rate': 0.09967845659163987, 'eval_title_false_negative_rate': 0.13513513513513514, 'eval_header_title_confusion_count': 56, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14836, 'INGREDIENT_LINE': 3998, 'INSTRUCTION_STEP': 2337, 'PAGE_HEADER': 591, 'RECIPE_TITLE': 427, 'SECTION_HEADER': 7}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.1808, 'eval_samples_per_second': 10.021, 'eval_steps_per_second': 2.505, 'epoch': 11.0}
{'loss': 0.2083, 'grad_norm': 4.93035888671875, 'learning_rate': 2.442528735632184e-05, 'epoch': 11.21}
{'loss': 0.1705, 'grad_norm': 1.813225269317627, 'learning_rate': 2.3227969348659002e-05, 'epoch': 11.64}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  5.02it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.61it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.14it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.91it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.93it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.84it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.80it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.78it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.78it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.84it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.80it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.76it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.77it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.82it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.84it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.84it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.86it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.82it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.70it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.73it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.76it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.07it/s][A                                                   
                                               [A 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [20:47<11:04,  1.40it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.07it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1393/2320 [20:53<1:15:08,  4.86s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1394/2320 [20:53<55:54,  3.62s/it]   60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1395/2320 [20:54<42:31,  2.76s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1396/2320 [20:55<33:12,  2.16s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1397/2320 [20:55<26:31,  1.72s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1398/2320 [20:56<21:50,  1.42s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1399/2320 [20:57<18:33,  1.21s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [20:58<16:13,  1.06s/it]                                                    60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [20:58<16:13,  1.06s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1401/2320 [20:58<14:52,  1.03it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1402/2320 [20:59<13:56,  1.10it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1403/2320 [21:00<13:09,  1.16it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1404/2320 [21:01<12:43,  1.20it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1405/2320 [21:01<12:31,  1.22it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1406/2320 [21:02<12:17,  1.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1407/2320 [21:03<12:06,  1.26it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1408/2320 [21:04<12:01,  1.26it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1409/2320 [21:05<11:45,  1.29it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1410/2320 [21:05<11:41,  1.30it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1411/2320 [21:06<11:51,  1.28it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1412/2320 [21:07<11:54,  1.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1413/2320 [21:08<12:11,  1.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1414/2320 [21:09<12:15,  1.23it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1415/2320 [21:09<12:08,  1.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1416/2320 [21:10<12:02,  1.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1417/2320 [21:11<12:03,  1.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1418/2320 [21:12<11:51,  1.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1419/2320 [21:13<12:06,  1.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1420/2320 [21:13<12:04,  1.24it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1421/2320 [21:14<11:52,  1.26it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1422/2320 [21:15<11:44,  1.28it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1423/2320 [21:16<11:58,  1.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1424/2320 [21:17<12:08,  1.23it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1425/2320 [21:17<11:53,  1.25it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1426/2320 [21:18<11:55,  1.25it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1427/2320 [21:19<12:04,  1.23it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1428/2320 [21:20<11:53,  1.25it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1429/2320 [21:21<12:07,  1.22it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1430/2320 [21:22<13:43,  1.08it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1431/2320 [21:23<13:04,  1.13it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1432/2320 [21:23<12:47,  1.16it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1433/2320 [21:24<12:42,  1.16it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1434/2320 [21:25<14:04,  1.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1435/2320 [21:26<13:09,  1.12it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1436/2320 [21:27<12:54,  1.14it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1437/2320 [21:28<12:49,  1.15it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1438/2320 [21:29<12:32,  1.17it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1439/2320 [21:29<12:12,  1.20it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1440/2320 [21:30<12:12,  1.20it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1441/2320 [21:31<12:05,  1.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1442/2320 [21:32<12:05,  1.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1443/2320 [21:33<12:03,  1.21it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1444/2320 [21:34<11:56,  1.22it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1445/2320 [21:34<11:54,  1.22it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1446/2320 [21:35<11:47,  1.23it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1447/2320 [21:36<11:28,  1.27it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1448/2320 [21:37<11:18,  1.28it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1449/2320 [21:37<11:42,  1.24it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [21:38<11:52,  1.22it/s]                                                    62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [21:38<11:52,  1.22it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1451/2320 [21:39<11:47,  1.23it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1452/2320 [21:40<11:41,  1.24it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1453/2320 [21:41<11:37,  1.24it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1454/2320 [21:41<11:25,  1.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1455/2320 [21:42<11:24,  1.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1456/2320 [21:43<11:16,  1.28it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1457/2320 [21:44<11:17,  1.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1458/2320 [21:45<11:17,  1.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1459/2320 [21:45<11:20,  1.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1460/2320 [21:46<11:16,  1.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1461/2320 [21:47<11:36,  1.23it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1462/2320 [21:48<11:26,  1.25it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1463/2320 [21:49<11:23,  1.25it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1464/2320 [21:49<11:13,  1.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1465/2320 [21:50<11:09,  1.28it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1466/2320 [21:51<11:12,  1.27it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1467/2320 [21:52<11:04,  1.28it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1468/2320 [21:52<11:00,  1.29it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1469/2320 [21:53<11:03,  1.28it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1470/2320 [21:54<11:01,  1.28it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1471/2320 [21:55<11:12,  1.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1472/2320 [21:56<11:14,  1.26it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1473/2320 [21:56<11:09,  1.26it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1474/2320 [21:57<11:07,  1.27it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1475/2320 [21:58<11:04,  1.27it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1476/2320 [21:59<10:51,  1.30it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1477/2320 [22:00<10:51,  1.29it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1478/2320 [22:00<10:59,  1.28it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1479/2320 [22:01<11:03,  1.27it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1480/2320 [22:02<11:10,  1.25it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1481/2320 [22:03<11:14,  1.24it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1482/2320 [22:04<11:20,  1.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1483/2320 [22:04<11:17,  1.24it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1484/2320 [22:05<11:19,  1.23it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1485/2320 [22:06<11:01,  1.26it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1486/2320 [22:07<11:02,  1.26it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1487/2320 [22:08<10:59,  1.26it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1488/2320 [22:08<10:59,  1.26it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1489/2320 [22:09<10:45,  1.29it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1490/2320 [22:10<10:22,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1491/2320 [22:11<10:24,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1492/2320 [22:11<10:22,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1493/2320 [22:12<10:20,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1494/2320 [22:13<10:36,  1.30it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1495/2320 [22:14<10:37,  1.29it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1496/2320 [22:14<10:18,  1.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1497/2320 [22:15<10:35,  1.30it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1498/2320 [22:16<10:40,  1.28it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1499/2320 [22:17<10:46,  1.27it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [22:18<10:44,  1.27it/s]                                                    65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [22:18<10:44,  1.27it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1501/2320 [22:18<10:30,  1.30it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1502/2320 [22:19<10:26,  1.30it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1503/2320 [22:20<10:24,  1.31it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1504/2320 [22:21<10:19,  1.32it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1505/2320 [22:21<10:05,  1.35it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1506/2320 [22:22<10:12,  1.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1507/2320 [22:23<10:13,  1.33it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [22:23<09:01,  1.50it/s]{'eval_loss': 1.256976842880249, 'eval_precision': 0.9183397683397684, 'eval_recall': 0.6099499935889217, 'eval_f1': 0.7330302796825642, 'eval_report': {'PAGE_HEADER': {'precision': 0.6995305164319249, 'recall': 0.26750448833034113, 'f1-score': 0.38701298701298703, 'support': 557.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.8045112781954887, 'recall': 0.20419847328244276, 'f1-score': 0.3257229832572298, 'support': 524.0}, 'INGREDIENT_LINE': {'precision': 0.7523085279739272, 'recall': 0.7109856262833676, 'f1-score': 0.7310636051728688, 'support': 3896.0}, 'INSTRUCTION_STEP': {'precision': 0.6182142857142857, 'recall': 0.6153572698186989, 'f1-score': 0.6167824692677712, 'support': 2813.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8202840870102244, 'recall': 0.8782602306957608, 'f1-score': 0.8482827135963668, 'support': 13611.0}, 'accuracy': 0.7805231200373657, 'macro avg': {'precision': 0.4618560869157314, 'recall': 0.3345382610513264, 'f1-score': 0.36360809478840295, 'support': 21410.0}, 'weighted avg': {'precision': 0.7774927569558099, 'recall': 0.7805231200373657, 'f1-score': 0.7713897236598276, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[149, 0, 3, 25, 21, 0, 2, 357], [0, 0, 0, 0, 0, 0, 0, 5], [19, 0, 107, 43, 27, 0, 1, 327], [41, 1, 23, 2770, 127, 0, 5, 929], [1, 0, 0, 84, 1731, 0, 0, 997], [0, 0, 0, 0, 0, 0, 0, 4], [0, 0, 0, 0, 0, 0, 0, 0], [3, 0, 0, 760, 894, 0, 0, 11954]], 'eval_PAGE_HEADER_precision': 0.16018662519440124, 'eval_PAGE_HEADER_recall': 0.4703196347031963, 'eval_PAGE_HEADER_f1': 0.23897911832946636, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.07214765100671142, 'eval_RECIPE_TITLE_recall': 0.3028169014084507, 'eval_RECIPE_TITLE_f1': 0.11653116531165311, 'eval_header_false_positive_rate': 0.1320754716981132, 'eval_title_false_negative_rate': 0.17040358744394618, 'eval_header_title_confusion_count': 87, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14315, 'INGREDIENT_LINE': 4491, 'INSTRUCTION_STEP': 2137, 'PAGE_HEADER': 643, 'RECIPE_TITLE': 596, 'SECTION_HEADER': 9, 'TEMP': 5}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.8072, 'eval_samples_per_second': 10.446, 'eval_steps_per_second': 2.612, 'epoch': 12.0}
{'loss': 0.1583, 'grad_norm': 4.329507350921631, 'learning_rate': 2.203065134099617e-05, 'epoch': 12.07}
{'loss': 0.1407, 'grad_norm': 2.3965461254119873, 'learning_rate': 2.0833333333333336e-05, 'epoch': 12.5}
{'loss': 0.1498, 'grad_norm': 1.2832988500595093, 'learning_rate': 1.9636015325670498e-05, 'epoch': 12.93}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.87it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.12it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.40it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.17it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.14it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.07it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.95it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.89it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.97it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.00it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.99it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.85it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.76it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.73it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.82it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.83it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.86it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.92it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.86it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.87it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.91it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.31it/s][A                                                   
                                               [A 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [22:32<09:01,  1.50it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.31it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1509/2320 [22:38<1:04:40,  4.79s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1510/2320 [22:38<47:55,  3.55s/it]   65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1511/2320 [22:39<36:17,  2.69s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1512/2320 [22:40<28:17,  2.10s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1513/2320 [22:40<22:42,  1.69s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1514/2320 [22:41<18:47,  1.40s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1515/2320 [22:42<15:57,  1.19s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1516/2320 [22:43<13:52,  1.04s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1517/2320 [22:43<12:31,  1.07it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1518/2320 [22:44<11:47,  1.13it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1519/2320 [22:45<11:06,  1.20it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1520/2320 [22:45<10:37,  1.26it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1521/2320 [22:46<10:18,  1.29it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1522/2320 [22:47<10:08,  1.31it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1523/2320 [22:48<10:04,  1.32it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1524/2320 [22:48<09:52,  1.34it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1525/2320 [22:49<10:26,  1.27it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1526/2320 [22:50<10:27,  1.27it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1527/2320 [22:51<10:29,  1.26it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1528/2320 [22:52<10:31,  1.25it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1529/2320 [22:53<10:43,  1.23it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1530/2320 [22:53<10:47,  1.22it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1531/2320 [22:54<10:39,  1.23it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1532/2320 [22:55<10:54,  1.20it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1533/2320 [22:56<10:50,  1.21it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1534/2320 [22:57<10:58,  1.19it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1535/2320 [22:58<10:55,  1.20it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1536/2320 [22:58<10:44,  1.22it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1537/2320 [22:59<10:40,  1.22it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1538/2320 [23:00<10:49,  1.20it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1539/2320 [23:01<11:11,  1.16it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1540/2320 [23:02<11:24,  1.14it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1541/2320 [23:03<11:20,  1.14it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1542/2320 [23:04<11:10,  1.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1543/2320 [23:04<10:56,  1.18it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1544/2320 [23:05<10:52,  1.19it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1545/2320 [23:06<10:56,  1.18it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1546/2320 [23:07<10:50,  1.19it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1547/2320 [23:08<10:32,  1.22it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1548/2320 [23:08<10:40,  1.20it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1549/2320 [23:09<10:53,  1.18it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [23:10<10:56,  1.17it/s]                                                    67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [23:10<10:56,  1.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1551/2320 [23:11<10:55,  1.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1552/2320 [23:12<11:05,  1.15it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1553/2320 [23:13<10:53,  1.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1554/2320 [23:14<10:56,  1.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1555/2320 [23:15<10:52,  1.17it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1556/2320 [23:15<10:43,  1.19it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1557/2320 [23:16<10:40,  1.19it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1558/2320 [23:17<12:17,  1.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1559/2320 [23:18<11:46,  1.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1560/2320 [23:19<11:22,  1.11it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1561/2320 [23:20<11:03,  1.14it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1562/2320 [23:21<10:52,  1.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1563/2320 [23:22<10:51,  1.16it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1564/2320 [23:23<11:08,  1.13it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1565/2320 [23:23<11:07,  1.13it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1566/2320 [23:24<10:51,  1.16it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1567/2320 [23:25<10:43,  1.17it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1568/2320 [23:26<10:49,  1.16it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1569/2320 [23:27<10:44,  1.17it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1570/2320 [23:28<10:36,  1.18it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1571/2320 [23:28<10:27,  1.19it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1572/2320 [23:29<10:20,  1.20it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1573/2320 [23:30<10:14,  1.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1574/2320 [23:31<10:13,  1.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1575/2320 [23:32<10:11,  1.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1576/2320 [23:33<10:17,  1.20it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1577/2320 [23:33<10:11,  1.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1578/2320 [23:34<09:57,  1.24it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1579/2320 [23:35<09:57,  1.24it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1580/2320 [23:36<10:13,  1.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1581/2320 [23:37<10:11,  1.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1582/2320 [23:37<09:59,  1.23it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1583/2320 [23:38<10:10,  1.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1584/2320 [23:39<10:09,  1.21it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1585/2320 [23:40<10:01,  1.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1586/2320 [23:41<09:55,  1.23it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1587/2320 [23:41<09:51,  1.24it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1588/2320 [23:42<10:01,  1.22it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1589/2320 [23:43<10:17,  1.18it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1590/2320 [23:44<10:12,  1.19it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1591/2320 [23:45<10:05,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1592/2320 [23:46<10:05,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1593/2320 [23:47<09:58,  1.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1594/2320 [23:47<10:03,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1595/2320 [23:48<09:58,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1596/2320 [23:49<10:05,  1.19it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1597/2320 [23:50<09:56,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1598/2320 [23:51<09:50,  1.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1599/2320 [23:51<09:56,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [23:52<09:49,  1.22it/s]                                                    69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [23:52<09:49,  1.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1601/2320 [23:53<09:43,  1.23it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1602/2320 [23:54<09:49,  1.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1603/2320 [23:55<09:56,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1604/2320 [23:56<09:48,  1.22it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1605/2320 [23:56<09:49,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1606/2320 [23:57<09:52,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1607/2320 [23:58<09:56,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1608/2320 [23:59<09:55,  1.20it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1609/2320 [24:00<09:47,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1610/2320 [24:01<09:33,  1.24it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1611/2320 [24:01<09:46,  1.21it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1612/2320 [24:02<09:41,  1.22it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1613/2320 [24:03<09:32,  1.24it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1614/2320 [24:04<09:52,  1.19it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1615/2320 [24:05<09:53,  1.19it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1616/2320 [24:06<09:44,  1.20it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1617/2320 [24:06<09:39,  1.21it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1618/2320 [24:07<09:38,  1.21it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1619/2320 [24:08<09:34,  1.22it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1620/2320 [24:09<09:34,  1.22it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1621/2320 [24:10<09:33,  1.22it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1622/2320 [24:10<09:29,  1.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1623/2320 [24:11<09:17,  1.25it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [24:12<08:23,  1.38it/s]{'eval_loss': 1.5241528749465942, 'eval_precision': 0.9048562933597621, 'eval_recall': 0.6424148606811145, 'eval_f1': 0.7513784873672948, 'eval_report': {'PAGE_HEADER': {'precision': 0.1596244131455399, 'recall': 0.29310344827586204, 'f1-score': 0.2066869300911854, 'support': 116.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2.0}, 'RECIPE_TITLE': {'precision': 0.13533834586466165, 'recall': 0.2571428571428571, 'f1-score': 0.17733990147783252, 'support': 70.0}, 'INGREDIENT_LINE': {'precision': 0.7126561651276481, 'recall': 0.6801451529289787, 'f1-score': 0.6960212201591512, 'support': 3858.0}, 'INSTRUCTION_STEP': {'precision': 0.6746428571428571, 'recall': 0.6173202614379085, 'f1-score': 0.6447098976109215, 'support': 3060.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8585740753448158, 'recall': 0.8747203579418344, 'f1-score': 0.8665720123281504, 'support': 14304.0}, 'accuracy': 0.7976179355441383, 'macro avg': {'precision': 0.3629765509465032, 'recall': 0.3889188682467773, 'f1-score': 0.37018999452389156, 'support': 21410.0}, 'weighted avg': {'precision': 0.7997603137686717, 'recall': 0.7976179355441383, 'f1-score': 0.7982203500887114, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[34, 0, 2, 12, 0, 0, 68], [0, 0, 0, 0, 0, 0, 2], [2, 0, 18, 12, 0, 0, 38], [98, 1, 69, 2624, 147, 5, 914], [0, 0, 0, 132, 1889, 0, 1039], [0, 0, 0, 0, 0, 0, 0], [79, 0, 44, 902, 764, 3, 12512]], 'eval_PAGE_HEADER_precision': 0.13020833333333334, 'eval_PAGE_HEADER_recall': 0.1141552511415525, 'eval_PAGE_HEADER_f1': 0.12165450121654502, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.020689655172413793, 'eval_header_title_confusion_count': 3, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14593, 'INGREDIENT_LINE': 4604, 'INSTRUCTION_STEP': 2695, 'PAGE_HEADER': 192, 'RECIPE_TITLE': 107, 'SECTION_HEADER': 5}, 'eval_title_anchor_accuracy': 0.3333333333333333, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 2, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.419, 'eval_samples_per_second': 10.928, 'eval_steps_per_second': 2.732, 'epoch': 13.0}
{'loss': 0.1432, 'grad_norm': 1.018518090248108, 'learning_rate': 1.8438697318007663e-05, 'epoch': 13.36}
{'loss': 0.114, 'grad_norm': 4.165609359741211, 'learning_rate': 1.7241379310344828e-05, 'epoch': 13.79}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.35it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.84it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.08it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.82it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:06,  2.79it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.73it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.61it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.55it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.58it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.66it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.63it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.56it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.50it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.49it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.51it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.58it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.56it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:07<00:01,  2.59it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.55it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.61it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.66it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.07it/s][A                                                   
                                               [A 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [24:21<08:23,  1.38it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.07it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1625/2320 [24:28<1:03:51,  5.51s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1626/2320 [24:29<47:17,  4.09s/it]   70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1627/2320 [24:30<35:35,  3.08s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1628/2320 [24:31<27:24,  2.38s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1629/2320 [24:31<21:43,  1.89s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1630/2320 [24:32<17:48,  1.55s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1631/2320 [24:33<15:00,  1.31s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1632/2320 [24:34<13:01,  1.14s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1633/2320 [24:34<11:35,  1.01s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1634/2320 [24:35<10:39,  1.07it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1635/2320 [24:36<09:56,  1.15it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1636/2320 [24:37<09:34,  1.19it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1637/2320 [24:37<09:08,  1.25it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1638/2320 [24:38<08:57,  1.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1639/2320 [24:39<08:47,  1.29it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1640/2320 [24:40<08:46,  1.29it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1641/2320 [24:40<08:48,  1.28it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1642/2320 [24:41<08:54,  1.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1643/2320 [24:42<08:51,  1.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1644/2320 [24:43<08:57,  1.26it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1645/2320 [24:44<09:14,  1.22it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1646/2320 [24:45<09:21,  1.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1647/2320 [24:45<09:24,  1.19it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1648/2320 [24:46<09:24,  1.19it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1649/2320 [24:47<09:19,  1.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [24:48<09:14,  1.21it/s]                                                    71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [24:48<09:14,  1.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1651/2320 [24:49<09:12,  1.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1652/2320 [24:50<09:15,  1.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1653/2320 [24:50<09:09,  1.21it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1654/2320 [24:51<08:58,  1.24it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1655/2320 [24:52<08:50,  1.25it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1656/2320 [24:53<08:43,  1.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1657/2320 [24:53<08:54,  1.24it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1658/2320 [24:54<08:49,  1.25it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1659/2320 [24:55<08:50,  1.25it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1660/2320 [24:56<08:52,  1.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1661/2320 [24:57<08:50,  1.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1662/2320 [24:58<08:58,  1.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1663/2320 [24:58<09:05,  1.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1664/2320 [24:59<09:02,  1.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1665/2320 [25:00<08:59,  1.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1666/2320 [25:01<09:05,  1.20it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1667/2320 [25:02<09:01,  1.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1668/2320 [25:03<08:52,  1.23it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1669/2320 [25:03<08:43,  1.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1670/2320 [25:04<08:43,  1.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1671/2320 [25:05<08:40,  1.25it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1672/2320 [25:06<08:51,  1.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1673/2320 [25:07<08:48,  1.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1674/2320 [25:07<08:50,  1.22it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1675/2320 [25:08<08:43,  1.23it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1676/2320 [25:09<08:40,  1.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1677/2320 [25:10<08:44,  1.23it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1678/2320 [25:11<09:00,  1.19it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1679/2320 [25:12<08:50,  1.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1680/2320 [25:12<08:46,  1.21it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1681/2320 [25:13<08:41,  1.23it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1682/2320 [25:14<08:38,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1683/2320 [25:15<08:46,  1.21it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1684/2320 [25:16<08:38,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1685/2320 [25:16<08:47,  1.20it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1686/2320 [25:17<08:44,  1.21it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1687/2320 [25:18<08:34,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1688/2320 [25:19<08:28,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1689/2320 [25:20<08:28,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1690/2320 [25:20<08:27,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1691/2320 [25:21<08:26,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1692/2320 [25:22<08:32,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1693/2320 [25:23<08:28,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1694/2320 [25:24<08:30,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1695/2320 [25:25<08:29,  1.23it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1696/2320 [25:25<08:34,  1.21it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1697/2320 [25:26<08:48,  1.18it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1698/2320 [25:27<08:40,  1.19it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1699/2320 [25:28<08:27,  1.22it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [25:29<08:31,  1.21it/s]                                                    73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [25:29<08:31,  1.21it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1701/2320 [25:30<08:29,  1.22it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1702/2320 [25:30<08:36,  1.20it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1703/2320 [25:31<08:44,  1.18it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1704/2320 [25:32<08:38,  1.19it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1705/2320 [25:33<08:31,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1706/2320 [25:34<08:36,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1707/2320 [25:35<08:32,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1708/2320 [25:35<08:26,  1.21it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1709/2320 [25:36<08:32,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1710/2320 [25:37<08:29,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1711/2320 [25:38<09:17,  1.09it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1712/2320 [25:39<08:58,  1.13it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1713/2320 [25:40<08:42,  1.16it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1714/2320 [25:41<08:38,  1.17it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1715/2320 [25:41<08:27,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1716/2320 [25:42<08:29,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1717/2320 [25:43<08:32,  1.18it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1718/2320 [25:44<08:28,  1.18it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1719/2320 [25:45<08:26,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1720/2320 [25:46<08:20,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1721/2320 [25:47<08:22,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1722/2320 [25:47<08:22,  1.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1723/2320 [25:48<08:29,  1.17it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1724/2320 [25:49<08:14,  1.21it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1725/2320 [25:50<08:13,  1.21it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1726/2320 [25:51<08:14,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1727/2320 [25:52<08:15,  1.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1728/2320 [25:52<08:17,  1.19it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1729/2320 [25:53<08:07,  1.21it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1730/2320 [25:54<07:55,  1.24it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1731/2320 [25:55<08:08,  1.21it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1732/2320 [25:56<08:03,  1.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1733/2320 [25:56<07:58,  1.23it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1734/2320 [25:57<07:56,  1.23it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1735/2320 [25:58<08:01,  1.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1736/2320 [25:59<07:58,  1.22it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1737/2320 [26:00<07:44,  1.25it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1738/2320 [26:00<07:50,  1.24it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1739/2320 [26:01<07:49,  1.24it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [26:02<06:55,  1.40it/s]{'eval_loss': 1.6741020679473877, 'eval_precision': 0.9144573322286661, 'eval_recall': 0.652816797279314, 'eval_f1': 0.7617979466827711, 'eval_report': {'PAGE_HEADER': {'precision': 0.3380281690140845, 'recall': 0.17518248175182483, 'f1-score': 0.23076923076923078, 'support': 411.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.42857142857142855, 'recall': 0.1676470588235294, 'f1-score': 0.24101479915433405, 'support': 340.0}, 'INGREDIENT_LINE': {'precision': 0.724877783813145, 'recall': 0.6954142782699323, 'f1-score': 0.7098404255319148, 'support': 3838.0}, 'INSTRUCTION_STEP': {'precision': 0.5775, 'recall': 0.7472273567467652, 'f1-score': 0.6514907332796133, 'support': 2164.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8672202017429493, 'recall': 0.8628388065815525, 'f1-score': 0.8650239561943874, 'support': 14647.0}, 'accuracy': 0.7964969640354974, 'macro avg': {'precision': 0.3670246978927009, 'recall': 0.3310387477717005, 'f1-score': 0.33726739311618503, 'support': 21410.0}, 'weighted avg': {'precision': 0.7948906628857031, 'recall': 0.7964969640354974, 'f1-score': 0.7931336091520969, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[72, 0, 2, 35, 16, 0, 0, 286], [0, 0, 0, 0, 0, 0, 0, 6], [6, 0, 57, 42, 13, 0, 0, 222], [57, 1, 32, 2669, 139, 0, 3, 937], [0, 0, 0, 67, 1617, 0, 0, 480], [0, 0, 0, 0, 0, 0, 0, 4], [0, 0, 0, 0, 0, 0, 0, 0], [78, 0, 42, 869, 1015, 0, 5, 12638]], 'eval_PAGE_HEADER_precision': 0.07234042553191489, 'eval_PAGE_HEADER_recall': 0.1552511415525114, 'eval_PAGE_HEADER_f1': 0.09869375907111755, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.037333333333333336, 'eval_RECIPE_TITLE_recall': 0.09859154929577464, 'eval_RECIPE_TITLE_f1': 0.05415860735009671, 'eval_header_false_positive_rate': 0.03065134099616858, 'eval_title_false_negative_rate': 0.07142857142857142, 'eval_header_title_confusion_count': 20, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14924, 'INGREDIENT_LINE': 4585, 'INSTRUCTION_STEP': 1829, 'PAGE_HEADER': 470, 'RECIPE_TITLE': 375, 'SECTION_HEADER': 9, 'TEMP': 4}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.4443, 'eval_samples_per_second': 9.741, 'eval_steps_per_second': 2.435, 'epoch': 14.0}
{'loss': 0.1234, 'grad_norm': 3.4293603897094727, 'learning_rate': 1.6044061302681994e-05, 'epoch': 14.22}
{'loss': 0.0974, 'grad_norm': 11.751948356628418, 'learning_rate': 1.4846743295019159e-05, 'epoch': 14.66}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  5.17it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.70it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.22it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.89it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.85it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.81it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.77it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.71it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.73it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.72it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.71it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.67it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.70it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.74it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.80it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.86it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.79it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.74it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.78it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.75it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.05it/s][A                                                   
                                               [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [26:11<06:55,  1.40it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.05it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1741/2320 [26:17<48:55,  5.07s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1742/2320 [26:18<36:22,  3.78s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1743/2320 [26:19<27:41,  2.88s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1744/2320 [26:19<21:22,  2.23s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1745/2320 [26:20<17:09,  1.79s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1746/2320 [26:21<14:04,  1.47s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1747/2320 [26:21<11:56,  1.25s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1748/2320 [26:22<10:38,  1.12s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1749/2320 [26:23<09:31,  1.00s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [26:24<08:49,  1.08it/s]                                                    75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [26:24<08:49,  1.08it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1751/2320 [26:25<08:22,  1.13it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1752/2320 [26:25<08:10,  1.16it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1753/2320 [26:26<07:59,  1.18it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1754/2320 [26:27<07:51,  1.20it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1755/2320 [26:28<07:47,  1.21it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1756/2320 [26:29<07:41,  1.22it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1757/2320 [26:29<07:31,  1.25it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1758/2320 [26:30<07:27,  1.25it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1759/2320 [26:31<07:30,  1.25it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1760/2320 [26:32<07:37,  1.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1761/2320 [26:33<07:34,  1.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1762/2320 [26:33<07:25,  1.25it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1763/2320 [26:34<07:22,  1.26it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1764/2320 [26:35<07:29,  1.24it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1765/2320 [26:36<07:35,  1.22it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1766/2320 [26:37<07:38,  1.21it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1767/2320 [26:37<07:32,  1.22it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1768/2320 [26:38<07:23,  1.24it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1769/2320 [26:39<07:29,  1.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1770/2320 [26:40<07:27,  1.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1771/2320 [26:41<07:27,  1.23it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1772/2320 [26:42<07:29,  1.22it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1773/2320 [26:42<07:30,  1.21it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1774/2320 [26:43<07:25,  1.23it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1775/2320 [26:44<07:29,  1.21it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1776/2320 [26:45<07:42,  1.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1777/2320 [26:46<07:31,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1778/2320 [26:47<07:28,  1.21it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1779/2320 [26:47<07:31,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1780/2320 [26:48<07:22,  1.22it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1781/2320 [26:49<07:17,  1.23it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1782/2320 [26:50<07:12,  1.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1783/2320 [26:51<07:14,  1.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1784/2320 [26:51<07:10,  1.24it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1785/2320 [26:52<07:19,  1.22it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1786/2320 [26:53<07:21,  1.21it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1787/2320 [26:54<07:26,  1.19it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1788/2320 [26:55<07:24,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1789/2320 [26:56<07:24,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1790/2320 [26:56<07:24,  1.19it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1791/2320 [26:57<07:29,  1.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1792/2320 [26:58<07:25,  1.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1793/2320 [26:59<07:19,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1794/2320 [27:00<07:16,  1.20it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1795/2320 [27:01<07:23,  1.18it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1796/2320 [27:02<07:28,  1.17it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1797/2320 [27:02<07:28,  1.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1798/2320 [27:03<07:26,  1.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1799/2320 [27:04<07:25,  1.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [27:05<07:21,  1.18it/s]                                                    78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [27:05<07:21,  1.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1801/2320 [27:06<07:17,  1.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1802/2320 [27:07<07:15,  1.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1803/2320 [27:07<07:12,  1.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1804/2320 [27:08<07:13,  1.19it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1805/2320 [27:09<07:19,  1.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1806/2320 [27:10<07:23,  1.16it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1807/2320 [27:11<07:23,  1.16it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1808/2320 [27:12<07:15,  1.17it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1809/2320 [27:13<07:21,  1.16it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1810/2320 [27:13<07:18,  1.16it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1811/2320 [27:14<07:13,  1.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1812/2320 [27:15<07:11,  1.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1813/2320 [27:16<07:09,  1.18it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1814/2320 [27:17<06:55,  1.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1815/2320 [27:18<06:53,  1.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1816/2320 [27:18<06:52,  1.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1817/2320 [27:19<06:49,  1.23it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1818/2320 [27:20<06:48,  1.23it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1819/2320 [27:21<06:49,  1.22it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1820/2320 [27:22<06:54,  1.21it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1821/2320 [27:23<06:55,  1.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1822/2320 [27:23<06:48,  1.22it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1823/2320 [27:24<06:51,  1.21it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1824/2320 [27:25<06:59,  1.18it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1825/2320 [27:26<07:04,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1826/2320 [27:27<06:48,  1.21it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1827/2320 [27:28<06:53,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1828/2320 [27:28<06:59,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1829/2320 [27:29<06:58,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1830/2320 [27:30<06:58,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1831/2320 [27:31<06:53,  1.18it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1832/2320 [27:32<06:50,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1833/2320 [27:33<06:55,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1834/2320 [27:34<06:51,  1.18it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1835/2320 [27:34<06:53,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1836/2320 [27:35<06:53,  1.17it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1837/2320 [27:36<06:46,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1838/2320 [27:37<06:42,  1.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1839/2320 [27:38<06:45,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1840/2320 [27:39<06:46,  1.18it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1841/2320 [27:39<06:41,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1842/2320 [27:40<06:40,  1.19it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1843/2320 [27:41<06:36,  1.20it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1844/2320 [27:42<06:35,  1.20it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1845/2320 [27:43<06:31,  1.21it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1846/2320 [27:44<06:36,  1.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1847/2320 [27:44<06:46,  1.16it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1848/2320 [27:45<06:43,  1.17it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1849/2320 [27:46<06:35,  1.19it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [27:47<06:28,  1.21it/s]                                                    80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [27:47<06:28,  1.21it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1851/2320 [27:48<06:25,  1.22it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1852/2320 [27:49<06:20,  1.23it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1853/2320 [27:49<06:24,  1.22it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1854/2320 [27:50<06:23,  1.22it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1855/2320 [27:51<06:25,  1.21it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [27:52<05:44,  1.35it/s]{'eval_loss': 1.6374956369400024, 'eval_precision': 0.9016293279022404, 'eval_recall': 0.6353329506314581, 'eval_f1': 0.7454116854689342, 'eval_report': {'PAGE_HEADER': {'precision': 0.27230046948356806, 'recall': 0.16201117318435754, 'f1-score': 0.2031523642732049, 'support': 358.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.2706766917293233, 'recall': 0.15, 'f1-score': 0.19302949061662197, 'support': 240.0}, 'INGREDIENT_LINE': {'precision': 0.6721890277023357, 'recall': 0.735950044603033, 'f1-score': 0.7026259758694109, 'support': 3363.0}, 'INSTRUCTION_STEP': {'precision': 0.6635714285714286, 'recall': 0.6191269576807731, 'f1-score': 0.6405792104809516, 'support': 3001.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8587799354971523, 'recall': 0.8665697271846005, 'f1-score': 0.8626572462519386, 'support': 14442.0}, 'accuracy': 0.7913124708080336, 'macro avg': {'precision': 0.34218969412297595, 'recall': 0.31670723783159554, 'f1-score': 0.325255535936516, 'support': 21410.0}, 'weighted avg': {'precision': 0.7854691900908846, 'recall': 0.7913124708080336, 'f1-score': 0.7876161112578449, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[58, 0, 2, 39, 6, 0, 0, 253], [0, 0, 0, 0, 0, 0, 0, 5], [4, 0, 36, 30, 5, 0, 0, 165], [71, 1, 53, 2475, 119, 0, 8, 636], [1, 0, 0, 144, 1858, 0, 0, 998], [0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0], [79, 0, 42, 994, 812, 0, 0, 12515]], 'eval_PAGE_HEADER_precision': 0.0746606334841629, 'eval_PAGE_HEADER_recall': 0.1506849315068493, 'eval_PAGE_HEADER_f1': 0.09984871406959152, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.02287581699346405, 'eval_RECIPE_TITLE_recall': 0.04929577464788732, 'eval_RECIPE_TITLE_f1': 0.03125, 'eval_header_false_positive_rate': 0.023255813953488372, 'eval_title_false_negative_rate': 0.06875, 'eval_header_title_confusion_count': 17, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14710, 'INGREDIENT_LINE': 4219, 'INSTRUCTION_STEP': 2510, 'PAGE_HEADER': 442, 'RECIPE_TITLE': 306, 'SECTION_HEADER': 8, 'TEMP': 1}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.0435, 'eval_samples_per_second': 10.173, 'eval_steps_per_second': 2.543, 'epoch': 15.0}
{'loss': 0.0858, 'grad_norm': 1.0437908172607422, 'learning_rate': 1.3649425287356324e-05, 'epoch': 15.09}
{'loss': 0.0759, 'grad_norm': 0.9852067232131958, 'learning_rate': 1.2452107279693487e-05, 'epoch': 15.52}
{'loss': 0.0814, 'grad_norm': 5.5610246658325195, 'learning_rate': 1.1254789272030653e-05, 'epoch': 15.95}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.80it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.82it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.22it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.04it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.86it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.73it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.61it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.56it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.53it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.59it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.61it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.57it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.60it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.60it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.64it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.68it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.71it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.74it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.61it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.66it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.66it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.05it/s][A                                                   
                                               [A 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [28:01<05:44,  1.35it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.05it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1857/2320 [28:08<41:48,  5.42s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1858/2320 [28:09<30:56,  4.02s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1859/2320 [28:09<23:19,  3.04s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1860/2320 [28:10<18:04,  2.36s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1861/2320 [28:11<14:14,  1.86s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1862/2320 [28:12<11:39,  1.53s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1863/2320 [28:12<09:50,  1.29s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1864/2320 [28:13<08:37,  1.14s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1865/2320 [28:14<07:42,  1.02s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1866/2320 [28:15<07:03,  1.07it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1867/2320 [28:15<06:36,  1.14it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1868/2320 [28:16<06:16,  1.20it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1869/2320 [28:17<06:06,  1.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1870/2320 [28:18<06:02,  1.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1871/2320 [28:18<06:03,  1.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1872/2320 [28:19<06:04,  1.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1873/2320 [28:20<06:00,  1.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1874/2320 [28:21<05:55,  1.25it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1875/2320 [28:22<06:04,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1876/2320 [28:23<06:05,  1.21it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1877/2320 [28:23<06:04,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1878/2320 [28:24<06:03,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1879/2320 [28:25<05:54,  1.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1880/2320 [28:26<05:52,  1.25it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1881/2320 [28:27<05:51,  1.25it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1882/2320 [28:27<05:57,  1.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1883/2320 [28:28<06:00,  1.21it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1884/2320 [28:29<06:02,  1.20it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1885/2320 [28:30<05:55,  1.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1886/2320 [28:31<05:57,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1887/2320 [28:32<05:56,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1888/2320 [28:32<05:52,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1889/2320 [28:33<05:52,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1890/2320 [28:34<05:59,  1.20it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1891/2320 [28:35<06:03,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1892/2320 [28:36<06:00,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1893/2320 [28:37<05:57,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1894/2320 [28:37<05:46,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1895/2320 [28:38<05:52,  1.20it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1896/2320 [28:39<05:56,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1897/2320 [28:40<05:57,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1898/2320 [28:41<05:58,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1899/2320 [28:42<05:56,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [28:42<05:55,  1.18it/s]                                                    82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [28:43<05:55,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1901/2320 [28:43<05:54,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1902/2320 [28:44<05:50,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1903/2320 [28:45<05:55,  1.17it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1904/2320 [28:46<05:53,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1905/2320 [28:47<05:47,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1906/2320 [28:48<05:42,  1.21it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1907/2320 [28:48<05:42,  1.21it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1908/2320 [28:49<05:48,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1909/2320 [28:50<05:47,  1.18it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1910/2320 [28:51<05:43,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1911/2320 [28:52<05:43,  1.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1912/2320 [28:53<05:35,  1.22it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1913/2320 [28:53<05:33,  1.22it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1914/2320 [28:54<05:36,  1.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1915/2320 [28:55<05:39,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1916/2320 [28:56<05:37,  1.20it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1917/2320 [28:57<05:37,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1918/2320 [28:58<05:39,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1919/2320 [28:58<05:44,  1.16it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1920/2320 [28:59<05:36,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1921/2320 [29:00<05:39,  1.18it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1922/2320 [29:01<05:35,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1923/2320 [29:02<05:33,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1924/2320 [29:03<05:26,  1.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1925/2320 [29:03<05:27,  1.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1926/2320 [29:04<05:22,  1.22it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1927/2320 [29:05<05:23,  1.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1928/2320 [29:06<05:27,  1.20it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1929/2320 [29:07<05:25,  1.20it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1930/2320 [29:07<05:16,  1.23it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1931/2320 [29:08<05:13,  1.24it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1932/2320 [29:09<05:15,  1.23it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1933/2320 [29:10<05:24,  1.19it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1934/2320 [29:11<05:36,  1.15it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1935/2320 [29:12<05:38,  1.14it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1936/2320 [29:13<05:33,  1.15it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1937/2320 [29:14<05:27,  1.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1938/2320 [29:14<05:18,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1939/2320 [29:15<05:13,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1940/2320 [29:16<05:07,  1.24it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1941/2320 [29:17<05:16,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1942/2320 [29:18<05:22,  1.17it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1943/2320 [29:18<05:16,  1.19it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1944/2320 [29:19<05:14,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1945/2320 [29:20<05:10,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1946/2320 [29:21<05:09,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1947/2320 [29:22<05:07,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1948/2320 [29:23<05:08,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1949/2320 [29:23<05:06,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [29:24<05:07,  1.20it/s]                                                    84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [29:24<05:07,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1951/2320 [29:25<05:07,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1952/2320 [29:26<05:04,  1.21it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1953/2320 [29:27<05:09,  1.19it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1954/2320 [29:28<05:10,  1.18it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1955/2320 [29:28<05:03,  1.20it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1956/2320 [29:29<05:09,  1.18it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1957/2320 [29:30<05:13,  1.16it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1958/2320 [29:31<05:12,  1.16it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1959/2320 [29:32<05:11,  1.16it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1960/2320 [29:33<05:10,  1.16it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1961/2320 [29:34<04:58,  1.20it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1962/2320 [29:34<04:57,  1.20it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1963/2320 [29:35<04:59,  1.19it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1964/2320 [29:36<04:52,  1.22it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1965/2320 [29:37<04:48,  1.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1966/2320 [29:38<04:49,  1.22it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1967/2320 [29:39<04:49,  1.22it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1968/2320 [29:39<04:46,  1.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1969/2320 [29:40<04:47,  1.22it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1970/2320 [29:41<04:44,  1.23it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1971/2320 [29:42<04:38,  1.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [29:42<04:10,  1.39it/s]{'eval_loss': 1.7634145021438599, 'eval_precision': 0.8977911646586345, 'eval_recall': 0.6285674117812456, 'eval_f1': 0.7394360373769949, 'eval_report': {'PAGE_HEADER': {'precision': 0.22065727699530516, 'recall': 0.13505747126436782, 'f1-score': 0.16755793226381463, 'support': 348.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.23308270676691728, 'recall': 0.125, 'f1-score': 0.16272965879265092, 'support': 248.0}, 'INGREDIENT_LINE': {'precision': 0.7126561651276481, 'recall': 0.6978723404255319, 'f1-score': 0.7051867777479173, 'support': 3760.0}, 'INSTRUCTION_STEP': {'precision': 0.6317857142857143, 'recall': 0.6432727272727272, 'f1-score': 0.6374774774774775, 'support': 2750.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8536334316887394, 'recall': 0.8701126110372805, 'f1-score': 0.861794250086595, 'support': 14297.0}, 'accuracy': 0.7898645492760392, 'macro avg': {'precision': 0.3314769118580405, 'recall': 0.3089143937499884, 'f1-score': 0.31684326204605695, 'support': 21410.0}, 'weighted avg': {'precision': 0.7826243956885633, 'recall': 0.7898645492760392, 'f1-score': 0.785815266543282, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[47, 0, 2, 32, 3, 0, 0, 264], [0, 0, 0, 0, 0, 0, 0, 6], [4, 0, 31, 34, 5, 0, 0, 174], [85, 1, 60, 2624, 164, 0, 8, 818], [0, 0, 0, 111, 1769, 0, 0, 870], [0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0], [77, 0, 40, 881, 859, 0, 0, 12440]], 'eval_PAGE_HEADER_precision': 0.06828193832599119, 'eval_PAGE_HEADER_recall': 0.1415525114155251, 'eval_PAGE_HEADER_f1': 0.09212481426448738, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.02147239263803681, 'eval_RECIPE_TITLE_recall': 0.04929577464788732, 'eval_RECIPE_TITLE_f1': 0.029914529914529912, 'eval_header_false_positive_rate': 0.0196078431372549, 'eval_title_false_negative_rate': 0.056962025316455694, 'eval_header_title_confusion_count': 14, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14596, 'INGREDIENT_LINE': 4536, 'INSTRUCTION_STEP': 2271, 'PAGE_HEADER': 454, 'RECIPE_TITLE': 326, 'SECTION_HEADER': 12, 'TEMP': 1}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.5912, 'eval_samples_per_second': 9.592, 'eval_steps_per_second': 2.398, 'epoch': 16.0}
{'loss': 0.0791, 'grad_norm': 0.7299119830131531, 'learning_rate': 1.0057471264367816e-05, 'epoch': 16.38}
{'loss': 0.0583, 'grad_norm': 1.4930392503738403, 'learning_rate': 8.860153256704981e-06, 'epoch': 16.81}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  4.25it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:06,  3.25it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:07,  2.65it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.60it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:02<00:06,  2.62it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:06,  2.52it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:03<00:06,  2.43it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.50it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.55it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:04<00:04,  2.52it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.54it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.54it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.51it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.59it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:06<00:02,  2.58it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.60it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.64it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:07<00:01,  2.69it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.58it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:08<00:00,  2.57it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.56it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.93it/s][A                                                   
                                               [A 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [29:52<04:10,  1.39it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:09<00:00,  2.93it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1973/2320 [29:59<31:47,  5.50s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1974/2320 [30:00<23:27,  4.07s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1975/2320 [30:00<17:46,  3.09s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1976/2320 [30:01<13:42,  2.39s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1977/2320 [30:02<10:53,  1.91s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1978/2320 [30:03<09:34,  1.68s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1979/2320 [30:04<07:59,  1.41s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1980/2320 [30:05<06:57,  1.23s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1981/2320 [30:05<06:07,  1.08s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1982/2320 [30:06<05:32,  1.02it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1983/2320 [30:07<05:06,  1.10it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1984/2320 [30:08<04:47,  1.17it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1985/2320 [30:08<04:39,  1.20it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1986/2320 [30:09<04:34,  1.22it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1987/2320 [30:10<04:29,  1.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1988/2320 [30:11<04:27,  1.24it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1989/2320 [30:12<04:29,  1.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1990/2320 [30:12<04:24,  1.25it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1991/2320 [30:13<04:26,  1.24it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1992/2320 [30:14<04:25,  1.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1993/2320 [30:15<04:27,  1.22it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1994/2320 [30:16<04:28,  1.22it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1995/2320 [30:17<04:29,  1.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1996/2320 [30:17<04:28,  1.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1997/2320 [30:18<04:24,  1.22it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1998/2320 [30:19<04:21,  1.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1999/2320 [30:20<04:25,  1.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [30:21<04:28,  1.19it/s]                                                    86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [30:21<04:28,  1.19it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2001/2320 [30:22<04:21,  1.22it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2002/2320 [30:22<04:29,  1.18it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2003/2320 [30:23<04:21,  1.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2004/2320 [30:24<04:20,  1.21it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2005/2320 [30:25<04:16,  1.23it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2006/2320 [30:26<04:18,  1.21it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2007/2320 [30:26<04:12,  1.24it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2008/2320 [30:27<04:14,  1.22it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2009/2320 [30:28<04:15,  1.22it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2010/2320 [30:29<04:11,  1.23it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2011/2320 [30:30<04:11,  1.23it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2012/2320 [30:30<04:06,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2013/2320 [30:31<04:08,  1.24it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2014/2320 [30:32<04:10,  1.22it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2015/2320 [30:33<04:11,  1.21it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2016/2320 [30:34<04:07,  1.23it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2017/2320 [30:35<04:04,  1.24it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2018/2320 [30:35<03:58,  1.27it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2019/2320 [30:36<03:55,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2020/2320 [30:37<04:07,  1.21it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2021/2320 [30:38<04:11,  1.19it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2022/2320 [30:39<04:16,  1.16it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2023/2320 [30:40<04:16,  1.16it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2024/2320 [30:40<04:12,  1.17it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2025/2320 [30:41<04:12,  1.17it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2026/2320 [30:42<04:15,  1.15it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2027/2320 [30:43<04:25,  1.10it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2028/2320 [30:44<04:15,  1.14it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2029/2320 [30:45<04:16,  1.14it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2030/2320 [30:46<04:12,  1.15it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2031/2320 [30:47<04:06,  1.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2032/2320 [30:47<04:08,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2033/2320 [30:48<04:11,  1.14it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2034/2320 [30:49<04:02,  1.18it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2035/2320 [30:50<04:00,  1.18it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2036/2320 [30:51<03:56,  1.20it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2037/2320 [30:52<03:53,  1.21it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2038/2320 [30:52<03:54,  1.20it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2039/2320 [30:53<03:53,  1.20it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2040/2320 [30:54<03:51,  1.21it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2041/2320 [30:55<03:56,  1.18it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2042/2320 [30:56<03:57,  1.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2043/2320 [30:57<04:01,  1.15it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2044/2320 [30:58<04:01,  1.14it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2045/2320 [30:59<03:57,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2046/2320 [30:59<03:53,  1.17it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2047/2320 [31:00<03:55,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2048/2320 [31:01<03:55,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2049/2320 [31:02<03:52,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [31:03<03:55,  1.15it/s]                                                    88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [31:03<03:55,  1.15it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2051/2320 [31:04<03:54,  1.15it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2052/2320 [31:05<03:50,  1.16it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2053/2320 [31:05<03:48,  1.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2054/2320 [31:06<03:42,  1.19it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2055/2320 [31:07<03:41,  1.20it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2056/2320 [31:08<03:38,  1.21it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2057/2320 [31:09<03:36,  1.21it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2058/2320 [31:09<03:38,  1.20it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2059/2320 [31:10<03:38,  1.20it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2060/2320 [31:11<03:44,  1.16it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2061/2320 [31:12<03:47,  1.14it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2062/2320 [31:13<03:45,  1.15it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2063/2320 [31:14<03:37,  1.18it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2064/2320 [31:15<03:39,  1.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2065/2320 [31:16<03:39,  1.16it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2066/2320 [31:16<03:39,  1.16it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2067/2320 [31:17<03:36,  1.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2068/2320 [31:18<03:32,  1.18it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2069/2320 [31:19<03:30,  1.19it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2070/2320 [31:20<03:29,  1.19it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2071/2320 [31:21<03:32,  1.17it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2072/2320 [31:21<03:24,  1.21it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2073/2320 [31:22<03:23,  1.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2074/2320 [31:23<03:25,  1.20it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2075/2320 [31:24<03:25,  1.19it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2076/2320 [31:25<03:25,  1.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2077/2320 [31:26<03:26,  1.18it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2078/2320 [31:26<03:21,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2079/2320 [31:27<03:20,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2080/2320 [31:28<03:20,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2081/2320 [31:29<03:19,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2082/2320 [31:30<03:19,  1.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2083/2320 [31:31<03:18,  1.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2084/2320 [31:31<03:16,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2085/2320 [31:32<03:15,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2086/2320 [31:33<03:16,  1.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2087/2320 [31:34<03:14,  1.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [31:34<02:51,  1.35it/s]{'eval_loss': 1.8992177248001099, 'eval_precision': 0.8947151114781172, 'eval_recall': 0.6392330383480826, 'eval_f1': 0.7456985547143841, 'eval_report': {'PAGE_HEADER': {'precision': 0.20187793427230047, 'recall': 0.14576271186440679, 'f1-score': 0.16929133858267717, 'support': 295.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.18796992481203006, 'recall': 0.13440860215053763, 'f1-score': 0.15673981191222572, 'support': 186.0}, 'INGREDIENT_LINE': {'precision': 0.6865833785985878, 'recall': 0.7022222222222222, 'f1-score': 0.6943147486954133, 'support': 3600.0}, 'INSTRUCTION_STEP': {'precision': 0.6207142857142857, 'recall': 0.6453769030820646, 'f1-score': 0.6328053886764974, 'support': 2693.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 1.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8671515816921704, 'recall': 0.863773069036227, 'f1-score': 0.8654590281820361, 'support': 14630.0}, 'accuracy': 0.7926669780476413, 'macro avg': {'precision': 0.3205371381361718, 'recall': 0.3114429385444323, 'f1-score': 0.31482628950610625, 'support': 21410.0}, 'weighted avg': {'precision': 0.7904823807176696, 'recall': 0.7926669780476413, 'f1-score': 0.7914263493325571, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[43, 0, 2, 25, 2, 0, 0, 223], [0, 0, 0, 0, 0, 0, 0, 5], [4, 0, 25, 27, 5, 0, 0, 125], [89, 1, 67, 2528, 135, 0, 8, 772], [1, 0, 0, 144, 1738, 0, 0, 810], [0, 0, 0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 0, 0, 0, 0], [76, 0, 39, 958, 920, 0, 0, 12637]], 'eval_PAGE_HEADER_precision': 0.07848101265822785, 'eval_PAGE_HEADER_recall': 0.1415525114155251, 'eval_PAGE_HEADER_f1': 0.10097719869706841, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0163265306122449, 'eval_RECIPE_TITLE_recall': 0.028169014084507043, 'eval_RECIPE_TITLE_f1': 0.020671834625323, 'eval_header_false_positive_rate': 0.015748031496062992, 'eval_title_false_negative_rate': 0.0457516339869281, 'eval_header_title_confusion_count': 11, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14930, 'INGREDIENT_LINE': 4334, 'INSTRUCTION_STEP': 2281, 'PAGE_HEADER': 395, 'RECIPE_TITLE': 245, 'SECTION_HEADER': 10, 'TEMP': 1}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.7144, 'eval_samples_per_second': 9.471, 'eval_steps_per_second': 2.368, 'epoch': 17.0}
{'loss': 0.0567, 'grad_norm': 3.5646119117736816, 'learning_rate': 7.662835249042145e-06, 'epoch': 17.24}
{'loss': 0.0541, 'grad_norm': 1.3522226810455322, 'learning_rate': 6.465517241379311e-06, 'epoch': 17.67}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  5.10it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.57it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.07it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.85it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:06,  2.73it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.72it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.59it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.61it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.67it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.61it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.55it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.56it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.47it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.59it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.61it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.55it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.59it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:07<00:01,  2.49it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.46it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.50it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.54it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.87it/s][A                                                   
                                               [A 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [31:44<02:51,  1.35it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:09<00:00,  2.87it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2089/2320 [31:50<20:26,  5.31s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2090/2320 [31:51<15:07,  3.95s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2091/2320 [31:52<11:24,  2.99s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2092/2320 [31:53<08:48,  2.32s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2093/2320 [31:54<07:01,  1.86s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2094/2320 [31:54<05:47,  1.54s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2095/2320 [31:55<04:56,  1.32s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2096/2320 [31:56<04:21,  1.17s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2097/2320 [31:57<03:58,  1.07s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2098/2320 [31:58<03:53,  1.05s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2099/2320 [31:59<03:34,  1.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [31:59<03:21,  1.09it/s]                                                    91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [31:59<03:21,  1.09it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2101/2320 [32:00<03:11,  1.14it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2102/2320 [32:01<03:06,  1.17it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2103/2320 [32:02<03:02,  1.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2104/2320 [32:03<02:58,  1.21it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2105/2320 [32:03<02:59,  1.20it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2106/2320 [32:04<02:55,  1.22it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2107/2320 [32:05<02:51,  1.24it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2108/2320 [32:06<02:54,  1.22it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2109/2320 [32:07<02:51,  1.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2110/2320 [32:08<02:57,  1.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2111/2320 [32:08<02:58,  1.17it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2112/2320 [32:09<02:55,  1.19it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2113/2320 [32:10<02:49,  1.22it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2114/2320 [32:11<02:45,  1.25it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2115/2320 [32:12<02:44,  1.24it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2116/2320 [32:13<03:09,  1.08it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2117/2320 [32:14<03:05,  1.09it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2118/2320 [32:14<02:59,  1.12it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2119/2320 [32:15<02:53,  1.16it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2120/2320 [32:16<02:46,  1.20it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2121/2320 [32:17<02:42,  1.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2122/2320 [32:18<02:45,  1.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2123/2320 [32:19<02:43,  1.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2124/2320 [32:19<02:42,  1.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2125/2320 [32:20<02:40,  1.21it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2126/2320 [32:21<02:36,  1.24it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2127/2320 [32:22<02:36,  1.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2128/2320 [32:23<02:34,  1.24it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2129/2320 [32:23<02:35,  1.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2130/2320 [32:24<02:32,  1.24it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2131/2320 [32:25<02:31,  1.25it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2132/2320 [32:26<02:30,  1.25it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2133/2320 [32:27<02:32,  1.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2134/2320 [32:27<02:32,  1.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2135/2320 [32:28<02:31,  1.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2136/2320 [32:29<02:32,  1.21it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2137/2320 [32:30<02:30,  1.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2138/2320 [32:31<02:32,  1.19it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2139/2320 [32:32<02:30,  1.20it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2140/2320 [32:32<02:27,  1.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2141/2320 [32:33<02:25,  1.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2142/2320 [32:34<02:25,  1.23it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2143/2320 [32:35<02:23,  1.24it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2144/2320 [32:36<02:25,  1.21it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2145/2320 [32:36<02:23,  1.22it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2146/2320 [32:37<02:23,  1.21it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2147/2320 [32:38<02:19,  1.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2148/2320 [32:39<02:19,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2149/2320 [32:40<02:19,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [32:41<02:18,  1.22it/s]                                                    93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [32:41<02:18,  1.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2151/2320 [32:41<02:17,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2152/2320 [32:42<02:19,  1.20it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2153/2320 [32:43<02:20,  1.19it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2154/2320 [32:44<02:18,  1.20it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2155/2320 [32:45<02:15,  1.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2156/2320 [32:46<02:14,  1.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2157/2320 [32:46<02:13,  1.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2158/2320 [32:47<02:10,  1.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2159/2320 [32:48<02:09,  1.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2160/2320 [32:49<02:09,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2161/2320 [32:50<02:07,  1.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2162/2320 [32:50<02:08,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2163/2320 [32:51<02:07,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2164/2320 [32:52<02:07,  1.22it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2165/2320 [32:53<02:03,  1.25it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2166/2320 [32:54<02:04,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2167/2320 [32:54<02:04,  1.23it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2168/2320 [32:55<02:02,  1.24it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2169/2320 [32:56<02:03,  1.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2170/2320 [32:57<02:04,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2171/2320 [32:58<02:05,  1.19it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2172/2320 [32:59<02:03,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2173/2320 [32:59<02:01,  1.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2174/2320 [33:00<02:01,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2175/2320 [33:01<02:00,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2176/2320 [33:02<01:58,  1.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2177/2320 [33:03<01:58,  1.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2178/2320 [33:04<01:58,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2179/2320 [33:04<01:56,  1.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2180/2320 [33:05<01:55,  1.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2181/2320 [33:06<01:53,  1.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2182/2320 [33:07<01:53,  1.22it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2183/2320 [33:08<01:53,  1.21it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2184/2320 [33:09<01:55,  1.17it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2185/2320 [33:09<01:54,  1.18it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2186/2320 [33:10<01:54,  1.17it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2187/2320 [33:11<01:53,  1.17it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2188/2320 [33:12<01:51,  1.19it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2189/2320 [33:13<01:50,  1.19it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2190/2320 [33:14<01:48,  1.20it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2191/2320 [33:14<01:47,  1.19it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2192/2320 [33:15<01:49,  1.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2193/2320 [33:16<01:46,  1.19it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2194/2320 [33:17<01:46,  1.18it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2195/2320 [33:18<01:47,  1.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2196/2320 [33:19<01:45,  1.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2197/2320 [33:20<01:44,  1.18it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2198/2320 [33:20<01:43,  1.18it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2199/2320 [33:21<01:43,  1.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [33:22<01:42,  1.17it/s]                                                    95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [33:22<01:42,  1.17it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2201/2320 [33:23<01:40,  1.18it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2202/2320 [33:24<01:40,  1.18it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2203/2320 [33:25<01:37,  1.19it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [33:25<01:26,  1.35it/s]{'eval_loss': 1.8359845876693726, 'eval_precision': 0.896311475409836, 'eval_recall': 0.6458948611931482, 'eval_f1': 0.7507723995880535, 'eval_report': {'PAGE_HEADER': {'precision': 0.19248826291079812, 'recall': 0.16015625, 'f1-score': 0.17484008528784648, 'support': 256.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.22556390977443608, 'recall': 0.1875, 'f1-score': 0.20477815699658702, 'support': 160.0}, 'INGREDIENT_LINE': {'precision': 0.6800651819663226, 'recall': 0.7243274515475846, 'f1-score': 0.7014988093570528, 'support': 3457.0}, 'INSTRUCTION_STEP': {'precision': 0.6425, 'recall': 0.6214162348877375, 'f1-score': 0.6317822651448639, 'support': 2895.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8701708639264393, 'recall': 0.8663068725235687, 'f1-score': 0.8682345691691487, 'support': 14638.0}, 'accuracy': 0.7965903783278842, 'macro avg': {'precision': 0.3729697455111423, 'recall': 0.3656724012798415, 'f1-score': 0.36873341227935696, 'support': 21410.0}, 'weighted avg': {'precision': 0.7956072471313342, 'recall': 0.7965903783278842, 'f1-score': 0.7959286423163406, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[41, 0, 2, 30, 0, 0, 183], [0, 0, 0, 0, 0, 0, 4], [4, 0, 30, 25, 3, 0, 98], [90, 1, 59, 2504, 145, 8, 650], [0, 0, 0, 139, 1799, 0, 957], [0, 0, 0, 0, 0, 0, 0], [78, 0, 42, 984, 853, 0, 12681]], 'eval_PAGE_HEADER_precision': 0.08241758241758242, 'eval_PAGE_HEADER_recall': 0.136986301369863, 'eval_PAGE_HEADER_f1': 0.10291595197255575, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0196078431372549, 'eval_RECIPE_TITLE_recall': 0.028169014084507043, 'eval_RECIPE_TITLE_f1': 0.023121387283236993, 'eval_header_false_positive_rate': 0.011904761904761904, 'eval_title_false_negative_rate': 0.039473684210526314, 'eval_header_title_confusion_count': 9, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14844, 'INGREDIENT_LINE': 4255, 'INSTRUCTION_STEP': 2520, 'PAGE_HEADER': 364, 'RECIPE_TITLE': 204, 'SECTION_HEADER': 9}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.5757, 'eval_samples_per_second': 9.608, 'eval_steps_per_second': 2.402, 'epoch': 18.0}
{'loss': 0.0479, 'grad_norm': 3.969034194946289, 'learning_rate': 5.268199233716475e-06, 'epoch': 18.1}
{'loss': 0.057, 'grad_norm': 2.980638265609741, 'learning_rate': 4.07088122605364e-06, 'epoch': 18.53}
{'loss': 0.0531, 'grad_norm': 1.0948386192321777, 'learning_rate': 2.8735632183908046e-06, 'epoch': 18.97}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.34it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.70it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.10it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.90it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:06,  2.78it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.80it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.73it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.65it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.66it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.67it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.61it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.60it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.58it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.60it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.68it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.62it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.52it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.60it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.63it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.64it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.73it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.13it/s][A                                                   
                                               [A 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [33:34<01:26,  1.35it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.13it/s][A
                                               [A/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2205/2320 [33:41<10:05,  5.27s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2206/2320 [33:42<07:26,  3.92s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2207/2320 [33:43<05:35,  2.97s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2208/2320 [33:43<04:19,  2.32s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2209/2320 [33:44<03:24,  1.84s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2210/2320 [33:45<02:46,  1.51s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2211/2320 [33:45<02:19,  1.28s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2212/2320 [33:46<02:01,  1.13s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2213/2320 [33:47<01:49,  1.02s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2214/2320 [33:48<01:42,  1.04it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2215/2320 [33:49<01:35,  1.10it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2216/2320 [33:50<01:32,  1.13it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2217/2320 [33:50<01:28,  1.17it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2218/2320 [33:51<01:24,  1.20it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2219/2320 [33:52<01:21,  1.23it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2220/2320 [33:53<01:19,  1.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2221/2320 [33:53<01:17,  1.27it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2222/2320 [33:54<01:15,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2223/2320 [33:55<01:15,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2224/2320 [33:56<01:15,  1.27it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2225/2320 [33:56<01:14,  1.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2226/2320 [33:57<01:16,  1.24it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2227/2320 [33:58<01:17,  1.20it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2228/2320 [33:59<01:17,  1.19it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2229/2320 [34:00<01:17,  1.17it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2230/2320 [34:01<01:15,  1.19it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2231/2320 [34:02<01:15,  1.19it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2232/2320 [34:02<01:14,  1.18it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2233/2320 [34:03<01:13,  1.19it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2234/2320 [34:04<01:11,  1.21it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2235/2320 [34:05<01:10,  1.20it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2236/2320 [34:06<01:11,  1.18it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2237/2320 [34:07<01:10,  1.17it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2238/2320 [34:08<01:09,  1.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2239/2320 [34:08<01:09,  1.17it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2240/2320 [34:09<01:08,  1.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2241/2320 [34:10<01:07,  1.17it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2242/2320 [34:11<01:06,  1.17it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2243/2320 [34:12<01:05,  1.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2244/2320 [34:13<01:04,  1.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2245/2320 [34:13<01:03,  1.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2246/2320 [34:14<01:02,  1.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2247/2320 [34:15<01:01,  1.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2248/2320 [34:16<01:00,  1.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2249/2320 [34:17<01:01,  1.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [34:18<01:00,  1.15it/s]                                                    97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [34:18<01:00,  1.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2251/2320 [34:19<00:59,  1.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2252/2320 [34:20<00:59,  1.14it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2253/2320 [34:20<00:58,  1.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2254/2320 [34:21<00:58,  1.13it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2255/2320 [34:22<00:56,  1.14it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2256/2320 [34:23<00:55,  1.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2257/2320 [34:24<00:54,  1.16it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2258/2320 [34:25<00:53,  1.15it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2259/2320 [34:26<00:51,  1.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2260/2320 [34:26<00:50,  1.19it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2261/2320 [34:27<00:51,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2262/2320 [34:28<00:50,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2263/2320 [34:29<00:48,  1.17it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2264/2320 [34:30<00:48,  1.17it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2265/2320 [34:31<00:52,  1.05it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2266/2320 [34:32<00:50,  1.07it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2267/2320 [34:33<00:48,  1.08it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2268/2320 [34:34<00:47,  1.09it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2269/2320 [34:35<00:45,  1.12it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2270/2320 [34:35<00:44,  1.12it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2271/2320 [34:36<00:43,  1.13it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2272/2320 [34:37<00:41,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2273/2320 [34:38<00:40,  1.16it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2274/2320 [34:39<00:39,  1.18it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2275/2320 [34:40<00:38,  1.17it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2276/2320 [34:41<00:38,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2277/2320 [34:41<00:36,  1.17it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2278/2320 [34:42<00:35,  1.18it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2279/2320 [34:43<00:34,  1.18it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2280/2320 [34:44<00:34,  1.16it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2281/2320 [34:45<00:34,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2282/2320 [34:46<00:33,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2283/2320 [34:47<00:32,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2284/2320 [34:47<00:31,  1.15it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2285/2320 [34:48<00:30,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2286/2320 [34:49<00:29,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2287/2320 [34:50<00:28,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2288/2320 [34:51<00:28,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2289/2320 [34:52<00:27,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2290/2320 [34:53<00:26,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2291/2320 [34:54<00:25,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2292/2320 [34:55<00:24,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2293/2320 [34:55<00:23,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2294/2320 [34:56<00:22,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295/2320 [34:57<00:21,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2296/2320 [34:58<00:20,  1.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2297/2320 [34:59<00:19,  1.21it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2298/2320 [34:59<00:18,  1.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2299/2320 [35:00<00:17,  1.20it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [35:01<00:17,  1.17it/s]                                                    99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [35:01<00:17,  1.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2301/2320 [35:02<00:16,  1.17it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2302/2320 [35:03<00:15,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2303/2320 [35:04<00:14,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2304/2320 [35:05<00:13,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2305/2320 [35:05<00:12,  1.19it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2306/2320 [35:06<00:11,  1.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2307/2320 [35:07<00:11,  1.16it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2308/2320 [35:08<00:10,  1.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2309/2320 [35:09<00:09,  1.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310/2320 [35:10<00:08,  1.17it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2311/2320 [35:11<00:07,  1.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2312/2320 [35:12<00:06,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2313/2320 [35:12<00:06,  1.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2314/2320 [35:13<00:05,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2315/2320 [35:14<00:04,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2316/2320 [35:15<00:03,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2317/2320 [35:16<00:02,  1.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2318/2320 [35:17<00:01,  1.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2319/2320 [35:18<00:00,  1.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [35:18<00:00,  1.29it/s]/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.960300326347351, 'eval_precision': 0.9027253668763102, 'eval_recall': 0.6581079015742014, 'eval_f1': 0.7612481216299832, 'eval_report': {'PAGE_HEADER': {'precision': 0.2112676056338028, 'recall': 0.1595744680851064, 'f1-score': 0.18181818181818182, 'support': 282.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.21052631578947367, 'recall': 0.1407035175879397, 'f1-score': 0.1686746987951807, 'support': 199.0}, 'INGREDIENT_LINE': {'precision': 0.6803367734926671, 'recall': 0.7181766055045872, 'f1-score': 0.698744769874477, 'support': 3488.0}, 'INSTRUCTION_STEP': {'precision': 0.6171428571428571, 'recall': 0.6723735408560312, 'f1-score': 0.6435754189944134, 'support': 2570.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.878336649969121, 'recall': 0.8609672428869308, 'f1-score': 0.8695652173913043, 'support': 14867.0}, 'accuracy': 0.7989724427837459, 'macro avg': {'precision': 0.37108717171827454, 'recall': 0.3645421964172279, 'f1-score': 0.3660540409819367, 'support': 21410.0}, 'weighted avg': {'precision': 0.7995691259001086, 'recall': 0.7989724427837459, 'f1-score': 0.7988732210848813, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[45, 0, 3, 26, 0, 0, 208], [0, 0, 0, 0, 0, 0, 4], [4, 0, 28, 28, 4, 0, 135], [86, 1, 60, 2505, 147, 8, 681], [0, 0, 0, 97, 1728, 0, 745], [0, 0, 0, 0, 0, 0, 0], [78, 0, 42, 1026, 921, 0, 12800]], 'eval_PAGE_HEADER_precision': 0.08010335917312661, 'eval_PAGE_HEADER_recall': 0.1415525114155251, 'eval_PAGE_HEADER_f1': 0.1023102310231023, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.019305019305019305, 'eval_RECIPE_TITLE_recall': 0.035211267605633804, 'eval_RECIPE_TITLE_f1': 0.02493765586034913, 'eval_header_false_positive_rate': 0.011857707509881422, 'eval_title_false_negative_rate': 0.045454545454545456, 'eval_header_title_confusion_count': 10, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15078, 'INGREDIENT_LINE': 4294, 'INSTRUCTION_STEP': 2169, 'PAGE_HEADER': 387, 'RECIPE_TITLE': 259, 'SECTION_HEADER': 9}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.3046, 'eval_samples_per_second': 9.888, 'eval_steps_per_second': 2.472, 'epoch': 19.0}
{'loss': 0.0449, 'grad_norm': 0.5391833186149597, 'learning_rate': 1.6762452107279694e-06, 'epoch': 19.4}
{'loss': 0.0517, 'grad_norm': 8.039111137390137, 'learning_rate': 4.789272030651341e-07, 'epoch': 19.83}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.72it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.99it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.12it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:06,  2.94it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.84it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.72it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.67it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:03<00:05,  2.52it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:05,  2.48it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.52it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:04,  2.54it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:04,  2.34it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:05<00:03,  2.43it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:03,  2.53it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.60it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:06<00:02,  2.69it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.69it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.75it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:07<00:01,  2.71it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.71it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:08<00:00,  2.76it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.16it/s][A                                                   
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [35:33<00:00,  1.29it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.16it/s][A
                                               [A                                                   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [35:39<00:00,  1.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [35:39<00:00,  1.08it/s]
2026-01-12 17:32:49,397 [INFO] Saving final model to models/layoutlmv3_v3_production...
2026-01-12 17:32:51,924 [INFO] 
================================================================================
2026-01-12 17:32:51,925 [INFO] FINAL EVALUATION
2026-01-12 17:32:51,925 [INFO] ================================================================================
2026-01-12 17:32:51,925 [INFO] 
Evaluating on validation...
/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.9601114988327026, 'eval_precision': 0.902867908729328, 'eval_recall': 0.6606924019607843, 'eval_f1': 0.7630252100840336, 'eval_report': {'PAGE_HEADER': {'precision': 0.20657276995305165, 'recall': 0.18032786885245902, 'f1-score': 0.1925601750547046, 'support': 244.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.19548872180451127, 'recall': 0.15294117647058825, 'f1-score': 0.1716171617161716, 'support': 170.0}, 'INGREDIENT_LINE': {'precision': 0.678164041281912, 'recall': 0.7107884998576715, 'f1-score': 0.6940931202223767, 'support': 3513.0}, 'INSTRUCTION_STEP': {'precision': 0.6235714285714286, 'recall': 0.6723142087023488, 'f1-score': 0.6470261256253474, 'support': 2597.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8798462910862554, 'recall': 0.8615777449267572, 'f1-score': 0.8706161941945341, 'support': 14882.0}, 'accuracy': 0.8003269500233535, 'macro avg': {'precision': 0.36909189324245123, 'recall': 0.36827849982997496, 'f1-score': 0.3679875395447335, 'support': 21410.0}, 'weighted avg': {'precision': 0.8023967594369137, 'recall': 0.8003269500233535, 'f1-score': 0.8010904148434558, 'support': 21410.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[44, 0, 3, 22, 0, 0, 175], [0, 0, 0, 0, 0, 0, 4], [4, 0, 26, 24, 3, 0, 113], [87, 1, 63, 2497, 146, 8, 711], [0, 0, 0, 103, 1746, 0, 748], [0, 0, 0, 0, 0, 0, 0], [78, 0, 41, 1036, 905, 0, 12822]], 'eval_PAGE_HEADER_precision': 0.08908045977011494, 'eval_PAGE_HEADER_recall': 0.1415525114155251, 'eval_PAGE_HEADER_f1': 0.10934744268077602, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.013513513513513514, 'eval_RECIPE_TITLE_recall': 0.02112676056338028, 'eval_RECIPE_TITLE_f1': 0.016483516483516484, 'eval_header_false_positive_rate': 0.011857707509881422, 'eval_title_false_negative_rate': 0.039735099337748346, 'eval_header_title_confusion_count': 9, 'eval_total_tokens': 22196, 'eval_true_label_distribution': {'O': 14791, 'INGREDIENT_LINE': 4213, 'INSTRUCTION_STEP': 2822, 'PAGE_HEADER': 219, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15063, 'INGREDIENT_LINE': 4298, 'INSTRUCTION_STEP': 2256, 'PAGE_HEADER': 348, 'RECIPE_TITLE': 222, 'SECTION_HEADER': 9}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 9.4277, 'eval_samples_per_second': 9.758, 'eval_steps_per_second': 2.44, 'epoch': 20.0}
{'train_runtime': 2139.8676, 'train_samples_per_second': 4.327, 'train_steps_per_second': 1.084, 'train_loss': 0.4684626479344121, 'epoch': 20.0}
  0%|          | 0/23 [00:00<?, ?it/s]  9%|â–Š         | 2/23 [00:00<00:03,  5.60it/s] 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.98it/s] 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.46it/s] 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.25it/s] 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.04it/s] 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.96it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.88it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.79it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.72it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.70it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.78it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.75it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.75it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.83it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.85it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.87it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.89it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.76it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.80it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.84it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  2.79it/s]
2026-01-12 17:33:00,902 [INFO] 
Evaluating on test...
/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/16 [00:00<?, ?it/s] 12%|â–ˆâ–Ž        | 2/16 [00:00<00:02,  5.66it/s] 19%|â–ˆâ–‰        | 3/16 [00:00<00:03,  3.86it/s] 25%|â–ˆâ–ˆâ–Œ       | 4/16 [00:01<00:03,  3.27it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 5/16 [00:01<00:03,  2.94it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 6/16 [00:01<00:03,  2.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 7/16 [00:02<00:03,  2.72it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 8/16 [00:02<00:02,  2.73it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 9/16 [00:03<00:02,  2.71it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 10/16 [00:03<00:02,  2.57it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 11/16 [00:03<00:01,  2.57it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 12/16 [00:04<00:01,  2.57it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 13/16 [00:04<00:01,  2.49it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 14/16 [00:05<00:00,  2.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 15/16 [00:05<00:00,  2.84it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 16/16 [00:05<00:00,  2.78it/s]
2026-01-12 17:33:07,218 [INFO] 
Evaluating on demo_eval...
/home/jerome/projects/cookbookAI/backend/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/2 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 11.99it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  8.71it/s]
2026-01-12 17:33:07,937 [INFO] âœ“ Training complete!
2026-01-12 17:33:07,938 [INFO] âœ“ Model saved to: models/layoutlmv3_v3_production
2026-01-12 17:33:07,938 [INFO] âœ“ Report saved to: models/layoutlmv3_v3_production/training_report.json

================================================================================
DEMO SCORECARD - Header-Aware Evaluation
================================================================================

ðŸ“ Title Anchor Accuracy
  Anchor Accuracy (IoU >= 0.3): 0.0%
  Pages with correct anchor: 0 / 0

ðŸŽ¯ Recipe Title Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ“„ Page Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ”€ Section Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

âš ï¸  Critical Errors
  Headerâ†’Title confusion count: 0
  Header false positive rate:   0.0%
  Title false negative rate:    0.0%

ðŸ“Š Ingredient & Instruction F1
  Ingredients: 0.0%
  Instructions: 0.0%
================================================================================


================================================================================
TRAINING SUMMARY
================================================================================
Best checkpoint: models/layoutlmv3_v3_production
Demo eval title anchor accuracy: 0.0%
Demo eval headerâ†’title confusion: 0 tokens
================================================================================

