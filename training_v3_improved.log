2026-01-12 21:07:43,497 [INFO] Using v3 label taxonomy: 10 labels
2026-01-12 21:07:43,497 [INFO] Loading dataset from data/datasets/boston_layoutlmv3_v3_improved/dataset_dict...
2026-01-12 21:07:43,510 [INFO] Dataset loaded:
2026-01-12 21:07:43,510 [INFO]   train: 463 examples
2026-01-12 21:07:43,510 [INFO]   validation: 92 examples
2026-01-12 21:07:43,510 [INFO]   test: 61 examples
2026-01-12 21:07:43,510 [INFO]   demo_eval: 7 examples
2026-01-12 21:07:43,510 [INFO] Initializing LayoutLMv3 processor and model...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Some weights of LayoutLMv3ForTokenClassification were not initialized from the model checkpoint at microsoft/layoutlmv3-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2026-01-12 21:07:44,312 [INFO] Model initialized with 10 labels
2026-01-12 21:07:44,312 [INFO] Computing class weights from training data...
2026-01-12 21:07:44,879 [INFO] Class weights computed:
2026-01-12 21:07:44,879 [INFO]   PAGE_HEADER         : weight=5.15, count=2146
2026-01-12 21:07:44,880 [INFO]   SECTION_HEADER      : weight=481.16, count=22
2026-01-12 21:07:44,880 [INFO]   RECIPE_TITLE        : weight=6.21, count=1780
2026-01-12 21:07:44,880 [INFO]   INGREDIENT_LINE     : weight=0.62, count=17834
2026-01-12 21:07:44,880 [INFO]   INSTRUCTION_STEP    : weight=0.82, count=13462
2026-01-12 21:07:44,880 [INFO]   TIME                : weight=11066.70, count=0
2026-01-12 21:07:44,880 [INFO]   TEMP                : weight=481.16, count=22
2026-01-12 21:07:44,880 [INFO]   SERVINGS            : weight=356.99, count=30
2026-01-12 21:07:44,880 [INFO]   NOTE                : weight=11066.70, count=0
2026-01-12 21:07:44,880 [INFO]   O                   : weight=0.15, count=75371
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2026-01-12 21:07:45,519 [INFO] Starting training...
  0%|          | 0/2320 [00:00<?, ?it/s]/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 1/2320 [00:01<49:42,  1.29s/it]  0%|          | 2/2320 [00:01<33:42,  1.15it/s]  0%|          | 3/2320 [00:02<28:57,  1.33it/s]  0%|          | 4/2320 [00:03<27:26,  1.41it/s]  0%|          | 5/2320 [00:03<26:00,  1.48it/s]  0%|          | 6/2320 [00:04<24:46,  1.56it/s]  0%|          | 7/2320 [00:04<23:52,  1.61it/s]  0%|          | 8/2320 [00:05<23:26,  1.64it/s]  0%|          | 9/2320 [00:06<23:01,  1.67it/s]  0%|          | 10/2320 [00:06<22:49,  1.69it/s]  0%|          | 11/2320 [00:07<22:48,  1.69it/s]  1%|          | 12/2320 [00:07<22:18,  1.72it/s]  1%|          | 13/2320 [00:08<22:06,  1.74it/s]  1%|          | 14/2320 [00:08<22:06,  1.74it/s]  1%|          | 15/2320 [00:09<22:18,  1.72it/s]  1%|          | 16/2320 [00:10<22:08,  1.73it/s]  1%|          | 17/2320 [00:10<22:01,  1.74it/s]  1%|          | 18/2320 [00:11<22:03,  1.74it/s]  1%|          | 19/2320 [00:11<21:55,  1.75it/s]  1%|          | 20/2320 [00:12<22:02,  1.74it/s]  1%|          | 21/2320 [00:12<22:13,  1.72it/s]  1%|          | 22/2320 [00:13<22:00,  1.74it/s]  1%|          | 23/2320 [00:14<22:02,  1.74it/s]  1%|          | 24/2320 [00:14<21:51,  1.75it/s]  1%|          | 25/2320 [00:15<21:35,  1.77it/s]  1%|          | 26/2320 [00:15<21:34,  1.77it/s]  1%|          | 27/2320 [00:16<21:38,  1.77it/s]  1%|          | 28/2320 [00:16<21:40,  1.76it/s]  1%|â–         | 29/2320 [00:17<21:38,  1.76it/s]  1%|â–         | 30/2320 [00:18<21:46,  1.75it/s]  1%|â–         | 31/2320 [00:18<21:39,  1.76it/s]  1%|â–         | 32/2320 [00:19<21:30,  1.77it/s]  1%|â–         | 33/2320 [00:19<21:54,  1.74it/s]  1%|â–         | 34/2320 [00:20<21:41,  1.76it/s]  2%|â–         | 35/2320 [00:20<21:52,  1.74it/s]  2%|â–         | 36/2320 [00:21<21:38,  1.76it/s]  2%|â–         | 37/2320 [00:22<21:37,  1.76it/s]  2%|â–         | 38/2320 [00:22<21:39,  1.76it/s]  2%|â–         | 39/2320 [00:23<21:35,  1.76it/s]  2%|â–         | 40/2320 [00:23<21:49,  1.74it/s]  2%|â–         | 41/2320 [00:24<21:44,  1.75it/s]  2%|â–         | 42/2320 [00:24<22:02,  1.72it/s]  2%|â–         | 43/2320 [00:25<21:59,  1.73it/s]  2%|â–         | 44/2320 [00:26<21:56,  1.73it/s]  2%|â–         | 45/2320 [00:26<21:51,  1.73it/s]  2%|â–         | 46/2320 [00:27<21:48,  1.74it/s]  2%|â–         | 47/2320 [00:27<21:53,  1.73it/s]  2%|â–         | 48/2320 [00:28<21:59,  1.72it/s]  2%|â–         | 49/2320 [00:28<21:56,  1.72it/s]  2%|â–         | 50/2320 [00:29<21:48,  1.73it/s]                                                   2%|â–         | 50/2320 [00:29<21:48,  1.73it/s]  2%|â–         | 51/2320 [00:30<21:47,  1.74it/s]  2%|â–         | 52/2320 [00:30<21:42,  1.74it/s]  2%|â–         | 53/2320 [00:31<21:56,  1.72it/s]  2%|â–         | 54/2320 [00:31<21:47,  1.73it/s]  2%|â–         | 55/2320 [00:32<22:00,  1.71it/s]  2%|â–         | 56/2320 [00:33<22:02,  1.71it/s]  2%|â–         | 57/2320 [00:33<21:56,  1.72it/s]  2%|â–Ž         | 58/2320 [00:34<21:52,  1.72it/s]  3%|â–Ž         | 59/2320 [00:34<21:48,  1.73it/s]  3%|â–Ž         | 60/2320 [00:35<21:39,  1.74it/s]  3%|â–Ž         | 61/2320 [00:35<21:38,  1.74it/s]  3%|â–Ž         | 62/2320 [00:36<21:42,  1.73it/s]  3%|â–Ž         | 63/2320 [00:37<21:43,  1.73it/s]  3%|â–Ž         | 64/2320 [00:37<21:44,  1.73it/s]  3%|â–Ž         | 65/2320 [00:38<21:40,  1.73it/s]  3%|â–Ž         | 66/2320 [00:38<21:53,  1.72it/s]  3%|â–Ž         | 67/2320 [00:39<21:50,  1.72it/s]  3%|â–Ž         | 68/2320 [00:39<22:00,  1.70it/s]  3%|â–Ž         | 69/2320 [00:40<22:03,  1.70it/s]  3%|â–Ž         | 70/2320 [00:41<21:52,  1.71it/s]  3%|â–Ž         | 71/2320 [00:41<21:41,  1.73it/s]  3%|â–Ž         | 72/2320 [00:42<21:31,  1.74it/s]  3%|â–Ž         | 73/2320 [00:42<21:35,  1.73it/s]  3%|â–Ž         | 74/2320 [00:43<21:40,  1.73it/s]  3%|â–Ž         | 75/2320 [00:44<21:41,  1.73it/s]  3%|â–Ž         | 76/2320 [00:44<21:53,  1.71it/s]  3%|â–Ž         | 77/2320 [00:45<23:37,  1.58it/s]  3%|â–Ž         | 78/2320 [00:45<23:14,  1.61it/s]  3%|â–Ž         | 79/2320 [00:46<22:44,  1.64it/s]  3%|â–Ž         | 80/2320 [00:47<22:27,  1.66it/s]  3%|â–Ž         | 81/2320 [00:47<22:29,  1.66it/s]  4%|â–Ž         | 82/2320 [00:48<22:06,  1.69it/s]  4%|â–Ž         | 83/2320 [00:48<22:03,  1.69it/s]  4%|â–Ž         | 84/2320 [00:49<22:00,  1.69it/s]  4%|â–Ž         | 85/2320 [00:50<21:49,  1.71it/s]  4%|â–Ž         | 86/2320 [00:50<21:47,  1.71it/s]  4%|â–         | 87/2320 [00:51<21:52,  1.70it/s]  4%|â–         | 88/2320 [00:51<21:56,  1.69it/s]  4%|â–         | 89/2320 [00:52<21:51,  1.70it/s]  4%|â–         | 90/2320 [00:53<22:33,  1.65it/s]  4%|â–         | 91/2320 [00:53<22:20,  1.66it/s]  4%|â–         | 92/2320 [00:54<22:14,  1.67it/s]  4%|â–         | 93/2320 [00:54<22:26,  1.65it/s]  4%|â–         | 94/2320 [00:55<22:19,  1.66it/s]  4%|â–         | 95/2320 [00:56<22:03,  1.68it/s]  4%|â–         | 96/2320 [00:56<21:59,  1.69it/s]  4%|â–         | 97/2320 [00:57<21:56,  1.69it/s]  4%|â–         | 98/2320 [00:57<21:52,  1.69it/s]  4%|â–         | 99/2320 [00:58<21:51,  1.69it/s]  4%|â–         | 100/2320 [00:59<22:06,  1.67it/s]                                                    4%|â–         | 100/2320 [00:59<22:06,  1.67it/s]  4%|â–         | 101/2320 [00:59<22:19,  1.66it/s]  4%|â–         | 102/2320 [01:00<22:01,  1.68it/s]  4%|â–         | 103/2320 [01:00<22:10,  1.67it/s]  4%|â–         | 104/2320 [01:01<22:05,  1.67it/s]  5%|â–         | 105/2320 [01:02<22:00,  1.68it/s]  5%|â–         | 106/2320 [01:02<21:51,  1.69it/s]  5%|â–         | 107/2320 [01:03<21:52,  1.69it/s]  5%|â–         | 108/2320 [01:03<22:10,  1.66it/s]  5%|â–         | 109/2320 [01:04<22:12,  1.66it/s]  5%|â–         | 110/2320 [01:04<21:59,  1.67it/s]  5%|â–         | 111/2320 [01:05<21:48,  1.69it/s]  5%|â–         | 112/2320 [01:06<21:37,  1.70it/s]  5%|â–         | 113/2320 [01:06<21:32,  1.71it/s]  5%|â–         | 114/2320 [01:07<21:41,  1.69it/s]  5%|â–         | 115/2320 [01:07<21:27,  1.71it/s]  5%|â–Œ         | 116/2320 [01:08<19:22,  1.90it/s]{'loss': 2.0208, 'grad_norm': 3.4607903957366943, 'learning_rate': 1.0775862068965516e-05, 'epoch': 0.43}
{'loss': 1.6651, 'grad_norm': 6.886929035186768, 'learning_rate': 2.1551724137931033e-05, 'epoch': 0.86}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.36it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.20it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.36it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.08it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.75it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.23it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.20it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  3.28it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.41it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.54it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.60it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.54it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.54it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.58it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.68it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.70it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.70it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.74it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.50it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.60it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.61it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.04it/s][A                                                  
                                               [A  5%|â–Œ         | 116/2320 [01:15<19:22,  1.90it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.04it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  5%|â–Œ         | 117/2320 [01:18<2:09:10,  3.52s/it]  5%|â–Œ         | 118/2320 [01:19<1:36:44,  2.64s/it]  5%|â–Œ         | 119/2320 [01:19<1:14:24,  2.03s/it]  5%|â–Œ         | 120/2320 [01:20<58:23,  1.59s/it]    5%|â–Œ         | 121/2320 [01:21<47:06,  1.29s/it]  5%|â–Œ         | 122/2320 [01:21<39:11,  1.07s/it]  5%|â–Œ         | 123/2320 [01:22<33:51,  1.08it/s]  5%|â–Œ         | 124/2320 [01:22<29:56,  1.22it/s]  5%|â–Œ         | 125/2320 [01:23<27:30,  1.33it/s]  5%|â–Œ         | 126/2320 [01:24<25:47,  1.42it/s]  5%|â–Œ         | 127/2320 [01:24<24:42,  1.48it/s]  6%|â–Œ         | 128/2320 [01:25<23:45,  1.54it/s]  6%|â–Œ         | 129/2320 [01:25<22:55,  1.59it/s]  6%|â–Œ         | 130/2320 [01:26<22:38,  1.61it/s]  6%|â–Œ         | 131/2320 [01:27<22:21,  1.63it/s]  6%|â–Œ         | 132/2320 [01:27<23:54,  1.52it/s]  6%|â–Œ         | 133/2320 [01:28<23:06,  1.58it/s]  6%|â–Œ         | 134/2320 [01:28<22:32,  1.62it/s]  6%|â–Œ         | 135/2320 [01:29<22:13,  1.64it/s]  6%|â–Œ         | 136/2320 [01:30<22:01,  1.65it/s]  6%|â–Œ         | 137/2320 [01:30<21:41,  1.68it/s]  6%|â–Œ         | 138/2320 [01:31<21:30,  1.69it/s]  6%|â–Œ         | 139/2320 [01:31<21:13,  1.71it/s]  6%|â–Œ         | 140/2320 [01:32<21:19,  1.70it/s]  6%|â–Œ         | 141/2320 [01:33<21:18,  1.70it/s]  6%|â–Œ         | 142/2320 [01:33<21:20,  1.70it/s]  6%|â–Œ         | 143/2320 [01:34<21:33,  1.68it/s]  6%|â–Œ         | 144/2320 [01:34<21:16,  1.70it/s]  6%|â–‹         | 145/2320 [01:35<21:06,  1.72it/s]  6%|â–‹         | 146/2320 [01:35<20:59,  1.73it/s]  6%|â–‹         | 147/2320 [01:36<21:00,  1.72it/s]  6%|â–‹         | 148/2320 [01:37<21:04,  1.72it/s]  6%|â–‹         | 149/2320 [01:37<21:14,  1.70it/s]  6%|â–‹         | 150/2320 [01:38<21:05,  1.71it/s]                                                    6%|â–‹         | 150/2320 [01:38<21:05,  1.71it/s]  7%|â–‹         | 151/2320 [01:38<20:59,  1.72it/s]  7%|â–‹         | 152/2320 [01:39<21:08,  1.71it/s]  7%|â–‹         | 153/2320 [01:40<21:05,  1.71it/s]  7%|â–‹         | 154/2320 [01:40<21:13,  1.70it/s]  7%|â–‹         | 155/2320 [01:41<21:02,  1.71it/s]  7%|â–‹         | 156/2320 [01:41<21:19,  1.69it/s]  7%|â–‹         | 157/2320 [01:42<22:05,  1.63it/s]  7%|â–‹         | 158/2320 [01:43<21:57,  1.64it/s]  7%|â–‹         | 159/2320 [01:43<21:36,  1.67it/s]  7%|â–‹         | 160/2320 [01:44<21:36,  1.67it/s]  7%|â–‹         | 161/2320 [01:44<21:29,  1.67it/s]  7%|â–‹         | 162/2320 [01:45<21:25,  1.68it/s]  7%|â–‹         | 163/2320 [01:46<21:37,  1.66it/s]  7%|â–‹         | 164/2320 [01:46<21:46,  1.65it/s]  7%|â–‹         | 165/2320 [01:47<21:38,  1.66it/s]  7%|â–‹         | 166/2320 [01:47<21:36,  1.66it/s]  7%|â–‹         | 167/2320 [01:48<21:33,  1.67it/s]  7%|â–‹         | 168/2320 [01:49<21:34,  1.66it/s]  7%|â–‹         | 169/2320 [01:49<21:26,  1.67it/s]  7%|â–‹         | 170/2320 [01:50<21:11,  1.69it/s]  7%|â–‹         | 171/2320 [01:50<21:38,  1.66it/s]  7%|â–‹         | 172/2320 [01:51<21:22,  1.67it/s]  7%|â–‹         | 173/2320 [01:52<21:35,  1.66it/s]  8%|â–Š         | 174/2320 [01:52<21:38,  1.65it/s]  8%|â–Š         | 175/2320 [01:53<21:21,  1.67it/s]  8%|â–Š         | 176/2320 [01:53<21:27,  1.66it/s]  8%|â–Š         | 177/2320 [01:54<21:38,  1.65it/s]  8%|â–Š         | 178/2320 [01:55<21:28,  1.66it/s]  8%|â–Š         | 179/2320 [01:55<21:23,  1.67it/s]  8%|â–Š         | 180/2320 [01:56<21:13,  1.68it/s]  8%|â–Š         | 181/2320 [01:56<21:01,  1.70it/s]  8%|â–Š         | 182/2320 [01:57<21:20,  1.67it/s]  8%|â–Š         | 183/2320 [01:58<21:27,  1.66it/s]  8%|â–Š         | 184/2320 [01:58<21:41,  1.64it/s]  8%|â–Š         | 185/2320 [01:59<21:28,  1.66it/s]  8%|â–Š         | 186/2320 [01:59<21:18,  1.67it/s]  8%|â–Š         | 187/2320 [02:00<21:24,  1.66it/s]  8%|â–Š         | 188/2320 [02:01<22:10,  1.60it/s]  8%|â–Š         | 189/2320 [02:01<22:19,  1.59it/s]  8%|â–Š         | 190/2320 [02:02<21:58,  1.61it/s]  8%|â–Š         | 191/2320 [02:02<21:40,  1.64it/s]  8%|â–Š         | 192/2320 [02:03<21:30,  1.65it/s]  8%|â–Š         | 193/2320 [02:04<21:36,  1.64it/s]  8%|â–Š         | 194/2320 [02:04<21:41,  1.63it/s]  8%|â–Š         | 195/2320 [02:05<21:27,  1.65it/s]  8%|â–Š         | 196/2320 [02:05<21:06,  1.68it/s]  8%|â–Š         | 197/2320 [02:06<20:58,  1.69it/s]  9%|â–Š         | 198/2320 [02:07<21:25,  1.65it/s]  9%|â–Š         | 199/2320 [02:07<21:44,  1.63it/s]  9%|â–Š         | 200/2320 [02:08<22:04,  1.60it/s]                                                    9%|â–Š         | 200/2320 [02:08<22:04,  1.60it/s]  9%|â–Š         | 201/2320 [02:09<22:02,  1.60it/s]  9%|â–Š         | 202/2320 [02:09<21:43,  1.63it/s]  9%|â–‰         | 203/2320 [02:10<21:32,  1.64it/s]  9%|â–‰         | 204/2320 [02:10<21:18,  1.65it/s]  9%|â–‰         | 205/2320 [02:11<21:18,  1.65it/s]  9%|â–‰         | 206/2320 [02:12<21:06,  1.67it/s]  9%|â–‰         | 207/2320 [02:12<21:38,  1.63it/s]  9%|â–‰         | 208/2320 [02:13<22:04,  1.59it/s]  9%|â–‰         | 209/2320 [02:14<22:18,  1.58it/s]  9%|â–‰         | 210/2320 [02:14<22:21,  1.57it/s]  9%|â–‰         | 211/2320 [02:15<22:27,  1.56it/s]  9%|â–‰         | 212/2320 [02:15<22:32,  1.56it/s]  9%|â–‰         | 213/2320 [02:16<22:27,  1.56it/s]  9%|â–‰         | 214/2320 [02:17<22:31,  1.56it/s]  9%|â–‰         | 215/2320 [02:17<22:32,  1.56it/s]  9%|â–‰         | 216/2320 [02:18<22:29,  1.56it/s]  9%|â–‰         | 217/2320 [02:19<22:14,  1.58it/s]  9%|â–‰         | 218/2320 [02:19<21:39,  1.62it/s]  9%|â–‰         | 219/2320 [02:20<21:22,  1.64it/s]  9%|â–‰         | 220/2320 [02:20<21:11,  1.65it/s] 10%|â–‰         | 221/2320 [02:21<21:12,  1.65it/s] 10%|â–‰         | 222/2320 [02:22<21:16,  1.64it/s] 10%|â–‰         | 223/2320 [02:22<20:59,  1.67it/s] 10%|â–‰         | 224/2320 [02:23<21:29,  1.63it/s] 10%|â–‰         | 225/2320 [02:24<21:58,  1.59it/s] 10%|â–‰         | 226/2320 [02:24<22:04,  1.58it/s] 10%|â–‰         | 227/2320 [02:25<22:25,  1.56it/s] 10%|â–‰         | 228/2320 [02:25<22:22,  1.56it/s] 10%|â–‰         | 229/2320 [02:26<22:09,  1.57it/s] 10%|â–‰         | 230/2320 [02:27<22:03,  1.58it/s] 10%|â–‰         | 231/2320 [02:27<21:47,  1.60it/s] 10%|â–ˆ         | 232/2320 [02:28<19:31,  1.78it/s]{'eval_loss': 1.4131640195846558, 'eval_precision': 0.8711009174311927, 'eval_recall': 0.51338199513382, 'eval_f1': 0.6460282360945739, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'INGREDIENT_LINE': {'precision': 0.5118351434140908, 'recall': 0.5105555555555555, 'f1-score': 0.5111945487414824, 'support': 3600.0}, 'INSTRUCTION_STEP': {'precision': 0.021373510861948143, 'recall': 0.6161616161616161, 'f1-score': 0.04131391804944125, 'support': 99.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8966385410996189, 'recall': 0.7404889013767912, 'f1-score': 0.8111169246868364, 'support': 17795.0}, 'accuracy': 0.7014050432678887, 'macro avg': {'precision': 0.2042638850536654, 'recall': 0.266743724727709, 'f1-score': 0.19480362735396572, 'support': 21494.0}, 'weighted avg': {'precision': 0.828156942994965, 'recall': 0.7014050432678887, 'f1-score': 0.7573376815929322, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [25, 1, 16, 1838, 239, 0, 1481], [0, 0, 0, 0, 61, 0, 38], [0, 0, 0, 0, 0, 0, 0], [186, 0, 117, 1753, 2554, 8, 13177]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INGREDIENT_LINE': 4540, 'O': 17704, 'INSTRUCTION_STEP': 36}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.8245, 'eval_samples_per_second': 13.481, 'eval_steps_per_second': 3.37, 'epoch': 1.0}
{'loss': 1.4801, 'grad_norm': 2.9785406589508057, 'learning_rate': 3.232758620689655e-05, 'epoch': 1.29}
{'loss': 1.376, 'grad_norm': 4.749683856964111, 'learning_rate': 4.3103448275862066e-05, 'epoch': 1.72}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.28it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.20it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.24it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  3.99it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.79it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.59it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.45it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  3.50it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.55it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.58it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.60it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.61it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.58it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.58it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.55it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.55it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.61it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.63it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.65it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.66it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.70it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.12it/s][A                                                  
                                               [A 10%|â–ˆ         | 232/2320 [02:34<19:31,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.12it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 10%|â–ˆ         | 233/2320 [02:39<2:14:19,  3.86s/it] 10%|â–ˆ         | 234/2320 [02:40<1:40:01,  2.88s/it] 10%|â–ˆ         | 235/2320 [02:40<1:16:22,  2.20s/it] 10%|â–ˆ         | 236/2320 [02:41<1:00:05,  1.73s/it] 10%|â–ˆ         | 237/2320 [02:42<48:00,  1.38s/it]   10%|â–ˆ         | 238/2320 [02:42<41:36,  1.20s/it] 10%|â–ˆ         | 239/2320 [02:43<35:06,  1.01s/it] 10%|â–ˆ         | 240/2320 [02:44<30:37,  1.13it/s] 10%|â–ˆ         | 241/2320 [02:44<27:26,  1.26it/s] 10%|â–ˆ         | 242/2320 [02:45<25:11,  1.37it/s] 10%|â–ˆ         | 243/2320 [02:45<23:44,  1.46it/s] 11%|â–ˆ         | 244/2320 [02:46<22:49,  1.52it/s] 11%|â–ˆ         | 245/2320 [02:47<22:16,  1.55it/s] 11%|â–ˆ         | 246/2320 [02:47<21:33,  1.60it/s] 11%|â–ˆ         | 247/2320 [02:48<20:56,  1.65it/s] 11%|â–ˆ         | 248/2320 [02:48<20:30,  1.68it/s] 11%|â–ˆ         | 249/2320 [02:49<20:23,  1.69it/s] 11%|â–ˆ         | 250/2320 [02:49<20:18,  1.70it/s]                                                   11%|â–ˆ         | 250/2320 [02:49<20:18,  1.70it/s] 11%|â–ˆ         | 251/2320 [02:50<20:27,  1.69it/s] 11%|â–ˆ         | 252/2320 [02:51<20:27,  1.68it/s] 11%|â–ˆ         | 253/2320 [02:51<20:22,  1.69it/s] 11%|â–ˆ         | 254/2320 [02:52<20:13,  1.70it/s] 11%|â–ˆ         | 255/2320 [02:52<20:00,  1.72it/s] 11%|â–ˆ         | 256/2320 [02:53<20:20,  1.69it/s] 11%|â–ˆ         | 257/2320 [02:54<20:36,  1.67it/s] 11%|â–ˆ         | 258/2320 [02:54<20:39,  1.66it/s] 11%|â–ˆ         | 259/2320 [02:55<20:42,  1.66it/s] 11%|â–ˆ         | 260/2320 [02:55<20:44,  1.66it/s] 11%|â–ˆâ–        | 261/2320 [02:56<20:44,  1.65it/s] 11%|â–ˆâ–        | 262/2320 [02:57<20:42,  1.66it/s] 11%|â–ˆâ–        | 263/2320 [02:57<21:20,  1.61it/s] 11%|â–ˆâ–        | 264/2320 [02:58<21:20,  1.61it/s] 11%|â–ˆâ–        | 265/2320 [02:59<21:08,  1.62it/s] 11%|â–ˆâ–        | 266/2320 [02:59<20:52,  1.64it/s] 12%|â–ˆâ–        | 267/2320 [03:00<20:55,  1.63it/s] 12%|â–ˆâ–        | 268/2320 [03:00<20:59,  1.63it/s] 12%|â–ˆâ–        | 269/2320 [03:01<21:24,  1.60it/s] 12%|â–ˆâ–        | 270/2320 [03:02<21:10,  1.61it/s] 12%|â–ˆâ–        | 271/2320 [03:02<20:55,  1.63it/s] 12%|â–ˆâ–        | 272/2320 [03:03<21:04,  1.62it/s] 12%|â–ˆâ–        | 273/2320 [03:03<20:48,  1.64it/s] 12%|â–ˆâ–        | 274/2320 [03:04<20:41,  1.65it/s] 12%|â–ˆâ–        | 275/2320 [03:05<20:48,  1.64it/s] 12%|â–ˆâ–        | 276/2320 [03:05<20:53,  1.63it/s] 12%|â–ˆâ–        | 277/2320 [03:06<21:09,  1.61it/s] 12%|â–ˆâ–        | 278/2320 [03:07<20:54,  1.63it/s] 12%|â–ˆâ–        | 279/2320 [03:07<21:21,  1.59it/s] 12%|â–ˆâ–        | 280/2320 [03:08<21:16,  1.60it/s] 12%|â–ˆâ–        | 281/2320 [03:08<21:07,  1.61it/s] 12%|â–ˆâ–        | 282/2320 [03:09<21:07,  1.61it/s] 12%|â–ˆâ–        | 283/2320 [03:10<21:08,  1.61it/s] 12%|â–ˆâ–        | 284/2320 [03:10<21:05,  1.61it/s] 12%|â–ˆâ–        | 285/2320 [03:11<21:19,  1.59it/s] 12%|â–ˆâ–        | 286/2320 [03:12<21:32,  1.57it/s] 12%|â–ˆâ–        | 287/2320 [03:12<21:35,  1.57it/s] 12%|â–ˆâ–        | 288/2320 [03:13<21:46,  1.56it/s] 12%|â–ˆâ–        | 289/2320 [03:13<21:28,  1.58it/s] 12%|â–ˆâ–Ž        | 290/2320 [03:14<21:14,  1.59it/s] 13%|â–ˆâ–Ž        | 291/2320 [03:15<21:06,  1.60it/s] 13%|â–ˆâ–Ž        | 292/2320 [03:15<21:04,  1.60it/s] 13%|â–ˆâ–Ž        | 293/2320 [03:16<20:43,  1.63it/s] 13%|â–ˆâ–Ž        | 294/2320 [03:17<20:41,  1.63it/s] 13%|â–ˆâ–Ž        | 295/2320 [03:17<20:36,  1.64it/s] 13%|â–ˆâ–Ž        | 296/2320 [03:18<20:19,  1.66it/s] 13%|â–ˆâ–Ž        | 297/2320 [03:18<20:36,  1.64it/s] 13%|â–ˆâ–Ž        | 298/2320 [03:19<21:02,  1.60it/s] 13%|â–ˆâ–Ž        | 299/2320 [03:20<21:27,  1.57it/s] 13%|â–ˆâ–Ž        | 300/2320 [03:20<21:06,  1.59it/s]                                                   13%|â–ˆâ–Ž        | 300/2320 [03:20<21:06,  1.59it/s] 13%|â–ˆâ–Ž        | 301/2320 [03:21<22:09,  1.52it/s] 13%|â–ˆâ–Ž        | 302/2320 [03:22<21:59,  1.53it/s] 13%|â–ˆâ–Ž        | 303/2320 [03:22<21:54,  1.53it/s] 13%|â–ˆâ–Ž        | 304/2320 [03:23<21:42,  1.55it/s] 13%|â–ˆâ–Ž        | 305/2320 [03:24<21:20,  1.57it/s] 13%|â–ˆâ–Ž        | 306/2320 [03:24<21:21,  1.57it/s] 13%|â–ˆâ–Ž        | 307/2320 [03:25<20:58,  1.60it/s] 13%|â–ˆâ–Ž        | 308/2320 [03:25<20:47,  1.61it/s] 13%|â–ˆâ–Ž        | 309/2320 [03:26<20:55,  1.60it/s] 13%|â–ˆâ–Ž        | 310/2320 [03:27<20:31,  1.63it/s] 13%|â–ˆâ–Ž        | 311/2320 [03:27<20:23,  1.64it/s] 13%|â–ˆâ–Ž        | 312/2320 [03:28<20:13,  1.66it/s] 13%|â–ˆâ–Ž        | 313/2320 [03:28<20:06,  1.66it/s] 14%|â–ˆâ–Ž        | 314/2320 [03:29<19:56,  1.68it/s] 14%|â–ˆâ–Ž        | 315/2320 [03:30<20:25,  1.64it/s] 14%|â–ˆâ–Ž        | 316/2320 [03:30<20:49,  1.60it/s] 14%|â–ˆâ–Ž        | 317/2320 [03:31<20:51,  1.60it/s] 14%|â–ˆâ–Ž        | 318/2320 [03:32<20:51,  1.60it/s] 14%|â–ˆâ–        | 319/2320 [03:32<20:36,  1.62it/s] 14%|â–ˆâ–        | 320/2320 [03:33<20:19,  1.64it/s] 14%|â–ˆâ–        | 321/2320 [03:33<20:33,  1.62it/s] 14%|â–ˆâ–        | 322/2320 [03:34<20:38,  1.61it/s] 14%|â–ˆâ–        | 323/2320 [03:35<20:26,  1.63it/s] 14%|â–ˆâ–        | 324/2320 [03:35<20:11,  1.65it/s] 14%|â–ˆâ–        | 325/2320 [03:36<20:35,  1.62it/s] 14%|â–ˆâ–        | 326/2320 [03:36<20:39,  1.61it/s] 14%|â–ˆâ–        | 327/2320 [03:37<20:51,  1.59it/s] 14%|â–ˆâ–        | 328/2320 [03:38<20:53,  1.59it/s] 14%|â–ˆâ–        | 329/2320 [03:38<20:47,  1.60it/s] 14%|â–ˆâ–        | 330/2320 [03:39<21:01,  1.58it/s] 14%|â–ˆâ–        | 331/2320 [03:40<21:05,  1.57it/s] 14%|â–ˆâ–        | 332/2320 [03:40<21:06,  1.57it/s] 14%|â–ˆâ–        | 333/2320 [03:41<21:05,  1.57it/s] 14%|â–ˆâ–        | 334/2320 [03:42<21:05,  1.57it/s] 14%|â–ˆâ–        | 335/2320 [03:42<21:04,  1.57it/s] 14%|â–ˆâ–        | 336/2320 [03:43<20:35,  1.61it/s] 15%|â–ˆâ–        | 337/2320 [03:43<20:03,  1.65it/s] 15%|â–ˆâ–        | 338/2320 [03:44<19:50,  1.66it/s] 15%|â–ˆâ–        | 339/2320 [03:45<20:18,  1.63it/s] 15%|â–ˆâ–        | 340/2320 [03:45<20:40,  1.60it/s] 15%|â–ˆâ–        | 341/2320 [03:46<20:53,  1.58it/s] 15%|â–ˆâ–        | 342/2320 [03:47<20:46,  1.59it/s] 15%|â–ˆâ–        | 343/2320 [03:47<20:27,  1.61it/s] 15%|â–ˆâ–        | 344/2320 [03:48<20:22,  1.62it/s] 15%|â–ˆâ–        | 345/2320 [03:48<20:20,  1.62it/s] 15%|â–ˆâ–        | 346/2320 [03:49<20:17,  1.62it/s] 15%|â–ˆâ–        | 347/2320 [03:50<20:27,  1.61it/s] 15%|â–ˆâ–Œ        | 348/2320 [03:50<18:34,  1.77it/s]{'eval_loss': 1.1759427785873413, 'eval_precision': 0.882725527831094, 'eval_recall': 0.4247714048212801, 'eval_f1': 0.5735486687036229, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'INGREDIENT_LINE': {'precision': 0.834307992202729, 'recall': 0.40350168350168353, 'f1-score': 0.5439360929557008, 'support': 7425.0}, 'INSTRUCTION_STEP': {'precision': 0.5616678346180799, 'recall': 0.48065967016491756, 'f1-score': 0.5180158345451608, 'support': 3335.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.6177871529667937, 'recall': 0.8511296521983688, 'f1-score': 0.7159247723061152, 'support': 10667.0}, 'accuracy': 0.6363636363636364, 'macro avg': {'precision': 0.2876804256839432, 'recall': 0.24789871512356715, 'f1-score': 0.253982385686711, 'support': 21494.0}, 'weighted avg': {'precision': 0.6819500619360448, 'recall': 0.6363636363636364, 'f1-score': 0.623572989885248, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 0], [4, 0, 10, 2, 0, 0, 45], [0, 0, 0, 0, 0, 0, 6], [40, 1, 26, 2996, 403, 1, 3958], [1, 0, 1, 122, 1603, 0, 1608], [0, 0, 0, 0, 0, 0, 0], [166, 0, 96, 471, 848, 7, 9079]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INGREDIENT_LINE': 9057, 'O': 10615, 'INSTRUCTION_STEP': 2478, 'SECTION_HEADER': 123, 'RECIPE_TITLE': 7}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.7386, 'eval_samples_per_second': 13.653, 'eval_steps_per_second': 3.413, 'epoch': 2.0}
{'loss': 1.1797, 'grad_norm': 7.616124153137207, 'learning_rate': 4.9568965517241384e-05, 'epoch': 2.16}
{'loss': 1.2232, 'grad_norm': 46.438697814941406, 'learning_rate': 4.837164750957854e-05, 'epoch': 2.59}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.41it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.20it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.17it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.08it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.98it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.86it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.77it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.66it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.74it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.75it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.65it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.63it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.53it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.53it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.52it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.53it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.59it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.57it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.50it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.55it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.55it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.90it/s][A                                                  
                                               [A 15%|â–ˆâ–Œ        | 348/2320 [03:57<18:34,  1.77it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.90it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 15%|â–ˆâ–Œ        | 349/2320 [04:01<1:57:33,  3.58s/it] 15%|â–ˆâ–Œ        | 350/2320 [04:01<1:28:06,  2.68s/it]                                                     15%|â–ˆâ–Œ        | 350/2320 [04:01<1:28:06,  2.68s/it] 15%|â–ˆâ–Œ        | 351/2320 [04:02<1:07:23,  2.05s/it] 15%|â–ˆâ–Œ        | 352/2320 [04:02<52:51,  1.61s/it]   15%|â–ˆâ–Œ        | 353/2320 [04:03<42:43,  1.30s/it] 15%|â–ˆâ–Œ        | 354/2320 [04:04<35:34,  1.09s/it] 15%|â–ˆâ–Œ        | 355/2320 [04:04<30:40,  1.07it/s] 15%|â–ˆâ–Œ        | 356/2320 [04:05<27:07,  1.21it/s] 15%|â–ˆâ–Œ        | 357/2320 [04:05<24:59,  1.31it/s] 15%|â–ˆâ–Œ        | 358/2320 [04:06<23:28,  1.39it/s] 15%|â–ˆâ–Œ        | 359/2320 [04:07<22:17,  1.47it/s] 16%|â–ˆâ–Œ        | 360/2320 [04:07<21:40,  1.51it/s] 16%|â–ˆâ–Œ        | 361/2320 [04:08<21:05,  1.55it/s] 16%|â–ˆâ–Œ        | 362/2320 [04:08<20:17,  1.61it/s] 16%|â–ˆâ–Œ        | 363/2320 [04:09<20:00,  1.63it/s] 16%|â–ˆâ–Œ        | 364/2320 [04:10<20:09,  1.62it/s] 16%|â–ˆâ–Œ        | 365/2320 [04:10<20:01,  1.63it/s] 16%|â–ˆâ–Œ        | 366/2320 [04:11<19:58,  1.63it/s] 16%|â–ˆâ–Œ        | 367/2320 [04:11<19:39,  1.66it/s] 16%|â–ˆâ–Œ        | 368/2320 [04:12<19:44,  1.65it/s] 16%|â–ˆâ–Œ        | 369/2320 [04:13<19:32,  1.66it/s] 16%|â–ˆâ–Œ        | 370/2320 [04:13<19:24,  1.67it/s] 16%|â–ˆâ–Œ        | 371/2320 [04:14<19:25,  1.67it/s] 16%|â–ˆâ–Œ        | 372/2320 [04:14<19:12,  1.69it/s] 16%|â–ˆâ–Œ        | 373/2320 [04:15<19:14,  1.69it/s] 16%|â–ˆâ–Œ        | 374/2320 [04:16<19:33,  1.66it/s] 16%|â–ˆâ–Œ        | 375/2320 [04:16<19:32,  1.66it/s] 16%|â–ˆâ–Œ        | 376/2320 [04:17<19:34,  1.66it/s] 16%|â–ˆâ–‹        | 377/2320 [04:17<19:33,  1.66it/s] 16%|â–ˆâ–‹        | 378/2320 [04:18<20:02,  1.62it/s] 16%|â–ˆâ–‹        | 379/2320 [04:19<19:53,  1.63it/s] 16%|â–ˆâ–‹        | 380/2320 [04:19<19:54,  1.62it/s] 16%|â–ˆâ–‹        | 381/2320 [04:20<19:57,  1.62it/s] 16%|â–ˆâ–‹        | 382/2320 [04:21<20:13,  1.60it/s] 17%|â–ˆâ–‹        | 383/2320 [04:21<20:11,  1.60it/s] 17%|â–ˆâ–‹        | 384/2320 [04:22<19:51,  1.62it/s] 17%|â–ˆâ–‹        | 385/2320 [04:22<19:39,  1.64it/s] 17%|â–ˆâ–‹        | 386/2320 [04:23<19:41,  1.64it/s] 17%|â–ˆâ–‹        | 387/2320 [04:24<19:37,  1.64it/s] 17%|â–ˆâ–‹        | 388/2320 [04:24<19:43,  1.63it/s] 17%|â–ˆâ–‹        | 389/2320 [04:25<20:10,  1.60it/s] 17%|â–ˆâ–‹        | 390/2320 [04:25<20:21,  1.58it/s] 17%|â–ˆâ–‹        | 391/2320 [04:26<20:31,  1.57it/s] 17%|â–ˆâ–‹        | 392/2320 [04:27<20:33,  1.56it/s] 17%|â–ˆâ–‹        | 393/2320 [04:28<22:27,  1.43it/s] 17%|â–ˆâ–‹        | 394/2320 [04:28<21:54,  1.46it/s] 17%|â–ˆâ–‹        | 395/2320 [04:29<21:27,  1.50it/s] 17%|â–ˆâ–‹        | 396/2320 [04:29<20:32,  1.56it/s] 17%|â–ˆâ–‹        | 397/2320 [04:30<19:57,  1.61it/s] 17%|â–ˆâ–‹        | 398/2320 [04:31<20:00,  1.60it/s] 17%|â–ˆâ–‹        | 399/2320 [04:31<19:48,  1.62it/s] 17%|â–ˆâ–‹        | 400/2320 [04:32<19:42,  1.62it/s]                                                   17%|â–ˆâ–‹        | 400/2320 [04:32<19:42,  1.62it/s] 17%|â–ˆâ–‹        | 401/2320 [04:32<19:40,  1.63it/s] 17%|â–ˆâ–‹        | 402/2320 [04:33<20:30,  1.56it/s] 17%|â–ˆâ–‹        | 403/2320 [04:34<20:51,  1.53it/s] 17%|â–ˆâ–‹        | 404/2320 [04:35<20:54,  1.53it/s] 17%|â–ˆâ–‹        | 405/2320 [04:35<20:50,  1.53it/s] 18%|â–ˆâ–Š        | 406/2320 [04:36<20:58,  1.52it/s] 18%|â–ˆâ–Š        | 407/2320 [04:37<21:07,  1.51it/s] 18%|â–ˆâ–Š        | 408/2320 [04:37<21:18,  1.50it/s] 18%|â–ˆâ–Š        | 409/2320 [04:38<20:30,  1.55it/s] 18%|â–ˆâ–Š        | 410/2320 [04:38<20:40,  1.54it/s] 18%|â–ˆâ–Š        | 411/2320 [04:39<21:06,  1.51it/s] 18%|â–ˆâ–Š        | 412/2320 [04:40<21:29,  1.48it/s] 18%|â–ˆâ–Š        | 413/2320 [04:40<21:01,  1.51it/s] 18%|â–ˆâ–Š        | 414/2320 [04:41<21:17,  1.49it/s] 18%|â–ˆâ–Š        | 415/2320 [04:42<20:53,  1.52it/s] 18%|â–ˆâ–Š        | 416/2320 [04:42<20:42,  1.53it/s] 18%|â–ˆâ–Š        | 417/2320 [04:43<20:22,  1.56it/s] 18%|â–ˆâ–Š        | 418/2320 [04:44<20:08,  1.57it/s] 18%|â–ˆâ–Š        | 419/2320 [04:44<20:18,  1.56it/s] 18%|â–ˆâ–Š        | 420/2320 [04:45<20:42,  1.53it/s] 18%|â–ˆâ–Š        | 421/2320 [04:46<21:03,  1.50it/s] 18%|â–ˆâ–Š        | 422/2320 [04:46<20:44,  1.53it/s] 18%|â–ˆâ–Š        | 423/2320 [04:47<20:21,  1.55it/s] 18%|â–ˆâ–Š        | 424/2320 [04:48<20:11,  1.57it/s] 18%|â–ˆâ–Š        | 425/2320 [04:48<20:11,  1.56it/s] 18%|â–ˆâ–Š        | 426/2320 [04:49<20:19,  1.55it/s] 18%|â–ˆâ–Š        | 427/2320 [04:50<20:24,  1.55it/s] 18%|â–ˆâ–Š        | 428/2320 [04:50<20:23,  1.55it/s] 18%|â–ˆâ–Š        | 429/2320 [04:51<20:34,  1.53it/s] 19%|â–ˆâ–Š        | 430/2320 [04:51<20:14,  1.56it/s] 19%|â–ˆâ–Š        | 431/2320 [04:52<20:10,  1.56it/s] 19%|â–ˆâ–Š        | 432/2320 [04:53<20:12,  1.56it/s] 19%|â–ˆâ–Š        | 433/2320 [04:53<20:16,  1.55it/s] 19%|â–ˆâ–Š        | 434/2320 [04:54<20:24,  1.54it/s] 19%|â–ˆâ–‰        | 435/2320 [04:55<20:50,  1.51it/s] 19%|â–ˆâ–‰        | 436/2320 [04:55<20:54,  1.50it/s] 19%|â–ˆâ–‰        | 437/2320 [04:56<20:15,  1.55it/s] 19%|â–ˆâ–‰        | 438/2320 [04:57<20:18,  1.54it/s] 19%|â–ˆâ–‰        | 439/2320 [04:57<20:28,  1.53it/s] 19%|â–ˆâ–‰        | 440/2320 [04:58<20:39,  1.52it/s] 19%|â–ˆâ–‰        | 441/2320 [04:59<20:39,  1.52it/s] 19%|â–ˆâ–‰        | 442/2320 [04:59<20:45,  1.51it/s] 19%|â–ˆâ–‰        | 443/2320 [05:00<20:42,  1.51it/s] 19%|â–ˆâ–‰        | 444/2320 [05:01<20:17,  1.54it/s] 19%|â–ˆâ–‰        | 445/2320 [05:01<20:01,  1.56it/s] 19%|â–ˆâ–‰        | 446/2320 [05:02<19:46,  1.58it/s] 19%|â–ˆâ–‰        | 447/2320 [05:02<19:42,  1.58it/s] 19%|â–ˆâ–‰        | 448/2320 [05:03<19:35,  1.59it/s] 19%|â–ˆâ–‰        | 449/2320 [05:04<19:41,  1.58it/s] 19%|â–ˆâ–‰        | 450/2320 [05:04<19:42,  1.58it/s]                                                   19%|â–ˆâ–‰        | 450/2320 [05:04<19:42,  1.58it/s] 19%|â–ˆâ–‰        | 451/2320 [05:05<19:47,  1.57it/s] 19%|â–ˆâ–‰        | 452/2320 [05:06<19:50,  1.57it/s] 20%|â–ˆâ–‰        | 453/2320 [05:06<19:51,  1.57it/s] 20%|â–ˆâ–‰        | 454/2320 [05:07<19:53,  1.56it/s] 20%|â–ˆâ–‰        | 455/2320 [05:08<19:51,  1.57it/s] 20%|â–ˆâ–‰        | 456/2320 [05:08<19:52,  1.56it/s] 20%|â–ˆâ–‰        | 457/2320 [05:09<19:52,  1.56it/s] 20%|â–ˆâ–‰        | 458/2320 [05:10<20:14,  1.53it/s] 20%|â–ˆâ–‰        | 459/2320 [05:10<20:02,  1.55it/s] 20%|â–ˆâ–‰        | 460/2320 [05:11<19:28,  1.59it/s] 20%|â–ˆâ–‰        | 461/2320 [05:11<19:39,  1.58it/s] 20%|â–ˆâ–‰        | 462/2320 [05:12<19:54,  1.55it/s] 20%|â–ˆâ–‰        | 463/2320 [05:13<19:42,  1.57it/s] 20%|â–ˆâ–ˆ        | 464/2320 [05:13<17:52,  1.73it/s]{'eval_loss': 1.0997087955474854, 'eval_precision': 0.9291832045122206, 'eval_recall': 0.5746027645007105, 'eval_f1': 0.7100893997445722, 'eval_report': {'PAGE_HEADER': {'precision': 0.12322274881516587, 'recall': 0.896551724137931, 'f1-score': 0.21666666666666667, 'support': 29.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 38.0}, 'RECIPE_TITLE': {'precision': 0.007518796992481203, 'recall': 0.3333333333333333, 'f1-score': 0.014705882352941176, 'support': 3.0}, 'INGREDIENT_LINE': {'precision': 0.8206627680311891, 'recall': 0.5113656081901787, 'f1-score': 0.630104768013684, 'support': 5763.0}, 'INSTRUCTION_STEP': {'precision': 0.5164681149264191, 'recall': 0.7725366876310272, 'f1-score': 0.619067618647627, 'support': 1908.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7989929232444203, 'recall': 0.853777357667418, 'f1-score': 0.8254771696720448, 'support': 13753.0}, 'accuracy': 0.7532334605006048, 'macro avg': {'precision': 0.3238379074299536, 'recall': 0.4810806729942697, 'f1-score': 0.3294317293361377, 'support': 21494.0}, 'weighted avg': {'precision': 0.777288842697054, 'recall': 0.7532334605006048, 'f1-score': 0.7523769312330212, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[26, 0, 0, 0, 0, 0, 3], [0, 0, 12, 0, 0, 0, 26], [0, 0, 1, 0, 0, 0, 2], [45, 1, 31, 2947, 207, 1, 2531], [0, 0, 0, 42, 1474, 0, 392], [0, 0, 0, 0, 0, 0, 0], [140, 0, 89, 602, 1173, 7, 11742]], 'eval_PAGE_HEADER_precision': 0.46296296296296297, 'eval_PAGE_HEADER_recall': 0.1152073732718894, 'eval_PAGE_HEADER_f1': 0.18450184501845018, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.020689655172413793, 'eval_header_title_confusion_count': 3, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13971, 'INGREDIENT_LINE': 6738, 'INSTRUCTION_STEP': 1447, 'PAGE_HEADER': 54, 'SECTION_HEADER': 63, 'RECIPE_TITLE': 7}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.7373, 'eval_samples_per_second': 13.655, 'eval_steps_per_second': 3.414, 'epoch': 3.0}
{'loss': 1.1507, 'grad_norm': 5.993940353393555, 'learning_rate': 4.717432950191571e-05, 'epoch': 3.02}
{'loss': 0.861, 'grad_norm': 9.78321647644043, 'learning_rate': 4.597701149425287e-05, 'epoch': 3.45}
{'loss': 1.0098, 'grad_norm': 3.542759895324707, 'learning_rate': 4.477969348659004e-05, 'epoch': 3.88}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.02it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.24it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.34it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.07it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.92it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.78it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.73it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.64it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.66it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.66it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.64it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.71it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.67it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.63it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.55it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.49it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.53it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.55it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.48it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.52it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.56it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.90it/s][A                                                  
                                               [A 20%|â–ˆâ–ˆ        | 464/2320 [05:20<17:52,  1.73it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.90it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 20%|â–ˆâ–ˆ        | 465/2320 [05:25<2:05:09,  4.05s/it] 20%|â–ˆâ–ˆ        | 466/2320 [05:26<1:32:51,  3.01s/it] 20%|â–ˆâ–ˆ        | 467/2320 [05:26<1:10:39,  2.29s/it] 20%|â–ˆâ–ˆ        | 468/2320 [05:27<54:50,  1.78s/it]   20%|â–ˆâ–ˆ        | 469/2320 [05:28<43:48,  1.42s/it] 20%|â–ˆâ–ˆ        | 470/2320 [05:28<36:14,  1.18s/it] 20%|â–ˆâ–ˆ        | 471/2320 [05:29<30:46,  1.00it/s] 20%|â–ˆâ–ˆ        | 472/2320 [05:29<27:02,  1.14it/s] 20%|â–ˆâ–ˆ        | 473/2320 [05:30<24:39,  1.25it/s] 20%|â–ˆâ–ˆ        | 474/2320 [05:31<22:38,  1.36it/s] 20%|â–ˆâ–ˆ        | 475/2320 [05:31<21:13,  1.45it/s] 21%|â–ˆâ–ˆ        | 476/2320 [05:32<20:15,  1.52it/s] 21%|â–ˆâ–ˆ        | 477/2320 [05:32<19:50,  1.55it/s] 21%|â–ˆâ–ˆ        | 478/2320 [05:33<19:25,  1.58it/s] 21%|â–ˆâ–ˆ        | 479/2320 [05:34<18:59,  1.62it/s] 21%|â–ˆâ–ˆ        | 480/2320 [05:34<18:38,  1.64it/s] 21%|â–ˆâ–ˆ        | 481/2320 [05:35<18:19,  1.67it/s] 21%|â–ˆâ–ˆ        | 482/2320 [05:35<18:22,  1.67it/s] 21%|â–ˆâ–ˆ        | 483/2320 [05:36<18:22,  1.67it/s] 21%|â–ˆâ–ˆ        | 484/2320 [05:37<18:35,  1.65it/s] 21%|â–ˆâ–ˆ        | 485/2320 [05:37<18:55,  1.62it/s] 21%|â–ˆâ–ˆ        | 486/2320 [05:38<18:36,  1.64it/s] 21%|â–ˆâ–ˆ        | 487/2320 [05:38<18:19,  1.67it/s] 21%|â–ˆâ–ˆ        | 488/2320 [05:39<18:41,  1.63it/s] 21%|â–ˆâ–ˆ        | 489/2320 [05:40<18:55,  1.61it/s] 21%|â–ˆâ–ˆ        | 490/2320 [05:40<19:09,  1.59it/s] 21%|â–ˆâ–ˆ        | 491/2320 [05:41<19:20,  1.58it/s] 21%|â–ˆâ–ˆ        | 492/2320 [05:42<19:31,  1.56it/s] 21%|â–ˆâ–ˆâ–       | 493/2320 [05:42<19:08,  1.59it/s] 21%|â–ˆâ–ˆâ–       | 494/2320 [05:43<19:17,  1.58it/s] 21%|â–ˆâ–ˆâ–       | 495/2320 [05:44<19:02,  1.60it/s] 21%|â–ˆâ–ˆâ–       | 496/2320 [05:44<18:55,  1.61it/s] 21%|â–ˆâ–ˆâ–       | 497/2320 [05:45<18:55,  1.60it/s] 21%|â–ˆâ–ˆâ–       | 498/2320 [05:45<19:15,  1.58it/s] 22%|â–ˆâ–ˆâ–       | 499/2320 [05:46<19:26,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 500/2320 [05:47<19:34,  1.55it/s]                                                   22%|â–ˆâ–ˆâ–       | 500/2320 [05:47<19:34,  1.55it/s] 22%|â–ˆâ–ˆâ–       | 501/2320 [05:47<19:34,  1.55it/s] 22%|â–ˆâ–ˆâ–       | 502/2320 [05:48<19:16,  1.57it/s] 22%|â–ˆâ–ˆâ–       | 503/2320 [05:49<19:06,  1.59it/s] 22%|â–ˆâ–ˆâ–       | 504/2320 [05:49<19:25,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 505/2320 [05:50<19:17,  1.57it/s] 22%|â–ˆâ–ˆâ–       | 506/2320 [05:51<19:13,  1.57it/s] 22%|â–ˆâ–ˆâ–       | 507/2320 [05:51<19:08,  1.58it/s] 22%|â–ˆâ–ˆâ–       | 508/2320 [05:52<19:21,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 509/2320 [05:52<19:25,  1.55it/s] 22%|â–ˆâ–ˆâ–       | 510/2320 [05:53<19:36,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 511/2320 [05:54<19:41,  1.53it/s] 22%|â–ˆâ–ˆâ–       | 512/2320 [05:54<20:07,  1.50it/s] 22%|â–ˆâ–ˆâ–       | 513/2320 [05:55<19:53,  1.51it/s] 22%|â–ˆâ–ˆâ–       | 514/2320 [05:56<19:49,  1.52it/s] 22%|â–ˆâ–ˆâ–       | 515/2320 [05:56<19:40,  1.53it/s] 22%|â–ˆâ–ˆâ–       | 516/2320 [05:57<19:46,  1.52it/s] 22%|â–ˆâ–ˆâ–       | 517/2320 [05:58<19:48,  1.52it/s] 22%|â–ˆâ–ˆâ–       | 518/2320 [05:58<19:42,  1.52it/s] 22%|â–ˆâ–ˆâ–       | 519/2320 [05:59<19:42,  1.52it/s] 22%|â–ˆâ–ˆâ–       | 520/2320 [06:00<19:31,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 521/2320 [06:00<19:32,  1.53it/s] 22%|â–ˆâ–ˆâ–Ž       | 522/2320 [06:01<19:26,  1.54it/s] 23%|â–ˆâ–ˆâ–Ž       | 523/2320 [06:02<19:01,  1.57it/s] 23%|â–ˆâ–ˆâ–Ž       | 524/2320 [06:02<18:45,  1.60it/s] 23%|â–ˆâ–ˆâ–Ž       | 525/2320 [06:03<18:29,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 526/2320 [06:03<18:39,  1.60it/s] 23%|â–ˆâ–ˆâ–Ž       | 527/2320 [06:04<18:33,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 528/2320 [06:05<18:18,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 529/2320 [06:05<18:26,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 530/2320 [06:06<18:16,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 531/2320 [06:07<18:38,  1.60it/s] 23%|â–ˆâ–ˆâ–Ž       | 532/2320 [06:07<18:50,  1.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 533/2320 [06:08<18:58,  1.57it/s] 23%|â–ˆâ–ˆâ–Ž       | 534/2320 [06:08<19:13,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 535/2320 [06:09<20:55,  1.42it/s] 23%|â–ˆâ–ˆâ–Ž       | 536/2320 [06:10<20:28,  1.45it/s] 23%|â–ˆâ–ˆâ–Ž       | 537/2320 [06:11<19:48,  1.50it/s] 23%|â–ˆâ–ˆâ–Ž       | 538/2320 [06:11<19:20,  1.53it/s] 23%|â–ˆâ–ˆâ–Ž       | 539/2320 [06:12<18:55,  1.57it/s] 23%|â–ˆâ–ˆâ–Ž       | 540/2320 [06:12<18:34,  1.60it/s] 23%|â–ˆâ–ˆâ–Ž       | 541/2320 [06:13<18:44,  1.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 542/2320 [06:14<18:59,  1.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 543/2320 [06:14<18:59,  1.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 544/2320 [06:15<19:06,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 545/2320 [06:16<19:14,  1.54it/s] 24%|â–ˆâ–ˆâ–Ž       | 546/2320 [06:16<19:04,  1.55it/s] 24%|â–ˆâ–ˆâ–Ž       | 547/2320 [06:17<19:02,  1.55it/s] 24%|â–ˆâ–ˆâ–Ž       | 548/2320 [06:18<18:44,  1.58it/s] 24%|â–ˆâ–ˆâ–Ž       | 549/2320 [06:18<18:19,  1.61it/s] 24%|â–ˆâ–ˆâ–Ž       | 550/2320 [06:19<18:27,  1.60it/s]                                                   24%|â–ˆâ–ˆâ–Ž       | 550/2320 [06:19<18:27,  1.60it/s] 24%|â–ˆâ–ˆâ–       | 551/2320 [06:19<18:11,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 552/2320 [06:20<18:22,  1.60it/s] 24%|â–ˆâ–ˆâ–       | 553/2320 [06:21<18:11,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 554/2320 [06:21<18:32,  1.59it/s] 24%|â–ˆâ–ˆâ–       | 555/2320 [06:22<18:38,  1.58it/s] 24%|â–ˆâ–ˆâ–       | 556/2320 [06:23<18:46,  1.57it/s] 24%|â–ˆâ–ˆâ–       | 557/2320 [06:23<18:50,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 558/2320 [06:24<18:51,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 559/2320 [06:25<18:55,  1.55it/s] 24%|â–ˆâ–ˆâ–       | 560/2320 [06:25<18:59,  1.55it/s] 24%|â–ˆâ–ˆâ–       | 561/2320 [06:26<18:59,  1.54it/s] 24%|â–ˆâ–ˆâ–       | 562/2320 [06:26<18:58,  1.54it/s] 24%|â–ˆâ–ˆâ–       | 563/2320 [06:27<19:04,  1.53it/s] 24%|â–ˆâ–ˆâ–       | 564/2320 [06:28<19:24,  1.51it/s] 24%|â–ˆâ–ˆâ–       | 565/2320 [06:28<19:13,  1.52it/s] 24%|â–ˆâ–ˆâ–       | 566/2320 [06:29<19:12,  1.52it/s] 24%|â–ˆâ–ˆâ–       | 567/2320 [06:30<19:17,  1.51it/s] 24%|â–ˆâ–ˆâ–       | 568/2320 [06:30<19:16,  1.51it/s] 25%|â–ˆâ–ˆâ–       | 569/2320 [06:31<19:22,  1.51it/s] 25%|â–ˆâ–ˆâ–       | 570/2320 [06:32<19:14,  1.52it/s] 25%|â–ˆâ–ˆâ–       | 571/2320 [06:32<19:07,  1.52it/s] 25%|â–ˆâ–ˆâ–       | 572/2320 [06:33<18:58,  1.54it/s] 25%|â–ˆâ–ˆâ–       | 573/2320 [06:34<18:58,  1.53it/s] 25%|â–ˆâ–ˆâ–       | 574/2320 [06:34<19:05,  1.52it/s] 25%|â–ˆâ–ˆâ–       | 575/2320 [06:35<18:59,  1.53it/s] 25%|â–ˆâ–ˆâ–       | 576/2320 [06:36<18:56,  1.53it/s] 25%|â–ˆâ–ˆâ–       | 577/2320 [06:36<18:49,  1.54it/s] 25%|â–ˆâ–ˆâ–       | 578/2320 [06:37<18:49,  1.54it/s] 25%|â–ˆâ–ˆâ–       | 579/2320 [06:38<18:35,  1.56it/s] 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [06:38<16:52,  1.72it/s]{'eval_loss': 1.0297728776931763, 'eval_precision': 0.9480045610034208, 'eval_recall': 0.6713501291989664, 'eval_f1': 0.7860451923986007, 'eval_report': {'PAGE_HEADER': {'precision': 0.16587677725118483, 'recall': 0.45454545454545453, 'f1-score': 0.24305555555555555, 'support': 77.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 23.0}, 'RECIPE_TITLE': {'precision': 0.06766917293233082, 'recall': 0.3, 'f1-score': 0.11042944785276074, 'support': 30.0}, 'INGREDIENT_LINE': {'precision': 0.6360345307713728, 'recall': 0.7731888964116452, 'f1-score': 0.6979373567608862, 'support': 2954.0}, 'INSTRUCTION_STEP': {'precision': 0.6408549404344779, 'recall': 0.5884813384813384, 'f1-score': 0.6135524991613552, 'support': 3108.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8770413718018508, 'recall': 0.8423081950071886, 'f1-score': 0.8593239549303286, 'support': 15302.0}, 'accuracy': 0.7930585279612915, 'macro avg': {'precision': 0.341068113313031, 'recall': 0.42264626920651815, 'f1-score': 0.36061411632298374, 'support': 21494.0}, 'weighted avg': {'precision': 0.8051508708066077, 'recall': 0.7930585279612915, 'f1-score': 0.7974333041231227, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[35, 0, 4, 3, 0, 0, 35], [0, 0, 10, 1, 0, 0, 12], [1, 0, 9, 5, 0, 0, 15], [50, 1, 34, 2284, 48, 3, 534], [0, 0, 0, 68, 1829, 0, 1211], [0, 0, 0, 0, 0, 0, 0], [125, 0, 76, 1230, 977, 5, 12889]], 'eval_PAGE_HEADER_precision': 0.2482758620689655, 'eval_PAGE_HEADER_recall': 0.16589861751152074, 'eval_PAGE_HEADER_f1': 0.1988950276243094, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.03389830508474576, 'eval_RECIPE_TITLE_recall': 0.014084507042253521, 'eval_RECIPE_TITLE_f1': 0.01990049751243781, 'eval_header_false_positive_rate': 0.003937007874015748, 'eval_title_false_negative_rate': 0.05263157894736842, 'eval_header_title_confusion_count': 9, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15422, 'INGREDIENT_LINE': 3889, 'INSTRUCTION_STEP': 2726, 'PAGE_HEADER': 145, 'SECTION_HEADER': 39, 'RECIPE_TITLE': 59}, 'eval_title_anchor_accuracy': 0.16666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 1, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.7409, 'eval_samples_per_second': 13.648, 'eval_steps_per_second': 3.412, 'epoch': 4.0}
{'loss': 0.7659, 'grad_norm': 3.7258124351501465, 'learning_rate': 4.3582375478927204e-05, 'epoch': 4.31}
{'loss': 0.7493, 'grad_norm': 9.701643943786621, 'learning_rate': 4.238505747126437e-05, 'epoch': 4.74}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.17it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.01it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.35it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.09it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.94it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.79it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.63it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.57it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.56it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.59it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.55it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.44it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.44it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.47it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.52it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.53it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.54it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.58it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.52it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.63it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.60it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.92it/s][A                                                  
                                               [A 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [06:45<16:52,  1.72it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.92it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 25%|â–ˆâ–ˆâ–Œ       | 581/2320 [06:48<1:41:46,  3.51s/it] 25%|â–ˆâ–ˆâ–Œ       | 582/2320 [06:49<1:16:14,  2.63s/it] 25%|â–ˆâ–ˆâ–Œ       | 583/2320 [06:50<58:27,  2.02s/it]   25%|â–ˆâ–ˆâ–Œ       | 584/2320 [06:50<46:06,  1.59s/it] 25%|â–ˆâ–ˆâ–Œ       | 585/2320 [06:51<37:25,  1.29s/it] 25%|â–ˆâ–ˆâ–Œ       | 586/2320 [06:51<31:15,  1.08s/it] 25%|â–ˆâ–ˆâ–Œ       | 587/2320 [06:52<27:30,  1.05it/s] 25%|â–ˆâ–ˆâ–Œ       | 588/2320 [06:53<24:34,  1.17it/s] 25%|â–ˆâ–ˆâ–Œ       | 589/2320 [06:53<22:27,  1.28it/s] 25%|â–ˆâ–ˆâ–Œ       | 590/2320 [06:54<21:03,  1.37it/s] 25%|â–ˆâ–ˆâ–Œ       | 591/2320 [06:54<19:59,  1.44it/s] 26%|â–ˆâ–ˆâ–Œ       | 592/2320 [06:55<19:25,  1.48it/s] 26%|â–ˆâ–ˆâ–Œ       | 593/2320 [06:56<18:42,  1.54it/s] 26%|â–ˆâ–ˆâ–Œ       | 594/2320 [06:56<18:12,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 595/2320 [06:57<18:41,  1.54it/s] 26%|â–ˆâ–ˆâ–Œ       | 596/2320 [06:58<18:26,  1.56it/s] 26%|â–ˆâ–ˆâ–Œ       | 597/2320 [06:58<18:13,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 598/2320 [06:59<18:02,  1.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 599/2320 [06:59<17:58,  1.60it/s] 26%|â–ˆâ–ˆâ–Œ       | 600/2320 [07:00<17:56,  1.60it/s]                                                   26%|â–ˆâ–ˆâ–Œ       | 600/2320 [07:00<17:56,  1.60it/s] 26%|â–ˆâ–ˆâ–Œ       | 601/2320 [07:01<17:59,  1.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 602/2320 [07:01<18:05,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 603/2320 [07:02<18:11,  1.57it/s] 26%|â–ˆâ–ˆâ–Œ       | 604/2320 [07:03<18:12,  1.57it/s] 26%|â–ˆâ–ˆâ–Œ       | 605/2320 [07:03<18:26,  1.55it/s] 26%|â–ˆâ–ˆâ–Œ       | 606/2320 [07:04<18:20,  1.56it/s] 26%|â–ˆâ–ˆâ–Œ       | 607/2320 [07:05<18:18,  1.56it/s] 26%|â–ˆâ–ˆâ–Œ       | 608/2320 [07:05<18:08,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 609/2320 [07:06<18:09,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 610/2320 [07:06<18:10,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 611/2320 [07:07<18:05,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 612/2320 [07:08<18:05,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 613/2320 [07:08<18:07,  1.57it/s] 26%|â–ˆâ–ˆâ–‹       | 614/2320 [07:09<18:07,  1.57it/s] 27%|â–ˆâ–ˆâ–‹       | 615/2320 [07:10<17:46,  1.60it/s] 27%|â–ˆâ–ˆâ–‹       | 616/2320 [07:10<17:29,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 617/2320 [07:11<17:25,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 618/2320 [07:11<17:34,  1.61it/s] 27%|â–ˆâ–ˆâ–‹       | 619/2320 [07:12<17:55,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 620/2320 [07:13<17:52,  1.59it/s] 27%|â–ˆâ–ˆâ–‹       | 621/2320 [07:13<17:55,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 622/2320 [07:14<18:04,  1.57it/s] 27%|â–ˆâ–ˆâ–‹       | 623/2320 [07:15<18:13,  1.55it/s] 27%|â–ˆâ–ˆâ–‹       | 624/2320 [07:15<18:41,  1.51it/s] 27%|â–ˆâ–ˆâ–‹       | 625/2320 [07:16<18:39,  1.51it/s] 27%|â–ˆâ–ˆâ–‹       | 626/2320 [07:17<18:22,  1.54it/s] 27%|â–ˆâ–ˆâ–‹       | 627/2320 [07:17<18:21,  1.54it/s] 27%|â–ˆâ–ˆâ–‹       | 628/2320 [07:18<18:24,  1.53it/s] 27%|â–ˆâ–ˆâ–‹       | 629/2320 [07:19<18:06,  1.56it/s] 27%|â–ˆâ–ˆâ–‹       | 630/2320 [07:19<18:33,  1.52it/s] 27%|â–ˆâ–ˆâ–‹       | 631/2320 [07:20<18:46,  1.50it/s] 27%|â–ˆâ–ˆâ–‹       | 632/2320 [07:21<18:28,  1.52it/s] 27%|â–ˆâ–ˆâ–‹       | 633/2320 [07:21<18:24,  1.53it/s] 27%|â–ˆâ–ˆâ–‹       | 634/2320 [07:22<18:17,  1.54it/s] 27%|â–ˆâ–ˆâ–‹       | 635/2320 [07:22<17:45,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 636/2320 [07:23<18:03,  1.55it/s] 27%|â–ˆâ–ˆâ–‹       | 637/2320 [07:24<18:11,  1.54it/s] 28%|â–ˆâ–ˆâ–Š       | 638/2320 [07:24<18:06,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 639/2320 [07:25<18:07,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 640/2320 [07:26<18:14,  1.53it/s] 28%|â–ˆâ–ˆâ–Š       | 641/2320 [07:26<18:15,  1.53it/s] 28%|â–ˆâ–ˆâ–Š       | 642/2320 [07:27<18:17,  1.53it/s] 28%|â–ˆâ–ˆâ–Š       | 643/2320 [07:28<18:05,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 644/2320 [07:28<18:04,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 645/2320 [07:29<17:58,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 646/2320 [07:30<18:01,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 647/2320 [07:30<17:44,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 648/2320 [07:31<17:48,  1.56it/s] 28%|â–ˆâ–ˆâ–Š       | 649/2320 [07:31<17:26,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 650/2320 [07:32<17:34,  1.58it/s]                                                   28%|â–ˆâ–ˆâ–Š       | 650/2320 [07:32<17:34,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 651/2320 [07:33<17:43,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 652/2320 [07:33<17:53,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 653/2320 [07:34<17:48,  1.56it/s] 28%|â–ˆâ–ˆâ–Š       | 654/2320 [07:35<17:51,  1.55it/s] 28%|â–ˆâ–ˆâ–Š       | 655/2320 [07:35<17:58,  1.54it/s] 28%|â–ˆâ–ˆâ–Š       | 656/2320 [07:36<17:34,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 657/2320 [07:37<17:24,  1.59it/s] 28%|â–ˆâ–ˆâ–Š       | 658/2320 [07:37<17:17,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 659/2320 [07:38<17:24,  1.59it/s] 28%|â–ˆâ–ˆâ–Š       | 660/2320 [07:38<17:14,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 661/2320 [07:39<17:09,  1.61it/s] 29%|â–ˆâ–ˆâ–Š       | 662/2320 [07:40<17:42,  1.56it/s] 29%|â–ˆâ–ˆâ–Š       | 663/2320 [07:40<17:45,  1.56it/s] 29%|â–ˆâ–ˆâ–Š       | 664/2320 [07:41<17:44,  1.56it/s] 29%|â–ˆâ–ˆâ–Š       | 665/2320 [07:42<17:43,  1.56it/s] 29%|â–ˆâ–ˆâ–Š       | 666/2320 [07:42<17:56,  1.54it/s] 29%|â–ˆâ–ˆâ–‰       | 667/2320 [07:43<17:27,  1.58it/s] 29%|â–ˆâ–ˆâ–‰       | 668/2320 [07:44<17:11,  1.60it/s] 29%|â–ˆâ–ˆâ–‰       | 669/2320 [07:44<17:05,  1.61it/s] 29%|â–ˆâ–ˆâ–‰       | 670/2320 [07:45<17:10,  1.60it/s] 29%|â–ˆâ–ˆâ–‰       | 671/2320 [07:45<17:07,  1.60it/s] 29%|â–ˆâ–ˆâ–‰       | 672/2320 [07:46<16:55,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 673/2320 [07:47<17:03,  1.61it/s] 29%|â–ˆâ–ˆâ–‰       | 674/2320 [07:47<16:47,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 675/2320 [07:48<17:03,  1.61it/s] 29%|â–ˆâ–ˆâ–‰       | 676/2320 [07:49<17:21,  1.58it/s] 29%|â–ˆâ–ˆâ–‰       | 677/2320 [07:49<17:36,  1.55it/s] 29%|â–ˆâ–ˆâ–‰       | 678/2320 [07:50<17:39,  1.55it/s] 29%|â–ˆâ–ˆâ–‰       | 679/2320 [07:51<17:34,  1.56it/s] 29%|â–ˆâ–ˆâ–‰       | 680/2320 [07:51<17:34,  1.55it/s] 29%|â–ˆâ–ˆâ–‰       | 681/2320 [07:52<17:27,  1.56it/s] 29%|â–ˆâ–ˆâ–‰       | 682/2320 [07:52<17:32,  1.56it/s] 29%|â–ˆâ–ˆâ–‰       | 683/2320 [07:53<17:34,  1.55it/s] 29%|â–ˆâ–ˆâ–‰       | 684/2320 [07:54<17:40,  1.54it/s] 30%|â–ˆâ–ˆâ–‰       | 685/2320 [07:54<17:34,  1.55it/s] 30%|â–ˆâ–ˆâ–‰       | 686/2320 [07:55<17:32,  1.55it/s] 30%|â–ˆâ–ˆâ–‰       | 687/2320 [07:56<17:25,  1.56it/s] 30%|â–ˆâ–ˆâ–‰       | 688/2320 [07:56<17:17,  1.57it/s] 30%|â–ˆâ–ˆâ–‰       | 689/2320 [07:57<17:23,  1.56it/s] 30%|â–ˆâ–ˆâ–‰       | 690/2320 [07:58<17:28,  1.55it/s] 30%|â–ˆâ–ˆâ–‰       | 691/2320 [07:58<17:45,  1.53it/s] 30%|â–ˆâ–ˆâ–‰       | 692/2320 [07:59<17:55,  1.51it/s] 30%|â–ˆâ–ˆâ–‰       | 693/2320 [08:00<17:44,  1.53it/s] 30%|â–ˆâ–ˆâ–‰       | 694/2320 [08:00<17:07,  1.58it/s] 30%|â–ˆâ–ˆâ–‰       | 695/2320 [08:01<17:09,  1.58it/s] 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [08:01<15:31,  1.74it/s]{'eval_loss': 1.170979380607605, 'eval_precision': 0.9496010079798404, 'eval_recall': 0.6211538461538462, 'eval_f1': 0.7510380335492444, 'eval_report': {'PAGE_HEADER': {'precision': 0.014218009478672985, 'recall': 0.25, 'f1-score': 0.026905829596412557, 'support': 12.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.015037593984962405, 'recall': 1.0, 'f1-score': 0.02962962962962963, 'support': 2.0}, 'INGREDIENT_LINE': {'precision': 0.7156780840991367, 'recall': 0.7852123434158265, 'f1-score': 0.7488344988344988, 'support': 3273.0}, 'INSTRUCTION_STEP': {'precision': 0.6822004204625087, 'recall': 0.48809225369766857, 'f1-score': 0.5690486628671635, 'support': 3989.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8286608600979859, 'recall': 0.8567609399183903, 'f1-score': 0.8424766516776202, 'support': 14214.0}, 'accuracy': 0.7769610123755467, 'macro avg': {'precision': 0.3222564240176095, 'recall': 0.4828665052902693, 'f1-score': 0.3166993246579035, 'support': 21494.0}, 'weighted avg': {'precision': 0.7835906766174703, 'recall': 0.7769610123755467, 'f1-score': 0.7767849486844021, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[3, 0, 0, 0, 0, 0, 9], [0, 0, 0, 0, 0, 0, 4], [0, 0, 2, 0, 0, 0, 0], [40, 1, 32, 2570, 53, 3, 574], [1, 0, 1, 109, 1947, 0, 1931], [0, 0, 0, 0, 0, 0, 0], [167, 0, 98, 912, 854, 5, 12178]], 'eval_PAGE_HEADER_precision': 0.23076923076923078, 'eval_PAGE_HEADER_recall': 0.013824884792626729, 'eval_PAGE_HEADER_f1': 0.026086956521739132, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14720, 'INGREDIENT_LINE': 4237, 'INSTRUCTION_STEP': 3301, 'PAGE_HEADER': 13, 'SECTION_HEADER': 9}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.7964, 'eval_samples_per_second': 13.537, 'eval_steps_per_second': 3.384, 'epoch': 5.0}
{'loss': 0.8126, 'grad_norm': 11.979899406433105, 'learning_rate': 4.1187739463601534e-05, 'epoch': 5.17}
{'loss': 0.5849, 'grad_norm': 14.387334823608398, 'learning_rate': 3.99904214559387e-05, 'epoch': 5.6}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  4.36it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.94it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.69it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.59it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.59it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.58it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.58it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.60it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.54it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.39it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.40it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:03,  3.27it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.29it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.34it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.32it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.42it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.44it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.44it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.49it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.52it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:06<00:00,  3.65it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.99it/s][A                                                  
                                               [A 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [08:08<15:31,  1.74it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.99it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 30%|â–ˆâ–ˆâ–ˆ       | 697/2320 [08:12<1:38:05,  3.63s/it] 30%|â–ˆâ–ˆâ–ˆ       | 698/2320 [08:13<1:13:26,  2.72s/it] 30%|â–ˆâ–ˆâ–ˆ       | 699/2320 [08:13<56:03,  2.08s/it]   30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [08:14<43:59,  1.63s/it]                                                   30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [08:14<43:59,  1.63s/it] 30%|â–ˆâ–ˆâ–ˆ       | 701/2320 [08:14<35:33,  1.32s/it] 30%|â–ˆâ–ˆâ–ˆ       | 702/2320 [08:15<29:34,  1.10s/it] 30%|â–ˆâ–ˆâ–ˆ       | 703/2320 [08:16<25:45,  1.05it/s] 30%|â–ˆâ–ˆâ–ˆ       | 704/2320 [08:16<23:08,  1.16it/s] 30%|â–ˆâ–ˆâ–ˆ       | 705/2320 [08:17<21:29,  1.25it/s] 30%|â–ˆâ–ˆâ–ˆ       | 706/2320 [08:17<20:08,  1.34it/s] 30%|â–ˆâ–ˆâ–ˆ       | 707/2320 [08:18<18:50,  1.43it/s] 31%|â–ˆâ–ˆâ–ˆ       | 708/2320 [08:19<17:53,  1.50it/s] 31%|â–ˆâ–ˆâ–ˆ       | 709/2320 [08:19<17:07,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 710/2320 [08:20<17:07,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 711/2320 [08:20<17:09,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆ       | 712/2320 [08:21<16:58,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆ       | 713/2320 [08:22<16:42,  1.60it/s] 31%|â–ˆâ–ˆâ–ˆ       | 714/2320 [08:22<16:47,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆ       | 715/2320 [08:23<16:31,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 716/2320 [08:24<16:36,  1.61it/s] 31%|â–ˆâ–ˆâ–ˆ       | 717/2320 [08:24<16:48,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆ       | 718/2320 [08:25<16:50,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆ       | 719/2320 [08:26<17:00,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 720/2320 [08:26<16:59,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 721/2320 [08:27<17:05,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆ       | 722/2320 [08:27<17:00,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 723/2320 [08:28<16:59,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 724/2320 [08:29<16:54,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 725/2320 [08:29<17:07,  1.55it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 726/2320 [08:30<16:59,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 727/2320 [08:31<16:57,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 728/2320 [08:31<16:58,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 729/2320 [08:32<16:57,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 730/2320 [08:32<16:34,  1.60it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 731/2320 [08:33<16:37,  1.59it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 732/2320 [08:34<16:41,  1.59it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 733/2320 [08:34<16:44,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 734/2320 [08:35<16:51,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 735/2320 [08:36<17:08,  1.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 736/2320 [08:36<17:08,  1.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 737/2320 [08:37<17:02,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 738/2320 [08:38<17:11,  1.53it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 739/2320 [08:38<17:12,  1.53it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 740/2320 [08:39<17:02,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 741/2320 [08:40<16:54,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 742/2320 [08:40<16:39,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 743/2320 [08:41<16:40,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 744/2320 [08:42<16:48,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 745/2320 [08:42<16:48,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 746/2320 [08:43<16:58,  1.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 747/2320 [08:43<17:03,  1.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 748/2320 [08:44<17:01,  1.54it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 749/2320 [08:45<16:53,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [08:45<16:50,  1.55it/s]                                                   32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [08:45<16:50,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 751/2320 [08:46<16:48,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 752/2320 [08:47<16:45,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 753/2320 [08:47<16:52,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 754/2320 [08:48<16:45,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 755/2320 [08:49<16:36,  1.57it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 756/2320 [08:49<16:39,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 757/2320 [08:50<16:39,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 758/2320 [08:51<16:55,  1.54it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 759/2320 [08:51<16:39,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 760/2320 [08:52<16:41,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 761/2320 [08:52<16:49,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 762/2320 [08:53<16:58,  1.53it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 763/2320 [08:54<16:59,  1.53it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 764/2320 [08:54<16:57,  1.53it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 765/2320 [08:55<16:41,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 766/2320 [08:56<16:08,  1.60it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 767/2320 [08:56<16:15,  1.59it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 768/2320 [08:57<16:20,  1.58it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 769/2320 [08:58<16:28,  1.57it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 770/2320 [08:58<16:32,  1.56it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 771/2320 [08:59<16:36,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 772/2320 [09:00<16:37,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 773/2320 [09:00<16:40,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 774/2320 [09:01<16:37,  1.55it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 775/2320 [09:01<16:42,  1.54it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 776/2320 [09:02<16:41,  1.54it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 777/2320 [09:03<16:28,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 778/2320 [09:03<16:30,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 779/2320 [09:04<16:29,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 780/2320 [09:05<16:24,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 781/2320 [09:05<16:28,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 782/2320 [09:06<16:07,  1.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 783/2320 [09:07<16:05,  1.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 784/2320 [09:07<15:51,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 785/2320 [09:08<15:55,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 786/2320 [09:08<15:42,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 787/2320 [09:09<15:50,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 788/2320 [09:10<15:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 789/2320 [09:10<15:49,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 790/2320 [09:11<15:35,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 791/2320 [09:11<15:41,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 792/2320 [09:12<15:35,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 793/2320 [09:13<15:47,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 794/2320 [09:13<15:55,  1.60it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 795/2320 [09:14<16:05,  1.58it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 796/2320 [09:15<16:11,  1.57it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 797/2320 [09:15<16:10,  1.57it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 798/2320 [09:16<16:11,  1.57it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 799/2320 [09:17<16:16,  1.56it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [09:17<16:13,  1.56it/s]                                                   34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [09:17<16:13,  1.56it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 801/2320 [09:18<16:18,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 802/2320 [09:18<16:17,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 803/2320 [09:19<16:18,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 804/2320 [09:20<16:19,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 805/2320 [09:20<16:16,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 806/2320 [09:21<16:17,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 807/2320 [09:22<16:22,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 808/2320 [09:22<16:21,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 809/2320 [09:23<16:16,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 810/2320 [09:24<16:16,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 811/2320 [09:24<16:14,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [09:25<14:41,  1.71it/s]{'eval_loss': 1.0840890407562256, 'eval_precision': 0.8461858241529827, 'eval_recall': 0.575, 'eval_f1': 0.6847195357833655, 'eval_report': {'PAGE_HEADER': {'precision': 0.7725118483412322, 'recall': 0.24772036474164133, 'f1-score': 0.3751438434982739, 'support': 658.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26.0}, 'RECIPE_TITLE': {'precision': 0.6541353383458647, 'recall': 0.19594594594594594, 'f1-score': 0.30155979202772965, 'support': 444.0}, 'INGREDIENT_LINE': {'precision': 0.531328320802005, 'recall': 0.7973255328040117, 'f1-score': 0.6377005347593583, 'support': 2393.0}, 'INSTRUCTION_STEP': {'precision': 0.6702873160476525, 'recall': 0.5375105366676033, 'f1-score': 0.5966006549196944, 'support': 3559.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8456042460533478, 'recall': 0.8621479117524629, 'f1-score': 0.8537959464101683, 'support': 14414.0}, 'accuracy': 0.7675630408486089, 'macro avg': {'precision': 0.4962667242271574, 'recall': 0.3772357559873808, 'f1-score': 0.39497153880217495, 'support': 21494.0}, 'weighted avg': {'precision': 0.7743700436652017, 'recall': 0.7675630408486089, 'f1-score': 0.7600572754618349, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[163, 0, 24, 211, 41, 4, 215], [6, 0, 11, 0, 0, 0, 9], [22, 0, 87, 188, 33, 3, 111], [13, 1, 9, 1908, 37, 1, 424], [0, 0, 0, 136, 1913, 0, 1510], [0, 0, 0, 0, 0, 0, 0], [7, 0, 2, 1148, 830, 0, 12427]], 'eval_PAGE_HEADER_precision': 0.14947856315179606, 'eval_PAGE_HEADER_recall': 0.5944700460829493, 'eval_PAGE_HEADER_f1': 0.23888888888888887, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0661764705882353, 'eval_RECIPE_TITLE_recall': 0.2535211267605634, 'eval_RECIPE_TITLE_f1': 0.10495626822157436, 'eval_header_false_positive_rate': 0.1240506329113924, 'eval_title_false_negative_rate': 0.2793522267206478, 'eval_header_title_confusion_count': 118, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15019, 'INGREDIENT_LINE': 2829, 'INSTRUCTION_STEP': 2983, 'PAGE_HEADER': 863, 'SECTION_HEADER': 42, 'RECIPE_TITLE': 544}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 7.2208, 'eval_samples_per_second': 12.741, 'eval_steps_per_second': 3.185, 'epoch': 6.0}
{'loss': 0.6029, 'grad_norm': 5.858209609985352, 'learning_rate': 3.8793103448275865e-05, 'epoch': 6.03}
{'loss': 0.4946, 'grad_norm': 3.1011664867401123, 'learning_rate': 3.759578544061303e-05, 'epoch': 6.47}
{'loss': 0.4717, 'grad_norm': 4.636483669281006, 'learning_rate': 3.6398467432950195e-05, 'epoch': 6.9}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.66it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.57it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:05,  3.61it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.59it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.61it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.65it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.58it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.52it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.58it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.63it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.66it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.61it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.62it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.61it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.65it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.70it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.71it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.72it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.58it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.59it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.64it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.95it/s][A                                                  
                                               [A 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [09:32<14:41,  1.71it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.95it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 813/2320 [09:36<1:33:14,  3.71s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 814/2320 [09:36<1:09:55,  2.79s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 815/2320 [09:37<54:31,  2.17s/it]   35%|â–ˆâ–ˆâ–ˆâ–Œ      | 816/2320 [09:38<42:35,  1.70s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 817/2320 [09:38<34:07,  1.36s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 818/2320 [09:39<28:11,  1.13s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 819/2320 [09:39<24:09,  1.04it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 820/2320 [09:40<21:13,  1.18it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 821/2320 [09:41<19:11,  1.30it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 822/2320 [09:41<17:55,  1.39it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 823/2320 [09:42<16:55,  1.47it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 824/2320 [09:42<16:21,  1.52it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 825/2320 [09:43<16:17,  1.53it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 826/2320 [09:44<15:59,  1.56it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 827/2320 [09:44<15:37,  1.59it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 828/2320 [09:45<15:25,  1.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 829/2320 [09:45<15:32,  1.60it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 830/2320 [09:46<15:21,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 831/2320 [09:47<15:23,  1.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 832/2320 [09:47<15:31,  1.60it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 833/2320 [09:48<15:25,  1.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 834/2320 [09:49<15:20,  1.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 835/2320 [09:49<15:18,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 836/2320 [09:50<15:13,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 837/2320 [09:50<15:15,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 838/2320 [09:51<15:18,  1.61it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 839/2320 [09:52<15:31,  1.59it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 840/2320 [09:52<15:44,  1.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 841/2320 [09:53<15:51,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 842/2320 [09:54<15:26,  1.59it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 843/2320 [09:54<15:12,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 844/2320 [09:55<15:32,  1.58it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 845/2320 [09:56<15:51,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 846/2320 [09:56<15:46,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 847/2320 [09:57<15:41,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 848/2320 [09:57<15:39,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 849/2320 [09:58<15:41,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [09:59<15:37,  1.57it/s]                                                   37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [09:59<15:37,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 851/2320 [09:59<15:41,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 852/2320 [10:00<15:46,  1.55it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 853/2320 [10:01<15:37,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 854/2320 [10:01<15:36,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 855/2320 [10:02<15:25,  1.58it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 856/2320 [10:03<15:32,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 857/2320 [10:03<15:34,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 858/2320 [10:04<15:48,  1.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 859/2320 [10:05<15:47,  1.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 860/2320 [10:05<15:47,  1.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 861/2320 [10:06<16:05,  1.51it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 862/2320 [10:07<16:02,  1.51it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 863/2320 [10:07<16:06,  1.51it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 864/2320 [10:08<16:10,  1.50it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 865/2320 [10:09<15:55,  1.52it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 866/2320 [10:09<15:55,  1.52it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 867/2320 [10:10<15:58,  1.52it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 868/2320 [10:10<15:53,  1.52it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 869/2320 [10:11<15:50,  1.53it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 870/2320 [10:12<15:48,  1.53it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 871/2320 [10:12<15:53,  1.52it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 872/2320 [10:13<16:51,  1.43it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 873/2320 [10:14<16:55,  1.42it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 874/2320 [10:15<16:22,  1.47it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 875/2320 [10:15<16:19,  1.48it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 876/2320 [10:16<16:16,  1.48it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 877/2320 [10:17<16:01,  1.50it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 878/2320 [10:17<15:32,  1.55it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 879/2320 [10:18<15:20,  1.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 880/2320 [10:18<15:05,  1.59it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 881/2320 [10:19<14:57,  1.60it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 882/2320 [10:20<15:09,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 883/2320 [10:20<15:19,  1.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 884/2320 [10:21<15:20,  1.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 885/2320 [10:22<15:22,  1.55it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 886/2320 [10:22<15:29,  1.54it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 887/2320 [10:23<15:28,  1.54it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 888/2320 [10:24<15:04,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 889/2320 [10:24<15:03,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 890/2320 [10:25<15:13,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 891/2320 [10:25<15:15,  1.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 892/2320 [10:26<15:12,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 893/2320 [10:27<15:10,  1.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 894/2320 [10:27<15:11,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 895/2320 [10:28<15:08,  1.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 896/2320 [10:29<15:10,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 897/2320 [10:29<15:14,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 898/2320 [10:30<14:51,  1.59it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 899/2320 [10:31<14:57,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [10:31<15:00,  1.58it/s]                                                   39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [10:31<15:00,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 901/2320 [10:32<14:58,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 902/2320 [10:32<14:59,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 903/2320 [10:33<15:01,  1.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 904/2320 [10:34<15:14,  1.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 905/2320 [10:34<15:16,  1.54it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 906/2320 [10:35<14:56,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 907/2320 [10:36<15:02,  1.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 908/2320 [10:36<15:06,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 909/2320 [10:37<15:03,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 910/2320 [10:38<15:08,  1.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 911/2320 [10:38<15:03,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 912/2320 [10:39<15:15,  1.54it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 913/2320 [10:40<15:09,  1.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 914/2320 [10:40<14:41,  1.60it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 915/2320 [10:41<14:43,  1.59it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 916/2320 [10:41<14:29,  1.61it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 917/2320 [10:42<14:20,  1.63it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 918/2320 [10:43<14:37,  1.60it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 919/2320 [10:43<14:23,  1.62it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 920/2320 [10:44<14:14,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 921/2320 [10:44<14:33,  1.60it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 922/2320 [10:45<14:44,  1.58it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 923/2320 [10:46<14:54,  1.56it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 924/2320 [10:46<14:58,  1.55it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 925/2320 [10:47<15:00,  1.55it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 926/2320 [10:48<14:57,  1.55it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 927/2320 [10:48<14:43,  1.58it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [10:49<13:20,  1.74it/s]{'eval_loss': 1.2604074478149414, 'eval_precision': 0.9386001676445934, 'eval_recall': 0.662475965093921, 'eval_f1': 0.7767276510881818, 'eval_report': {'PAGE_HEADER': {'precision': 0.14218009478672985, 'recall': 0.6122448979591837, 'f1-score': 0.23076923076923078, 'support': 49.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7.0}, 'RECIPE_TITLE': {'precision': 0.08270676691729323, 'recall': 0.9166666666666666, 'f1-score': 0.15172413793103448, 'support': 12.0}, 'INGREDIENT_LINE': {'precision': 0.7192982456140351, 'recall': 0.7175, 'f1-score': 0.718397997496871, 'support': 3600.0}, 'INSTRUCTION_STEP': {'precision': 0.6499649614576034, 'recall': 0.5997413514387326, 'f1-score': 0.6238439549352615, 'support': 3093.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8646570495372891, 'recall': 0.8624855765967556, 'f1-score': 0.8635699480104658, 'support': 14733.0}, 'accuracy': 0.7995719735740207, 'macro avg': {'precision': 0.35125815975899294, 'recall': 0.5298054989516198, 'f1-score': 0.36975789559183764, 'support': 21494.0}, 'weighted avg': {'precision': 0.8070515923829594, 'recall': 0.7995719735740207, 'f1-score': 0.8026373206292248, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[30, 0, 1, 14, 0, 0, 4], [1, 0, 2, 0, 0, 0, 4], [0, 0, 11, 1, 0, 0, 0], [36, 1, 31, 2583, 69, 6, 874], [0, 0, 0, 131, 1855, 0, 1107], [0, 0, 0, 0, 0, 0, 0], [144, 0, 88, 862, 930, 2, 12707]], 'eval_PAGE_HEADER_precision': 0.28888888888888886, 'eval_PAGE_HEADER_recall': 0.11981566820276497, 'eval_PAGE_HEADER_f1': 0.16938110749185667, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0273972602739726, 'eval_header_title_confusion_count': 4, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14967, 'INGREDIENT_LINE': 4695, 'INSTRUCTION_STEP': 2504, 'PAGE_HEADER': 90, 'SECTION_HEADER': 7, 'RECIPE_TITLE': 17}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.8672, 'eval_samples_per_second': 13.397, 'eval_steps_per_second': 3.349, 'epoch': 7.0}
{'loss': 0.5923, 'grad_norm': 31.208431243896484, 'learning_rate': 3.5201149425287353e-05, 'epoch': 7.33}
{'loss': 0.4771, 'grad_norm': 4.427661895751953, 'learning_rate': 3.400383141762452e-05, 'epoch': 7.76}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.48it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.06it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.35it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.11it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.04it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.99it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.66it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.62it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.62it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.59it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.53it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.47it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.50it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.56it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.55it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.59it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.65it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.60it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.65it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.63it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.95it/s][A                                                  
                                               [A 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [10:55<13:20,  1.74it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.95it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 929/2320 [10:59<1:20:14,  3.46s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 930/2320 [10:59<1:00:04,  2.59s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 931/2320 [11:00<46:04,  1.99s/it]   40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 932/2320 [11:01<36:11,  1.56s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 933/2320 [11:01<29:21,  1.27s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 934/2320 [11:02<24:48,  1.07s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 935/2320 [11:02<21:25,  1.08it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 936/2320 [11:03<18:58,  1.22it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 937/2320 [11:04<17:49,  1.29it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 938/2320 [11:04<16:56,  1.36it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 939/2320 [11:05<16:19,  1.41it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 940/2320 [11:06<15:50,  1.45it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 941/2320 [11:06<15:12,  1.51it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 942/2320 [11:07<14:40,  1.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 943/2320 [11:07<14:33,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 944/2320 [11:08<14:22,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 945/2320 [11:09<14:19,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 946/2320 [11:09<14:12,  1.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 947/2320 [11:10<14:01,  1.63it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 948/2320 [11:10<14:10,  1.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 949/2320 [11:11<14:14,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [11:12<14:15,  1.60it/s]                                                   41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [11:12<14:15,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 951/2320 [11:12<14:22,  1.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 952/2320 [11:13<14:32,  1.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 953/2320 [11:14<14:41,  1.55it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 954/2320 [11:14<14:45,  1.54it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 955/2320 [11:15<14:37,  1.56it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 956/2320 [11:16<14:20,  1.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 957/2320 [11:16<14:23,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 958/2320 [11:17<14:19,  1.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 959/2320 [11:18<14:26,  1.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 960/2320 [11:18<14:26,  1.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 961/2320 [11:19<14:27,  1.57it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 962/2320 [11:19<14:28,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 963/2320 [11:20<14:31,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 964/2320 [11:21<14:31,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 965/2320 [11:21<14:37,  1.54it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 966/2320 [11:22<14:33,  1.55it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 967/2320 [11:23<14:30,  1.55it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 968/2320 [11:23<14:27,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 969/2320 [11:24<14:28,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 970/2320 [11:25<14:07,  1.59it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 971/2320 [11:25<14:15,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 972/2320 [11:26<13:55,  1.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 973/2320 [11:26<13:47,  1.63it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 974/2320 [11:27<13:59,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 975/2320 [11:28<14:10,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 976/2320 [11:28<14:18,  1.57it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 977/2320 [11:29<14:20,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 978/2320 [11:30<14:20,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 979/2320 [11:30<14:22,  1.55it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 980/2320 [11:31<14:17,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 981/2320 [11:31<13:53,  1.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 982/2320 [11:32<13:57,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 983/2320 [11:33<15:08,  1.47it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 984/2320 [11:34<14:54,  1.49it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 985/2320 [11:34<14:25,  1.54it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 986/2320 [11:35<14:19,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 987/2320 [11:35<13:51,  1.60it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 988/2320 [11:36<13:58,  1.59it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 989/2320 [11:37<13:57,  1.59it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 990/2320 [11:37<13:42,  1.62it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 991/2320 [11:38<13:47,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 992/2320 [11:38<13:51,  1.60it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 993/2320 [11:39<13:32,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 994/2320 [11:40<13:30,  1.64it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 995/2320 [11:40<13:42,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 996/2320 [11:41<13:32,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 997/2320 [11:42<13:42,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 998/2320 [11:42<13:23,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 999/2320 [11:43<13:31,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [11:43<13:26,  1.64it/s]                                                    43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [11:43<13:26,  1.64it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1001/2320 [11:44<13:32,  1.62it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1002/2320 [11:45<13:39,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1003/2320 [11:45<13:26,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1004/2320 [11:46<13:35,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1005/2320 [11:46<13:21,  1.64it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1006/2320 [11:47<13:31,  1.62it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1007/2320 [11:48<13:41,  1.60it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1008/2320 [11:48<13:29,  1.62it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1009/2320 [11:49<13:29,  1.62it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1010/2320 [11:50<13:45,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1011/2320 [11:50<13:51,  1.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1012/2320 [11:51<14:00,  1.56it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1013/2320 [11:52<14:10,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1014/2320 [11:52<14:08,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1015/2320 [11:53<14:09,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1016/2320 [11:54<14:06,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1017/2320 [11:54<14:04,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1018/2320 [11:55<14:07,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1019/2320 [11:55<14:03,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1020/2320 [11:56<13:49,  1.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1021/2320 [11:57<13:46,  1.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1022/2320 [11:57<13:35,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1023/2320 [11:58<13:28,  1.60it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1024/2320 [11:59<13:24,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1025/2320 [11:59<13:11,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1026/2320 [12:00<13:22,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1027/2320 [12:00<13:09,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1028/2320 [12:01<13:14,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1029/2320 [12:02<13:30,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1030/2320 [12:02<13:23,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1031/2320 [12:03<13:31,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1032/2320 [12:04<13:33,  1.58it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1033/2320 [12:04<13:32,  1.58it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1034/2320 [12:05<13:35,  1.58it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1035/2320 [12:05<13:38,  1.57it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1036/2320 [12:06<13:40,  1.57it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1037/2320 [12:07<13:29,  1.59it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1038/2320 [12:07<13:33,  1.58it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1039/2320 [12:08<13:16,  1.61it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1040/2320 [12:09<13:20,  1.60it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1041/2320 [12:09<13:17,  1.60it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1042/2320 [12:10<13:27,  1.58it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1043/2320 [12:10<13:07,  1.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [12:11<11:57,  1.78it/s]{'eval_loss': 1.0805350542068481, 'eval_precision': 0.920416511714392, 'eval_recall': 0.5592588408089482, 'eval_f1': 0.6957621758380772, 'eval_report': {'PAGE_HEADER': {'precision': 0.7251184834123223, 'recall': 0.34075723830734966, 'f1-score': 0.4636363636363636, 'support': 449.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8.0}, 'RECIPE_TITLE': {'precision': 0.7443609022556391, 'recall': 0.23294117647058823, 'f1-score': 0.3548387096774194, 'support': 425.0}, 'INGREDIENT_LINE': {'precision': 0.7822333611807296, 'recall': 0.6537118920176868, 'f1-score': 0.7122210953346856, 'support': 4297.0}, 'INSTRUCTION_STEP': {'precision': 0.6618780658724597, 'recall': 0.5151349877283883, 'f1-score': 0.5793589940193222, 'support': 3667.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7636771910724006, 'recall': 0.8876848849165546, 'f1-score': 0.821024909469988, 'support': 12643.0}, 'accuracy': 0.7524425421047735, 'macro avg': {'precision': 0.4596585004741939, 'recall': 0.3287787724300709, 'f1-score': 0.3663850090172224, 'support': 21494.0}, 'weighted avg': {'precision': 0.7483700534933956, 'recall': 0.7524425421047735, 'f1-score': 0.7408635241014556, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[153, 0, 11, 20, 32, 0, 4, 229], [0, 0, 1, 0, 0, 0, 0, 7], [19, 0, 99, 25, 41, 0, 3, 238], [34, 1, 22, 2809, 93, 0, 1, 1337], [0, 0, 0, 121, 1889, 0, 0, 1657], [0, 0, 0, 0, 0, 0, 0, 5], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 616, 799, 0, 0, 11223]], 'eval_PAGE_HEADER_precision': 0.2084130019120459, 'eval_PAGE_HEADER_recall': 0.5023041474654378, 'eval_PAGE_HEADER_f1': 0.2945945945945946, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09, 'eval_RECIPE_TITLE_recall': 0.2535211267605634, 'eval_RECIPE_TITLE_f1': 0.13284132841328414, 'eval_header_false_positive_rate': 0.12365591397849462, 'eval_title_false_negative_rate': 0.2088888888888889, 'eval_header_title_confusion_count': 93, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13308, 'INGREDIENT_LINE': 5083, 'INSTRUCTION_STEP': 2940, 'PAGE_HEADER': 523, 'RECIPE_TITLE': 400, 'SECTION_HEADER': 19, 'TEMP': 7}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.717, 'eval_samples_per_second': 13.697, 'eval_steps_per_second': 3.424, 'epoch': 8.0}
{'loss': 0.3416, 'grad_norm': 6.06057596206665, 'learning_rate': 3.2806513409961684e-05, 'epoch': 8.19}
{'loss': 0.3188, 'grad_norm': 2.9165523052215576, 'learning_rate': 3.160919540229885e-05, 'epoch': 8.62}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.35it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.14it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.41it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.12it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.09it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.99it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.83it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.76it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.70it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.74it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.70it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.65it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.66it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.67it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.61it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.56it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.56it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.55it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.50it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.53it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.54it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.86it/s][A                                                   
                                               [A 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [12:18<11:57,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.86it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1045/2320 [12:21<1:12:57,  3.43s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1046/2320 [12:22<54:40,  2.57s/it]   45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1047/2320 [12:22<41:50,  1.97s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1048/2320 [12:23<32:55,  1.55s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1049/2320 [12:23<27:00,  1.27s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [12:24<22:45,  1.07s/it]                                                    45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [12:24<22:45,  1.07s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1051/2320 [12:25<19:34,  1.08it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1052/2320 [12:25<17:56,  1.18it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1053/2320 [12:26<16:39,  1.27it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1054/2320 [12:26<15:44,  1.34it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1055/2320 [12:27<14:58,  1.41it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1056/2320 [12:28<14:16,  1.48it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1057/2320 [12:28<14:02,  1.50it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1058/2320 [12:29<13:55,  1.51it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1059/2320 [12:30<13:54,  1.51it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1060/2320 [12:30<13:40,  1.54it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1061/2320 [12:31<13:29,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1062/2320 [12:32<13:29,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1063/2320 [12:32<13:26,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1064/2320 [12:33<13:20,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1065/2320 [12:33<13:18,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1066/2320 [12:34<13:18,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1067/2320 [12:35<13:22,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1068/2320 [12:35<13:29,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1069/2320 [12:36<13:29,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1070/2320 [12:37<13:28,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1071/2320 [12:37<13:23,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1072/2320 [12:38<13:23,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1073/2320 [12:39<13:28,  1.54it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1074/2320 [12:39<13:29,  1.54it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1075/2320 [12:40<13:34,  1.53it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1076/2320 [12:41<13:28,  1.54it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1077/2320 [12:41<13:19,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1078/2320 [12:42<13:20,  1.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1079/2320 [12:43<13:31,  1.53it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1080/2320 [12:43<13:31,  1.53it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1081/2320 [12:44<13:25,  1.54it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1082/2320 [12:45<13:27,  1.53it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1083/2320 [12:45<13:24,  1.54it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1084/2320 [12:46<13:24,  1.54it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1085/2320 [12:46<13:19,  1.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1086/2320 [12:47<13:16,  1.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1087/2320 [12:48<13:07,  1.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1088/2320 [12:48<12:53,  1.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1089/2320 [12:49<12:43,  1.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1090/2320 [12:50<12:46,  1.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1091/2320 [12:50<12:52,  1.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1092/2320 [12:51<12:53,  1.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1093/2320 [12:51<12:58,  1.58it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1094/2320 [12:52<13:05,  1.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1095/2320 [12:53<13:01,  1.57it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1096/2320 [12:53<13:13,  1.54it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1097/2320 [12:54<13:09,  1.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1098/2320 [12:55<12:49,  1.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1099/2320 [12:55<12:37,  1.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [12:56<12:40,  1.60it/s]                                                    47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [12:56<12:40,  1.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1101/2320 [12:57<12:44,  1.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1102/2320 [12:57<12:22,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1103/2320 [12:58<12:37,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1104/2320 [12:58<12:26,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1105/2320 [12:59<12:22,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1106/2320 [13:00<12:35,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1107/2320 [13:00<12:30,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1108/2320 [13:01<12:16,  1.65it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1109/2320 [13:01<12:31,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1110/2320 [13:02<12:23,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1111/2320 [13:03<12:14,  1.65it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1112/2320 [13:03<12:31,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1113/2320 [13:04<12:21,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1114/2320 [13:04<12:09,  1.65it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1115/2320 [13:05<12:18,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1116/2320 [13:06<12:23,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1117/2320 [13:06<12:24,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1118/2320 [13:07<12:17,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1119/2320 [13:08<12:20,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1120/2320 [13:08<12:24,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1121/2320 [13:09<12:34,  1.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1122/2320 [13:09<12:36,  1.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1123/2320 [13:10<12:39,  1.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1124/2320 [13:11<12:42,  1.57it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1125/2320 [13:11<12:48,  1.56it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1126/2320 [13:12<12:51,  1.55it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1127/2320 [13:13<12:34,  1.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1128/2320 [13:13<13:29,  1.47it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1129/2320 [13:14<13:19,  1.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1130/2320 [13:15<13:17,  1.49it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1131/2320 [13:15<13:07,  1.51it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1132/2320 [13:16<13:03,  1.52it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1133/2320 [13:17<13:00,  1.52it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1134/2320 [13:17<12:51,  1.54it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1135/2320 [13:18<12:53,  1.53it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1136/2320 [13:19<12:29,  1.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1137/2320 [13:19<12:13,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1138/2320 [13:20<12:18,  1.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1139/2320 [13:20<12:10,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1140/2320 [13:21<12:14,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1141/2320 [13:22<12:16,  1.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1142/2320 [13:22<12:16,  1.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1143/2320 [13:23<12:00,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1144/2320 [13:24<11:53,  1.65it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1145/2320 [13:24<12:03,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1146/2320 [13:25<12:13,  1.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1147/2320 [13:25<12:18,  1.59it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1148/2320 [13:26<12:22,  1.58it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1149/2320 [13:27<12:22,  1.58it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [13:27<12:25,  1.57it/s]                                                    50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [13:27<12:25,  1.57it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1151/2320 [13:28<12:29,  1.56it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1152/2320 [13:29<12:31,  1.55it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1153/2320 [13:29<12:28,  1.56it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1154/2320 [13:30<12:11,  1.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1155/2320 [13:31<12:13,  1.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1156/2320 [13:31<11:56,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1157/2320 [13:32<12:04,  1.61it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1158/2320 [13:32<11:51,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1159/2320 [13:33<11:50,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [13:33<10:50,  1.78it/s]{'eval_loss': 1.070550799369812, 'eval_precision': 0.915083135391924, 'eval_recall': 0.6496627318718381, 'eval_f1': 0.7598619329388561, 'eval_report': {'PAGE_HEADER': {'precision': 0.7440758293838863, 'recall': 0.4186666666666667, 'f1-score': 0.5358361774744027, 'support': 375.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.8421052631578947, 'recall': 0.32463768115942027, 'f1-score': 0.4686192468619247, 'support': 345.0}, 'INGREDIENT_LINE': {'precision': 0.7095516569200779, 'recall': 0.7500735943479541, 'f1-score': 0.7292501431024614, 'support': 3397.0}, 'INSTRUCTION_STEP': {'precision': 0.6327960756832516, 'recall': 0.6093117408906883, 'f1-score': 0.6208319009969061, 'support': 2964.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 29.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.859553620032662, 'recall': 0.8785644735011824, 'f1-score': 0.8689550801403315, 'support': 14378.0}, 'accuracy': 0.8027821717688657, 'macro avg': {'precision': 0.4735103056472216, 'recall': 0.372656769570739, 'f1-score': 0.40293656857200333, 'support': 21494.0}, 'weighted avg': {'precision': 0.8008826299209412, 'recall': 0.8027821717688657, 'f1-score': 0.7990070177562036, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[157, 0, 6, 39, 37, 0, 4, 132], [0, 0, 0, 0, 0, 0, 0, 6], [19, 0, 112, 60, 36, 0, 3, 115], [30, 1, 15, 2548, 65, 0, 1, 737], [0, 0, 0, 113, 1806, 0, 0, 1045], [0, 0, 0, 0, 0, 0, 0, 29], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 831, 910, 0, 0, 12632]], 'eval_PAGE_HEADER_precision': 0.2401656314699793, 'eval_PAGE_HEADER_recall': 0.5345622119815668, 'eval_PAGE_HEADER_f1': 0.33142857142857146, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.11590296495956873, 'eval_RECIPE_TITLE_recall': 0.3028169014084507, 'eval_RECIPE_TITLE_f1': 0.16764132553606237, 'eval_header_false_positive_rate': 0.12368421052631579, 'eval_title_false_negative_rate': 0.2025862068965517, 'eval_header_title_confusion_count': 94, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14763, 'INGREDIENT_LINE': 4154, 'INSTRUCTION_STEP': 2460, 'PAGE_HEADER': 483, 'RECIPE_TITLE': 371, 'SECTION_HEADER': 16, 'TEMP': 33}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6796, 'eval_samples_per_second': 13.773, 'eval_steps_per_second': 3.443, 'epoch': 9.0}
{'loss': 0.3076, 'grad_norm': 5.242053985595703, 'learning_rate': 3.0411877394636018e-05, 'epoch': 9.05}
{'loss': 0.3138, 'grad_norm': 2.122845411300659, 'learning_rate': 2.9214559386973183e-05, 'epoch': 9.48}
{'loss': 0.2412, 'grad_norm': 14.508929252624512, 'learning_rate': 2.8017241379310345e-05, 'epoch': 9.91}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.62it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.35it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.62it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.16it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.07it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:03,  4.09it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.82it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.76it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.79it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.70it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.75it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.64it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.62it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.68it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.78it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.74it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.72it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.79it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.78it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.74it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.77it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.17it/s][A                                                   
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [13:40<10:50,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.17it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1161/2320 [13:44<1:06:40,  3.45s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1162/2320 [13:44<50:02,  2.59s/it]   50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1163/2320 [13:45<38:22,  1.99s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1164/2320 [13:45<30:16,  1.57s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1165/2320 [13:46<24:37,  1.28s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1166/2320 [13:47<20:46,  1.08s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1167/2320 [13:47<17:58,  1.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1168/2320 [13:48<16:15,  1.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1169/2320 [13:48<15:03,  1.27it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1170/2320 [13:49<14:17,  1.34it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1171/2320 [13:50<13:39,  1.40it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1172/2320 [13:50<13:22,  1.43it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1173/2320 [13:51<13:15,  1.44it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1174/2320 [13:52<12:53,  1.48it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1175/2320 [13:52<12:45,  1.50it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1176/2320 [13:53<12:36,  1.51it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1177/2320 [13:54<12:22,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1178/2320 [13:54<12:17,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1179/2320 [13:55<12:16,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1180/2320 [13:56<12:14,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1181/2320 [13:56<12:15,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1182/2320 [13:57<12:10,  1.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1183/2320 [13:57<12:11,  1.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1184/2320 [13:58<12:08,  1.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1185/2320 [13:59<12:09,  1.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1186/2320 [13:59<12:14,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1187/2320 [14:00<12:11,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1188/2320 [14:01<12:18,  1.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1189/2320 [14:01<12:14,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1190/2320 [14:02<12:16,  1.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1191/2320 [14:03<12:09,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1192/2320 [14:03<11:50,  1.59it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1193/2320 [14:04<11:41,  1.61it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1194/2320 [14:05<11:47,  1.59it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1195/2320 [14:05<11:44,  1.60it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1196/2320 [14:06<11:29,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1197/2320 [14:06<11:38,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1198/2320 [14:07<11:37,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1199/2320 [14:08<11:36,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [14:08<11:29,  1.62it/s]                                                    52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [14:08<11:29,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1201/2320 [14:09<11:21,  1.64it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1202/2320 [14:09<11:32,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1203/2320 [14:10<11:46,  1.58it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1204/2320 [14:11<11:49,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1205/2320 [14:11<11:52,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1206/2320 [14:12<11:56,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1207/2320 [14:13<11:50,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1208/2320 [14:13<11:57,  1.55it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1209/2320 [14:14<12:11,  1.52it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1210/2320 [14:15<12:01,  1.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1211/2320 [14:15<12:00,  1.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1212/2320 [14:16<11:59,  1.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1213/2320 [14:17<12:11,  1.51it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1214/2320 [14:17<12:01,  1.53it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1215/2320 [14:18<11:59,  1.53it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1216/2320 [14:19<11:58,  1.54it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1217/2320 [14:19<12:03,  1.52it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1218/2320 [14:20<11:57,  1.54it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1219/2320 [14:20<11:40,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1220/2320 [14:21<11:41,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1221/2320 [14:22<11:30,  1.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1222/2320 [14:22<11:19,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1223/2320 [14:23<11:07,  1.64it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1224/2320 [14:24<11:23,  1.60it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1225/2320 [14:24<11:38,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1226/2320 [14:25<11:38,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1227/2320 [14:26<11:44,  1.55it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1228/2320 [14:26<11:48,  1.54it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1229/2320 [14:27<11:35,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1230/2320 [14:27<11:38,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1231/2320 [14:28<11:24,  1.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1232/2320 [14:29<11:12,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1233/2320 [14:29<11:21,  1.60it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1234/2320 [14:30<11:10,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1235/2320 [14:31<11:12,  1.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1236/2320 [14:31<11:17,  1.60it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1237/2320 [14:32<11:23,  1.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1238/2320 [14:32<11:24,  1.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1239/2320 [14:33<11:30,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1240/2320 [14:34<11:38,  1.55it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1241/2320 [14:34<11:41,  1.54it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1242/2320 [14:35<11:23,  1.58it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1243/2320 [14:36<11:24,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1244/2320 [14:36<11:07,  1.61it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1245/2320 [14:37<11:12,  1.60it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1246/2320 [14:37<11:07,  1.61it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1247/2320 [14:38<11:13,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1248/2320 [14:39<11:20,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1249/2320 [14:39<11:26,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [14:40<11:22,  1.57it/s]                                                    54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [14:40<11:22,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1251/2320 [14:41<11:18,  1.58it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1252/2320 [14:41<11:24,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1253/2320 [14:42<11:22,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1254/2320 [14:43<11:10,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1255/2320 [14:43<11:10,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1256/2320 [14:44<11:04,  1.60it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1257/2320 [14:44<10:55,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1258/2320 [14:45<11:04,  1.60it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1259/2320 [14:46<11:17,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1260/2320 [14:46<11:15,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1261/2320 [14:47<11:17,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1262/2320 [14:48<11:13,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1263/2320 [14:48<11:19,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1264/2320 [14:49<11:22,  1.55it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1265/2320 [14:50<11:09,  1.57it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1266/2320 [14:50<10:54,  1.61it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1267/2320 [14:51<10:54,  1.61it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1268/2320 [14:51<10:58,  1.60it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1269/2320 [14:52<10:52,  1.61it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1270/2320 [14:53<10:45,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1271/2320 [14:53<10:39,  1.64it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1272/2320 [14:54<10:48,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1273/2320 [14:54<10:48,  1.61it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1274/2320 [14:55<10:45,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1275/2320 [14:56<10:46,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [14:56<09:49,  1.77it/s]{'eval_loss': 1.3677889108657837, 'eval_precision': 0.9246290801186944, 'eval_recall': 0.6124213836477987, 'eval_f1': 0.7368172144715063, 'eval_report': {'PAGE_HEADER': {'precision': 0.7582938388625592, 'recall': 0.33472803347280333, 'f1-score': 0.4644412191582003, 'support': 478.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.7819548872180451, 'recall': 0.2639593908629442, 'f1-score': 0.3946869070208729, 'support': 394.0}, 'INGREDIENT_LINE': {'precision': 0.7357282094124199, 'recall': 0.6429788269651984, 'f1-score': 0.6862337662337662, 'support': 4109.0}, 'INSTRUCTION_STEP': {'precision': 0.6194814295725298, 'recall': 0.6712224753227031, 'f1-score': 0.6443148688046647, 'support': 2634.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8246461622210125, 'recall': 0.8742605684605396, 'f1-score': 0.8487289025842146, 'support': 13862.0}, 'accuracy': 0.7812878012468596, 'macro avg': {'precision': 0.4650130659108208, 'recall': 0.34839366188552356, 'f1-score': 0.3798007079752148, 'support': 21494.0}, 'weighted avg': {'precision': 0.7795952860899584, 'recall': 0.7812878012468596, 'f1-score': 0.7750744161920656, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[160, 0, 5, 39, 36, 0, 4, 234], [0, 0, 0, 0, 0, 0, 0, 6], [15, 0, 104, 21, 32, 0, 3, 219], [31, 1, 24, 2642, 94, 0, 1, 1316], [0, 0, 0, 75, 1768, 0, 0, 791], [0, 0, 0, 0, 0, 0, 0, 11], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 814, 924, 0, 0, 12119]], 'eval_PAGE_HEADER_precision': 0.19593345656192238, 'eval_PAGE_HEADER_recall': 0.48847926267281105, 'eval_PAGE_HEADER_f1': 0.2796833773087071, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09895833333333333, 'eval_RECIPE_TITLE_recall': 0.2676056338028169, 'eval_RECIPE_TITLE_f1': 0.14448669201520914, 'eval_header_false_positive_rate': 0.13636363636363635, 'eval_title_false_negative_rate': 0.20704845814977973, 'eval_header_title_confusion_count': 98, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14298, 'INGREDIENT_LINE': 4817, 'INSTRUCTION_STEP': 2212, 'RECIPE_TITLE': 384, 'PAGE_HEADER': 541, 'SECTION_HEADER': 15, 'TEMP': 13}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.4932, 'eval_samples_per_second': 14.169, 'eval_steps_per_second': 3.542, 'epoch': 10.0}
{'loss': 0.244, 'grad_norm': 5.012509346008301, 'learning_rate': 2.681992337164751e-05, 'epoch': 10.34}
{'loss': 0.1951, 'grad_norm': 1.8403674364089966, 'learning_rate': 2.5622605363984675e-05, 'epoch': 10.78}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.35it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.22it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.42it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.11it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.10it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  4.00it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.87it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.68it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.67it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.68it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.70it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.64it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.73it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.73it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.75it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.24it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.39it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.51it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.48it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.60it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.93it/s][A                                                   
                                               [A 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [15:03<09:49,  1.77it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.93it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1277/2320 [15:06<1:00:00,  3.45s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1278/2320 [15:07<45:01,  2.59s/it]   55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1279/2320 [15:08<34:34,  1.99s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1280/2320 [15:08<27:26,  1.58s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1281/2320 [15:09<22:30,  1.30s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1282/2320 [15:09<19:13,  1.11s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1283/2320 [15:10<16:41,  1.04it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1284/2320 [15:11<14:53,  1.16it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1285/2320 [15:11<13:43,  1.26it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1286/2320 [15:12<12:47,  1.35it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1287/2320 [15:13<12:10,  1.41it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1288/2320 [15:13<11:48,  1.46it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1289/2320 [15:14<11:38,  1.48it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1290/2320 [15:15<11:28,  1.50it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1291/2320 [15:15<11:24,  1.50it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1292/2320 [15:16<11:18,  1.51it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1293/2320 [15:16<11:15,  1.52it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1294/2320 [15:17<11:14,  1.52it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1295/2320 [15:18<11:09,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1296/2320 [15:18<11:08,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1297/2320 [15:19<11:08,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1298/2320 [15:20<11:11,  1.52it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1299/2320 [15:20<11:12,  1.52it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [15:21<11:05,  1.53it/s]                                                    56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [15:21<11:05,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1301/2320 [15:22<11:03,  1.54it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1302/2320 [15:22<10:57,  1.55it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1303/2320 [15:23<10:57,  1.55it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1304/2320 [15:24<10:54,  1.55it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1305/2320 [15:24<11:03,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1306/2320 [15:25<10:57,  1.54it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1307/2320 [15:26<10:58,  1.54it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1308/2320 [15:26<10:43,  1.57it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1309/2320 [15:27<10:42,  1.57it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1310/2320 [15:27<10:30,  1.60it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1311/2320 [15:28<10:35,  1.59it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1312/2320 [15:29<10:23,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1313/2320 [15:29<10:23,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1314/2320 [15:30<10:22,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1315/2320 [15:31<10:23,  1.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1316/2320 [15:31<10:10,  1.64it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1317/2320 [15:32<10:16,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1318/2320 [15:32<10:21,  1.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1319/2320 [15:33<10:15,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1320/2320 [15:34<10:09,  1.64it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1321/2320 [15:34<10:07,  1.64it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1322/2320 [15:35<10:24,  1.60it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1323/2320 [15:35<10:29,  1.58it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1324/2320 [15:36<10:30,  1.58it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1325/2320 [15:37<10:34,  1.57it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1326/2320 [15:37<10:35,  1.56it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1327/2320 [15:38<10:41,  1.55it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1328/2320 [15:39<10:30,  1.57it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1329/2320 [15:39<10:30,  1.57it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1330/2320 [15:40<10:18,  1.60it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1331/2320 [15:41<10:20,  1.59it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1332/2320 [15:41<10:04,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1333/2320 [15:42<10:14,  1.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1334/2320 [15:42<10:09,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1335/2320 [15:43<10:03,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1336/2320 [15:44<10:08,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1337/2320 [15:44<10:04,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1338/2320 [15:45<10:08,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1339/2320 [15:45<10:00,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1340/2320 [15:46<10:06,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1341/2320 [15:47<09:59,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1342/2320 [15:47<10:03,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1343/2320 [15:48<10:07,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1344/2320 [15:49<10:17,  1.58it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1345/2320 [15:49<10:18,  1.58it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1346/2320 [15:50<10:26,  1.56it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1347/2320 [15:51<10:29,  1.54it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1348/2320 [15:51<10:30,  1.54it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1349/2320 [15:52<10:12,  1.59it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [15:52<10:08,  1.59it/s]                                                    58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [15:52<10:08,  1.59it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1351/2320 [15:53<10:10,  1.59it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1352/2320 [15:54<10:00,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1353/2320 [15:54<09:56,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1354/2320 [15:55<10:00,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1355/2320 [15:56<10:10,  1.58it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1356/2320 [15:56<10:13,  1.57it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1357/2320 [15:57<10:16,  1.56it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1358/2320 [15:57<10:14,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1359/2320 [15:58<10:15,  1.56it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1360/2320 [15:59<10:14,  1.56it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1361/2320 [15:59<10:05,  1.58it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1362/2320 [16:00<10:09,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1363/2320 [16:01<09:56,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1364/2320 [16:01<09:54,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1365/2320 [16:02<09:52,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1366/2320 [16:03<10:03,  1.58it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1367/2320 [16:03<10:06,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1368/2320 [16:04<10:06,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1369/2320 [16:04<10:07,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1370/2320 [16:05<10:13,  1.55it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1371/2320 [16:06<10:14,  1.54it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1372/2320 [16:06<10:04,  1.57it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1373/2320 [16:07<09:46,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1374/2320 [16:08<09:54,  1.59it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1375/2320 [16:08<09:40,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1376/2320 [16:09<09:46,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1377/2320 [16:09<09:39,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1378/2320 [16:10<09:46,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1379/2320 [16:11<09:53,  1.58it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1380/2320 [16:11<09:59,  1.57it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1381/2320 [16:12<10:00,  1.56it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1382/2320 [16:13<10:05,  1.55it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1383/2320 [16:13<10:06,  1.55it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1384/2320 [16:14<09:50,  1.59it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1385/2320 [16:15<09:57,  1.57it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1386/2320 [16:15<09:46,  1.59it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1387/2320 [16:16<09:40,  1.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1388/2320 [16:16<09:33,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1389/2320 [16:17<09:39,  1.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1390/2320 [16:18<09:35,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1391/2320 [16:18<09:33,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [16:19<08:42,  1.78it/s]{'eval_loss': 1.2297680377960205, 'eval_precision': 0.9239283558059972, 'eval_recall': 0.7104611575363664, 'eval_f1': 0.8032543084594523, 'eval_report': {'PAGE_HEADER': {'precision': 0.4218009478672986, 'recall': 0.6793893129770993, 'f1-score': 0.52046783625731, 'support': 131.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7.0}, 'RECIPE_TITLE': {'precision': 0.45112781954887216, 'recall': 0.6666666666666666, 'f1-score': 0.5381165919282511, 'support': 90.0}, 'INGREDIENT_LINE': {'precision': 0.7218045112781954, 'recall': 0.7744248580818643, 'f1-score': 0.7471893917555491, 'support': 3347.0}, 'INSTRUCTION_STEP': {'precision': 0.6482130343377716, 'recall': 0.6408036023553862, 'f1-score': 0.6444870231666957, 'support': 2887.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8984077299945563, 'recall': 0.878326237360298, 'f1-score': 0.8882534983853606, 'support': 15032.0}, 'accuracy': 0.8278589373778729, 'macro avg': {'precision': 0.4487648632895277, 'recall': 0.5199443824916165, 'f1-score': 0.4769306202133095, 'support': 21494.0}, 'weighted avg': {'precision': 0.8322319323806389, 'recall': 0.8278589373778729, 'f1-score': 0.8295484924927916, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[89, 0, 5, 21, 12, 2, 2], [1, 0, 0, 0, 0, 0, 6], [5, 0, 60, 15, 10, 0, 0], [33, 1, 31, 2592, 86, 6, 598], [6, 0, 1, 143, 1850, 0, 887], [0, 0, 0, 0, 0, 0, 0], [77, 0, 36, 820, 896, 0, 13203]], 'eval_PAGE_HEADER_precision': 0.28350515463917525, 'eval_PAGE_HEADER_recall': 0.2534562211981567, 'eval_PAGE_HEADER_f1': 0.26763990267639903, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.14655172413793102, 'eval_RECIPE_TITLE_recall': 0.11971830985915492, 'eval_RECIPE_TITLE_f1': 0.1317829457364341, 'eval_header_false_positive_rate': 0.06206896551724138, 'eval_title_false_negative_rate': 0.11666666666666667, 'eval_header_title_confusion_count': 39, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15236, 'INGREDIENT_LINE': 4286, 'INSTRUCTION_STEP': 2435, 'PAGE_HEADER': 194, 'RECIPE_TITLE': 116, 'SECTION_HEADER': 13}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6875, 'eval_samples_per_second': 13.757, 'eval_steps_per_second': 3.439, 'epoch': 11.0}
{'loss': 0.1992, 'grad_norm': 4.840021133422852, 'learning_rate': 2.442528735632184e-05, 'epoch': 11.21}
{'loss': 0.1525, 'grad_norm': 3.8475394248962402, 'learning_rate': 2.3227969348659002e-05, 'epoch': 11.64}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.60it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.39it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.50it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.23it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.04it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.93it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.80it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.77it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.85it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.76it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.73it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.62it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.63it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.71it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.72it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.69it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.68it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.72it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.63it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.69it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.00it/s][A                                                   
                                               [A 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [16:25<08:42,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.00it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1393/2320 [16:29<52:24,  3.39s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1394/2320 [16:29<39:17,  2.55s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1395/2320 [16:30<30:12,  1.96s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1396/2320 [16:30<23:56,  1.55s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1397/2320 [16:31<19:31,  1.27s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1398/2320 [16:32<16:31,  1.08s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1399/2320 [16:32<14:27,  1.06it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [16:33<13:05,  1.17it/s]                                                    60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [16:33<13:05,  1.17it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1401/2320 [16:34<12:06,  1.26it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1402/2320 [16:34<11:23,  1.34it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1403/2320 [16:35<10:59,  1.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1404/2320 [16:36<10:34,  1.44it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1405/2320 [16:36<10:19,  1.48it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1406/2320 [16:37<10:05,  1.51it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1407/2320 [16:38<10:48,  1.41it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1408/2320 [16:38<10:28,  1.45it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1409/2320 [16:39<10:13,  1.48it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1410/2320 [16:40<10:03,  1.51it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1411/2320 [16:40<09:56,  1.52it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1412/2320 [16:41<09:53,  1.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1413/2320 [16:41<09:51,  1.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1414/2320 [16:42<09:49,  1.54it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1415/2320 [16:43<09:46,  1.54it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1416/2320 [16:43<09:44,  1.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1417/2320 [16:44<09:32,  1.58it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1418/2320 [16:45<09:34,  1.57it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1419/2320 [16:45<09:42,  1.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1420/2320 [16:46<09:42,  1.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1421/2320 [16:47<09:41,  1.55it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1422/2320 [16:47<09:42,  1.54it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1423/2320 [16:48<09:43,  1.54it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1424/2320 [16:49<09:44,  1.53it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1425/2320 [16:49<09:41,  1.54it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1426/2320 [16:50<09:44,  1.53it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1427/2320 [16:51<09:45,  1.53it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1428/2320 [16:51<09:45,  1.52it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1429/2320 [16:52<09:38,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1430/2320 [16:52<09:26,  1.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1431/2320 [16:53<09:31,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1432/2320 [16:54<09:32,  1.55it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1433/2320 [16:54<09:29,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1434/2320 [16:55<09:29,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1435/2320 [16:56<09:27,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1436/2320 [16:56<09:27,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1437/2320 [16:57<09:26,  1.56it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1438/2320 [16:58<09:32,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1439/2320 [16:58<09:32,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1440/2320 [16:59<09:44,  1.51it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1441/2320 [17:00<09:41,  1.51it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1442/2320 [17:00<09:36,  1.52it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1443/2320 [17:01<09:33,  1.53it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1444/2320 [17:02<09:29,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1445/2320 [17:02<09:32,  1.53it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1446/2320 [17:03<09:27,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1447/2320 [17:03<09:27,  1.54it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1448/2320 [17:04<09:11,  1.58it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1449/2320 [17:05<09:13,  1.57it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [17:05<09:11,  1.58it/s]                                                    62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [17:05<09:11,  1.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1451/2320 [17:06<09:01,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1452/2320 [17:07<09:10,  1.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1453/2320 [17:07<09:15,  1.56it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1454/2320 [17:08<09:12,  1.57it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1455/2320 [17:09<09:17,  1.55it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1456/2320 [17:09<09:19,  1.54it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1457/2320 [17:10<09:11,  1.56it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1458/2320 [17:10<08:59,  1.60it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1459/2320 [17:11<09:01,  1.59it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1460/2320 [17:12<08:51,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1461/2320 [17:12<08:54,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1462/2320 [17:13<09:00,  1.59it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1463/2320 [17:14<09:01,  1.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1464/2320 [17:14<09:02,  1.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1465/2320 [17:15<09:03,  1.57it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1466/2320 [17:15<09:01,  1.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1467/2320 [17:16<09:04,  1.57it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1468/2320 [17:17<09:03,  1.57it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1469/2320 [17:17<09:08,  1.55it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1470/2320 [17:18<08:53,  1.59it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1471/2320 [17:19<08:51,  1.60it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1472/2320 [17:19<08:43,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1473/2320 [17:20<08:45,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1474/2320 [17:21<08:50,  1.60it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1475/2320 [17:21<08:39,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1476/2320 [17:22<08:36,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1477/2320 [17:22<08:40,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1478/2320 [17:23<08:32,  1.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1479/2320 [17:24<08:42,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1480/2320 [17:24<08:37,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1481/2320 [17:25<08:31,  1.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1482/2320 [17:25<08:37,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1483/2320 [17:26<08:36,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1484/2320 [17:27<08:35,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1485/2320 [17:27<08:29,  1.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1486/2320 [17:28<08:35,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1487/2320 [17:28<08:29,  1.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1488/2320 [17:29<08:33,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1489/2320 [17:30<08:36,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1490/2320 [17:30<08:31,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1491/2320 [17:31<08:27,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1492/2320 [17:32<08:22,  1.65it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1493/2320 [17:32<08:28,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1494/2320 [17:33<08:35,  1.60it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1495/2320 [17:33<08:23,  1.64it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1496/2320 [17:34<08:24,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1497/2320 [17:35<08:22,  1.64it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1498/2320 [17:35<08:21,  1.64it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1499/2320 [17:36<08:27,  1.62it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [17:36<08:26,  1.62it/s]                                                    65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [17:36<08:26,  1.62it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1501/2320 [17:37<08:29,  1.61it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1502/2320 [17:38<08:22,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1503/2320 [17:38<08:22,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1504/2320 [17:39<08:19,  1.64it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1505/2320 [17:40<08:21,  1.62it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1506/2320 [17:40<08:19,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1507/2320 [17:41<08:24,  1.61it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [17:41<07:40,  1.76it/s]{'eval_loss': 1.3864903450012207, 'eval_precision': 0.9199462468803993, 'eval_recall': 0.6023127199597788, 'eval_f1': 0.727990884922142, 'eval_report': {'PAGE_HEADER': {'precision': 0.7393364928909952, 'recall': 0.3561643835616438, 'f1-score': 0.48073959938366717, 'support': 438.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10.0}, 'RECIPE_TITLE': {'precision': 0.7819548872180451, 'recall': 0.26463104325699743, 'f1-score': 0.39543726235741444, 'support': 393.0}, 'INGREDIENT_LINE': {'precision': 0.758006126427179, 'recall': 0.6689604325387073, 'f1-score': 0.7107049608355092, 'support': 4069.0}, 'INSTRUCTION_STEP': {'precision': 0.6341976173791171, 'recall': 0.5961791831357048, 'f1-score': 0.6146010186757216, 'support': 3036.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8130783886771911, 'recall': 0.8826266804550155, 'f1-score': 0.8464262945384997, 'support': 13538.0}, 'accuracy': 0.7788685214478459, 'macro avg': {'precision': 0.46582168907406596, 'recall': 0.34607021536850857, 'f1-score': 0.3809886419738515, 'support': 21494.0}, 'weighted avg': {'precision': 0.7745577265874174, 'recall': 0.7788685214478459, 'f1-score': 0.7715026120051129, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[156, 0, 5, 10, 30, 0, 4, 233], [0, 0, 2, 0, 0, 0, 0, 8], [13, 0, 104, 23, 33, 0, 3, 217], [37, 1, 22, 2722, 108, 0, 1, 1178], [0, 0, 0, 125, 1810, 0, 0, 1101], [0, 0, 0, 0, 0, 0, 0, 10], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 711, 873, 0, 0, 11949]], 'eval_PAGE_HEADER_precision': 0.2150101419878296, 'eval_PAGE_HEADER_recall': 0.48847926267281105, 'eval_PAGE_HEADER_f1': 0.29859154929577464, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.10263157894736842, 'eval_RECIPE_TITLE_recall': 0.2746478873239437, 'eval_RECIPE_TITLE_f1': 0.14942528735632185, 'eval_header_false_positive_rate': 0.11506849315068493, 'eval_title_false_negative_rate': 0.19555555555555557, 'eval_header_title_confusion_count': 86, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14208, 'INGREDIENT_LINE': 4640, 'INSTRUCTION_STEP': 2526, 'PAGE_HEADER': 493, 'RECIPE_TITLE': 380, 'SECTION_HEADER': 21, 'TEMP': 12}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.5334, 'eval_samples_per_second': 14.082, 'eval_steps_per_second': 3.52, 'epoch': 12.0}
{'loss': 0.1955, 'grad_norm': 1.7243510484695435, 'learning_rate': 2.203065134099617e-05, 'epoch': 12.07}
{'loss': 0.1454, 'grad_norm': 1.203715205192566, 'learning_rate': 2.0833333333333336e-05, 'epoch': 12.5}
{'loss': 0.1425, 'grad_norm': 3.1049115657806396, 'learning_rate': 1.9636015325670498e-05, 'epoch': 12.93}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.09it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.17it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.43it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.20it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.03it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.91it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.83it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.68it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.68it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.69it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.62it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.59it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.61it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.61it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.72it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.76it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.65it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.71it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.69it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.67it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  3.98it/s][A                                                   
                                               [A 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [17:48<07:40,  1.76it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.98it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1509/2320 [17:51<46:54,  3.47s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1510/2320 [17:52<35:04,  2.60s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1511/2320 [17:53<26:50,  1.99s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1512/2320 [17:53<21:11,  1.57s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1513/2320 [17:54<17:23,  1.29s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1514/2320 [17:54<14:44,  1.10s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1515/2320 [17:55<12:51,  1.04it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1516/2320 [17:56<11:26,  1.17it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1517/2320 [17:56<10:22,  1.29it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1518/2320 [17:57<09:46,  1.37it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1519/2320 [17:58<09:11,  1.45it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1520/2320 [17:58<08:57,  1.49it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1521/2320 [17:59<08:45,  1.52it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1522/2320 [17:59<08:41,  1.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1523/2320 [18:00<08:37,  1.54it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1524/2320 [18:01<08:28,  1.57it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1525/2320 [18:01<08:32,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1526/2320 [18:02<08:31,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1527/2320 [18:03<08:32,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1528/2320 [18:03<08:31,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1529/2320 [18:04<08:29,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1530/2320 [18:05<08:28,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1531/2320 [18:05<08:30,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1532/2320 [18:06<08:28,  1.55it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1533/2320 [18:07<08:29,  1.54it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1534/2320 [18:07<08:33,  1.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1535/2320 [18:08<08:32,  1.53it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1536/2320 [18:08<08:28,  1.54it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1537/2320 [18:09<08:23,  1.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1538/2320 [18:10<08:21,  1.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1539/2320 [18:10<08:20,  1.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1540/2320 [18:11<08:19,  1.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1541/2320 [18:12<08:17,  1.56it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1542/2320 [18:12<08:21,  1.55it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1543/2320 [18:13<08:09,  1.59it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1544/2320 [18:14<08:05,  1.60it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1545/2320 [18:14<07:59,  1.62it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1546/2320 [18:15<08:00,  1.61it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1547/2320 [18:15<07:54,  1.63it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1548/2320 [18:16<07:59,  1.61it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1549/2320 [18:17<07:53,  1.63it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [18:17<08:00,  1.60it/s]                                                    67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [18:17<08:00,  1.60it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1551/2320 [18:18<08:11,  1.57it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1552/2320 [18:19<08:32,  1.50it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1553/2320 [18:19<08:30,  1.50it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1554/2320 [18:20<08:30,  1.50it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1555/2320 [18:21<08:27,  1.51it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1556/2320 [18:21<08:22,  1.52it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1557/2320 [18:22<08:18,  1.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1558/2320 [18:23<08:16,  1.54it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1559/2320 [18:23<08:12,  1.55it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1560/2320 [18:24<08:12,  1.54it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1561/2320 [18:24<08:07,  1.56it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1562/2320 [18:25<08:06,  1.56it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1563/2320 [18:26<08:08,  1.55it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1564/2320 [18:26<08:05,  1.56it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1565/2320 [18:27<08:00,  1.57it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1566/2320 [18:28<08:01,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1567/2320 [18:28<08:04,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1568/2320 [18:29<08:02,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1569/2320 [18:30<08:01,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1570/2320 [18:30<08:00,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1571/2320 [18:31<08:00,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1572/2320 [18:32<07:59,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1573/2320 [18:32<08:00,  1.56it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1574/2320 [18:33<07:47,  1.60it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1575/2320 [18:33<07:46,  1.60it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1576/2320 [18:34<07:38,  1.62it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1577/2320 [18:35<07:39,  1.62it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1578/2320 [18:35<07:42,  1.61it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1579/2320 [18:36<07:34,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1580/2320 [18:36<07:38,  1.61it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1581/2320 [18:37<07:29,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1582/2320 [18:38<07:35,  1.62it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1583/2320 [18:38<07:30,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1584/2320 [18:39<07:35,  1.62it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1585/2320 [18:40<07:30,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1586/2320 [18:40<07:31,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1587/2320 [18:41<07:31,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1588/2320 [18:41<07:26,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1589/2320 [18:42<07:37,  1.60it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1590/2320 [18:43<07:29,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1591/2320 [18:43<07:29,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1592/2320 [18:44<07:29,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1593/2320 [18:44<07:26,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1594/2320 [18:45<07:19,  1.65it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1595/2320 [18:46<07:27,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1596/2320 [18:46<07:21,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1597/2320 [18:47<07:24,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1598/2320 [18:48<07:29,  1.61it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1599/2320 [18:48<07:24,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [18:49<07:20,  1.63it/s]                                                    69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [18:49<07:20,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1601/2320 [18:49<07:25,  1.61it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1602/2320 [18:50<07:21,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1603/2320 [18:51<07:22,  1.62it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1604/2320 [18:51<07:29,  1.59it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1605/2320 [18:52<07:32,  1.58it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1606/2320 [18:53<07:33,  1.57it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1607/2320 [18:53<07:36,  1.56it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1608/2320 [18:54<07:37,  1.56it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1609/2320 [18:54<07:35,  1.56it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1610/2320 [18:55<07:29,  1.58it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1611/2320 [18:56<07:22,  1.60it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1612/2320 [18:56<07:25,  1.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1613/2320 [18:57<07:15,  1.62it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1614/2320 [18:58<07:18,  1.61it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1615/2320 [18:58<07:13,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1616/2320 [18:59<07:17,  1.61it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1617/2320 [18:59<07:11,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1618/2320 [19:00<07:12,  1.62it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1619/2320 [19:01<07:16,  1.61it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1620/2320 [19:01<07:14,  1.61it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1621/2320 [19:02<07:18,  1.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1622/2320 [19:03<07:23,  1.57it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1623/2320 [19:03<07:18,  1.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [19:04<06:38,  1.75it/s]{'eval_loss': 1.5393872261047363, 'eval_precision': 0.9178648808351388, 'eval_recall': 0.6630620375640296, 'eval_f1': 0.7699297810821975, 'eval_report': {'PAGE_HEADER': {'precision': 0.5639810426540285, 'recall': 0.54337899543379, 'f1-score': 0.5534883720930233, 'support': 219.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'RECIPE_TITLE': {'precision': 0.48872180451127817, 'recall': 0.47794117647058826, 'f1-score': 0.483271375464684, 'support': 136.0}, 'INGREDIENT_LINE': {'precision': 0.7610693400167085, 'recall': 0.6698529411764705, 'f1-score': 0.7125537739538522, 'support': 4080.0}, 'INSTRUCTION_STEP': {'precision': 0.6107217939733707, 'recall': 0.6745356037151703, 'f1-score': 0.6410445016550202, 'support': 2584.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8672427871529668, 'recall': 0.8810313839347436, 'f1-score': 0.8740827103765174, 'support': 14466.0}, 'accuracy': 0.8097608634967898, 'macro avg': {'precision': 0.41146709603854403, 'recall': 0.4058425125913453, 'f1-score': 0.4080550916928872, 'support': 21494.0}, 'weighted avg': {'precision': 0.8104019817439725, 'recall': 0.8097608634967898, 'f1-score': 0.8093001646443919, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[119, 0, 5, 22, 16, 0, 3, 54], [0, 0, 0, 0, 0, 0, 0, 3], [6, 0, 65, 10, 19, 0, 1, 35], [48, 1, 40, 2733, 128, 0, 3, 1127], [5, 0, 0, 110, 1743, 0, 0, 726], [0, 0, 0, 0, 0, 0, 0, 6], [0, 0, 0, 0, 0, 0, 0, 0], [33, 0, 23, 716, 948, 0, 1, 12745]], 'eval_PAGE_HEADER_precision': 0.3055555555555556, 'eval_PAGE_HEADER_recall': 0.4055299539170507, 'eval_PAGE_HEADER_f1': 0.34851485148514855, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1310344827586207, 'eval_RECIPE_TITLE_recall': 0.13380281690140844, 'eval_RECIPE_TITLE_f1': 0.13240418118466898, 'eval_header_false_positive_rate': 0.0729483282674772, 'eval_title_false_negative_rate': 0.16580310880829016, 'eval_header_title_confusion_count': 56, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14963, 'INGREDIENT_LINE': 4715, 'INSTRUCTION_STEP': 2154, 'PAGE_HEADER': 288, 'RECIPE_TITLE': 145, 'SECTION_HEADER': 7, 'TEMP': 8}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.5864, 'eval_samples_per_second': 13.968, 'eval_steps_per_second': 3.492, 'epoch': 13.0}
{'loss': 0.1253, 'grad_norm': 2.4468374252319336, 'learning_rate': 1.8438697318007663e-05, 'epoch': 13.36}
{'loss': 0.0985, 'grad_norm': 1.7851661443710327, 'learning_rate': 1.7241379310344828e-05, 'epoch': 13.79}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.05it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.07it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.34it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.20it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.02it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.90it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.53it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.52it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.54it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.62it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.63it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.53it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.62it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.71it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.66it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.68it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.69it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.59it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.61it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.66it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.97it/s][A                                                   
                                               [A 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [19:10<06:38,  1.75it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.97it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1625/2320 [19:14<39:57,  3.45s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1626/2320 [19:14<29:57,  2.59s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1627/2320 [19:15<23:03,  2.00s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1628/2320 [19:16<18:15,  1.58s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1629/2320 [19:16<14:53,  1.29s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1630/2320 [19:17<12:42,  1.10s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1631/2320 [19:18<11:08,  1.03it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1632/2320 [19:18<09:55,  1.16it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1633/2320 [19:19<09:10,  1.25it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1634/2320 [19:19<08:41,  1.32it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1635/2320 [19:20<08:07,  1.40it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1636/2320 [19:21<07:46,  1.47it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1637/2320 [19:21<07:37,  1.49it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1638/2320 [19:22<07:34,  1.50it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1639/2320 [19:23<07:28,  1.52it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1640/2320 [19:23<07:25,  1.53it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1641/2320 [19:24<07:21,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1642/2320 [19:25<07:20,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1643/2320 [19:25<07:18,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1644/2320 [19:26<07:17,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1645/2320 [19:27<07:17,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1646/2320 [19:27<07:21,  1.53it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1647/2320 [19:28<07:20,  1.53it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1648/2320 [19:28<07:17,  1.54it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1649/2320 [19:29<07:08,  1.57it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [19:30<07:06,  1.57it/s]                                                    71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [19:30<07:06,  1.57it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1651/2320 [19:30<07:01,  1.59it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1652/2320 [19:31<06:54,  1.61it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1653/2320 [19:32<06:58,  1.60it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1654/2320 [19:32<06:48,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1655/2320 [19:33<06:47,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1656/2320 [19:33<06:50,  1.62it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1657/2320 [19:34<06:49,  1.62it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1658/2320 [19:35<06:52,  1.61it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1659/2320 [19:35<06:44,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1660/2320 [19:36<06:48,  1.62it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1661/2320 [19:36<06:42,  1.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1662/2320 [19:37<06:41,  1.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1663/2320 [19:38<06:46,  1.62it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1664/2320 [19:38<06:43,  1.62it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1665/2320 [19:39<06:41,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1666/2320 [19:40<06:41,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1667/2320 [19:40<06:46,  1.61it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1668/2320 [19:41<06:50,  1.59it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1669/2320 [19:41<06:57,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1670/2320 [19:42<06:57,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1671/2320 [19:43<06:56,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1672/2320 [19:43<07:00,  1.54it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1673/2320 [19:44<06:53,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1674/2320 [19:45<06:56,  1.55it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1675/2320 [19:45<06:53,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1676/2320 [19:46<06:53,  1.56it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1677/2320 [19:47<06:54,  1.55it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1678/2320 [19:47<06:58,  1.53it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1679/2320 [19:48<06:48,  1.57it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1680/2320 [19:49<06:46,  1.57it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1681/2320 [19:49<06:44,  1.58it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1682/2320 [19:50<06:36,  1.61it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1683/2320 [19:50<06:33,  1.62it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1684/2320 [19:51<06:40,  1.59it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1685/2320 [19:52<06:49,  1.55it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1686/2320 [19:52<06:48,  1.55it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1687/2320 [19:53<06:50,  1.54it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1688/2320 [19:54<06:49,  1.54it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1689/2320 [19:54<06:46,  1.55it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1690/2320 [19:55<06:37,  1.58it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1691/2320 [19:56<06:36,  1.59it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1692/2320 [19:56<06:33,  1.60it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1693/2320 [19:57<06:27,  1.62it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1694/2320 [19:57<06:24,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1695/2320 [19:58<06:27,  1.61it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1696/2320 [19:59<06:21,  1.64it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1697/2320 [19:59<06:27,  1.61it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1698/2320 [20:00<07:00,  1.48it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1699/2320 [20:01<06:53,  1.50it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [20:01<06:50,  1.51it/s]                                                    73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [20:01<06:50,  1.51it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1701/2320 [20:02<06:44,  1.53it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1702/2320 [20:03<06:44,  1.53it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1703/2320 [20:03<06:42,  1.53it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1704/2320 [20:04<06:38,  1.55it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1705/2320 [20:05<06:36,  1.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1706/2320 [20:05<06:25,  1.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1707/2320 [20:06<06:26,  1.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1708/2320 [20:06<06:19,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1709/2320 [20:07<06:25,  1.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1710/2320 [20:08<06:18,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1711/2320 [20:08<06:18,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1712/2320 [20:09<06:17,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1713/2320 [20:10<06:22,  1.59it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1714/2320 [20:10<06:24,  1.58it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1715/2320 [20:11<06:29,  1.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1716/2320 [20:11<06:29,  1.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1717/2320 [20:12<06:30,  1.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1718/2320 [20:13<06:28,  1.55it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1719/2320 [20:13<06:19,  1.58it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1720/2320 [20:14<06:12,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1721/2320 [20:15<06:14,  1.60it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1722/2320 [20:15<06:10,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1723/2320 [20:16<06:11,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1724/2320 [20:16<06:10,  1.61it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1725/2320 [20:17<06:10,  1.60it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1726/2320 [20:18<06:15,  1.58it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1727/2320 [20:18<06:19,  1.56it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1728/2320 [20:19<06:20,  1.56it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1729/2320 [20:20<06:19,  1.56it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1730/2320 [20:20<06:17,  1.56it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1731/2320 [20:21<06:16,  1.57it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1732/2320 [20:22<06:11,  1.58it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1733/2320 [20:22<06:04,  1.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1734/2320 [20:23<05:59,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1735/2320 [20:23<06:03,  1.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1736/2320 [20:24<06:01,  1.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1737/2320 [20:25<05:58,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1738/2320 [20:25<05:58,  1.62it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1739/2320 [20:26<05:59,  1.61it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [20:26<05:28,  1.77it/s]{'eval_loss': 1.5387513637542725, 'eval_precision': 0.922533830162777, 'eval_recall': 0.6605813790198006, 'eval_f1': 0.769885433715221, 'eval_report': {'PAGE_HEADER': {'precision': 0.7819905213270142, 'recall': 0.3937947494033413, 'f1-score': 0.5238095238095238, 'support': 419.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.7443609022556391, 'recall': 0.32781456953642385, 'f1-score': 0.45517241379310347, 'support': 302.0}, 'INGREDIENT_LINE': {'precision': 0.7270955165692008, 'recall': 0.707204767063922, 'f1-score': 0.7170122202389125, 'support': 3692.0}, 'INSTRUCTION_STEP': {'precision': 0.6408549404344779, 'recall': 0.6791682138878574, 'f1-score': 0.6594555615648098, 'support': 2693.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8624115405552532, 'recall': 0.8817922493564322, 'f1-score': 0.871994220647425, 'support': 14373.0}, 'accuracy': 0.8085046989857635, 'macro avg': {'precision': 0.4695891776426982, 'recall': 0.37372181865599713, 'f1-score': 0.4034304925067218, 'support': 21494.0}, 'weighted avg': {'precision': 0.807581236395339, 'recall': 0.8085046989857635, 'f1-score': 0.80549149238035, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[165, 0, 8, 34, 23, 0, 4, 185], [0, 0, 0, 0, 0, 0, 0, 6], [7, 0, 99, 27, 23, 0, 3, 143], [27, 1, 24, 2611, 99, 0, 1, 929], [4, 0, 2, 108, 1829, 0, 0, 750], [0, 0, 0, 0, 0, 0, 0, 9], [0, 0, 0, 0, 0, 0, 0, 0], [8, 0, 0, 811, 880, 0, 0, 12674]], 'eval_PAGE_HEADER_precision': 0.2222222222222222, 'eval_PAGE_HEADER_recall': 0.5345622119815668, 'eval_PAGE_HEADER_f1': 0.3139377537212449, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.10344827586206896, 'eval_RECIPE_TITLE_recall': 0.2323943661971831, 'eval_RECIPE_TITLE_f1': 0.14316702819956614, 'eval_header_false_positive_rate': 0.10483870967741936, 'eval_title_false_negative_rate': 0.21524663677130046, 'eval_header_title_confusion_count': 87, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14722, 'INGREDIENT_LINE': 4564, 'INSTRUCTION_STEP': 2127, 'PAGE_HEADER': 522, 'RECIPE_TITLE': 319, 'SECTION_HEADER': 15, 'TEMP': 11}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6656, 'eval_samples_per_second': 13.802, 'eval_steps_per_second': 3.451, 'epoch': 14.0}
{'loss': 0.1134, 'grad_norm': 0.8407998085021973, 'learning_rate': 1.6044061302681994e-05, 'epoch': 14.22}
{'loss': 0.093, 'grad_norm': 2.9852583408355713, 'learning_rate': 1.4846743295019159e-05, 'epoch': 14.66}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.63it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.47it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.47it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.14it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.93it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.80it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.67it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.59it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.59it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.64it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.71it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.66it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.67it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.75it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.67it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.77it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.83it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.70it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.64it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.73it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.68it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  3.98it/s][A                                                   
                                               [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [20:33<05:28,  1.77it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.98it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1741/2320 [20:37<33:57,  3.52s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1742/2320 [20:37<25:29,  2.65s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1743/2320 [20:38<19:37,  2.04s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1744/2320 [20:39<15:32,  1.62s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1745/2320 [20:39<12:42,  1.33s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1746/2320 [20:40<10:49,  1.13s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1747/2320 [20:41<09:27,  1.01it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1748/2320 [20:41<08:25,  1.13it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1749/2320 [20:42<07:43,  1.23it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [20:42<07:15,  1.31it/s]                                                    75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [20:43<07:15,  1.31it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1751/2320 [20:43<06:58,  1.36it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1752/2320 [20:44<06:42,  1.41it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1753/2320 [20:44<06:32,  1.44it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1754/2320 [20:45<06:25,  1.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1755/2320 [20:46<06:25,  1.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1756/2320 [20:46<06:21,  1.48it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1757/2320 [20:47<06:17,  1.49it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1758/2320 [20:48<06:08,  1.53it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1759/2320 [20:48<06:05,  1.54it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1760/2320 [20:49<06:07,  1.52it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1761/2320 [20:50<06:09,  1.51it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1762/2320 [20:50<06:10,  1.51it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1763/2320 [20:51<06:00,  1.55it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1764/2320 [20:52<06:06,  1.52it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1765/2320 [20:52<06:10,  1.50it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1766/2320 [20:53<06:15,  1.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1767/2320 [20:54<06:23,  1.44it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1768/2320 [20:54<06:15,  1.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1769/2320 [20:55<06:14,  1.47it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1770/2320 [20:56<06:02,  1.52it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1771/2320 [20:56<05:52,  1.56it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1772/2320 [20:57<05:52,  1.56it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1773/2320 [20:58<05:56,  1.53it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1774/2320 [20:58<05:56,  1.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1775/2320 [20:59<05:56,  1.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1776/2320 [21:00<05:57,  1.52it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1777/2320 [21:00<05:55,  1.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1778/2320 [21:01<05:54,  1.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1779/2320 [21:02<05:56,  1.52it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1780/2320 [21:02<05:54,  1.52it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1781/2320 [21:03<05:53,  1.53it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1782/2320 [21:04<06:05,  1.47it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1783/2320 [21:04<06:08,  1.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1784/2320 [21:05<06:13,  1.43it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1785/2320 [21:06<06:11,  1.44it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1786/2320 [21:06<06:11,  1.44it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1787/2320 [21:07<06:16,  1.41it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1788/2320 [21:08<06:05,  1.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1789/2320 [21:09<06:03,  1.46it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1790/2320 [21:09<06:04,  1.45it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1791/2320 [21:10<06:05,  1.45it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1792/2320 [21:11<06:05,  1.44it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1793/2320 [21:11<06:03,  1.45it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1794/2320 [21:12<05:51,  1.50it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1795/2320 [21:13<05:45,  1.52it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1796/2320 [21:13<05:38,  1.55it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1797/2320 [21:14<05:30,  1.58it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1798/2320 [21:14<05:25,  1.61it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1799/2320 [21:15<05:28,  1.59it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [21:16<05:22,  1.61it/s]                                                    78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [21:16<05:22,  1.61it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1801/2320 [21:16<05:20,  1.62it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1802/2320 [21:17<05:23,  1.60it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1803/2320 [21:18<05:30,  1.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1804/2320 [21:18<05:39,  1.52it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1805/2320 [21:19<05:51,  1.46it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1806/2320 [21:20<05:55,  1.45it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1807/2320 [21:20<05:55,  1.44it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1808/2320 [21:21<05:59,  1.42it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1809/2320 [21:22<05:59,  1.42it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1810/2320 [21:22<05:50,  1.46it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1811/2320 [21:23<05:43,  1.48it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1812/2320 [21:24<05:41,  1.49it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1813/2320 [21:24<05:37,  1.50it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1814/2320 [21:25<05:37,  1.50it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1815/2320 [21:26<05:32,  1.52it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1816/2320 [21:26<05:34,  1.51it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1817/2320 [21:27<05:34,  1.50it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1818/2320 [21:28<05:25,  1.54it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1819/2320 [21:28<05:21,  1.56it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1820/2320 [21:29<05:13,  1.59it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1821/2320 [21:30<05:14,  1.59it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1822/2320 [21:30<05:10,  1.61it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1823/2320 [21:31<05:12,  1.59it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1824/2320 [21:31<05:17,  1.56it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1825/2320 [21:32<05:23,  1.53it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1826/2320 [21:33<05:47,  1.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1827/2320 [21:34<05:42,  1.44it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1828/2320 [21:34<05:43,  1.43it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1829/2320 [21:35<05:46,  1.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1830/2320 [21:36<05:45,  1.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1831/2320 [21:36<05:46,  1.41it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1832/2320 [21:37<05:53,  1.38it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1833/2320 [21:38<06:11,  1.31it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1834/2320 [21:39<06:15,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1835/2320 [21:40<05:59,  1.35it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1836/2320 [21:40<05:40,  1.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1837/2320 [21:41<05:28,  1.47it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1838/2320 [21:41<05:20,  1.50it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1839/2320 [21:42<05:10,  1.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1840/2320 [21:43<05:03,  1.58it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1841/2320 [21:43<05:05,  1.57it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1842/2320 [21:44<05:07,  1.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1843/2320 [21:45<05:06,  1.55it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1844/2320 [21:45<05:06,  1.55it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1845/2320 [21:46<05:06,  1.55it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1846/2320 [21:47<05:06,  1.54it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1847/2320 [21:47<05:00,  1.58it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1848/2320 [21:48<04:59,  1.58it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1849/2320 [21:48<04:51,  1.62it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [21:49<04:54,  1.59it/s]                                                    80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [21:49<04:54,  1.59it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1851/2320 [21:50<05:01,  1.56it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1852/2320 [21:50<05:01,  1.55it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1853/2320 [21:51<05:05,  1.53it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1854/2320 [21:52<05:02,  1.54it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1855/2320 [21:52<05:23,  1.44it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [21:53<04:46,  1.62it/s]{'eval_loss': 1.4928512573242188, 'eval_precision': 0.9081923588671356, 'eval_recall': 0.6298444503031901, 'eval_f1': 0.7438312446485561, 'eval_report': {'PAGE_HEADER': {'precision': 0.7156398104265402, 'recall': 0.38917525773195877, 'f1-score': 0.5041736227045075, 'support': 388.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.7518796992481203, 'recall': 0.3058103975535168, 'f1-score': 0.43478260869565216, 'support': 327.0}, 'INGREDIENT_LINE': {'precision': 0.7276524644945698, 'recall': 0.6907216494845361, 'f1-score': 0.708706265256306, 'support': 3783.0}, 'INSTRUCTION_STEP': {'precision': 0.6706377014716188, 'recall': 0.6226415094339622, 'f1-score': 0.645748987854251, 'support': 3074.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8417936853565596, 'recall': 0.8894880644233535, 'f1-score': 0.8649839183331003, 'support': 13908.0}, 'accuracy': 0.7978505629477994, 'macro avg': {'precision': 0.4634504201246761, 'recall': 0.3622296098284159, 'f1-score': 0.39479942535547713, 'support': 21494.0}, 'weighted avg': {'precision': 0.7930328952984731, 'recall': 0.7978505629477994, 'f1-score': 0.7925029219762799, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[151, 0, 7, 34, 15, 0, 4, 177], [0, 0, 0, 0, 0, 0, 0, 4], [9, 0, 100, 38, 23, 0, 3, 154], [31, 1, 23, 2613, 101, 0, 1, 1013], [15, 0, 3, 175, 1914, 0, 0, 967], [0, 0, 0, 0, 0, 0, 0, 10], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 731, 801, 0, 0, 12371]], 'eval_PAGE_HEADER_precision': 0.23076923076923078, 'eval_PAGE_HEADER_recall': 0.5391705069124424, 'eval_PAGE_HEADER_f1': 0.3232044198895027, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09295774647887324, 'eval_RECIPE_TITLE_recall': 0.2323943661971831, 'eval_RECIPE_TITLE_f1': 0.13279678068410464, 'eval_header_false_positive_rate': 0.11170212765957446, 'eval_title_false_negative_rate': 0.21875, 'eval_header_title_confusion_count': 91, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14459, 'INGREDIENT_LINE': 4402, 'INSTRUCTION_STEP': 2536, 'PAGE_HEADER': 507, 'RECIPE_TITLE': 355, 'SECTION_HEADER': 9, 'TEMP': 12}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6083, 'eval_samples_per_second': 13.922, 'eval_steps_per_second': 3.48, 'epoch': 15.0}
{'loss': 0.0905, 'grad_norm': 3.5610084533691406, 'learning_rate': 1.3649425287356324e-05, 'epoch': 15.09}
{'loss': 0.0889, 'grad_norm': 2.732717275619507, 'learning_rate': 1.2452107279693487e-05, 'epoch': 15.52}
{'loss': 0.0852, 'grad_norm': 5.158857345581055, 'learning_rate': 1.1254789272030653e-05, 'epoch': 15.95}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.39it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.19it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.46it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.10it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.02it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.91it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.63it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.56it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.53it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.56it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.55it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.50it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.50it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.55it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.56it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.57it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.59it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.52it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.52it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.57it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.52it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.85it/s][A                                                   
                                               [A 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [22:00<04:46,  1.62it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.85it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1857/2320 [22:03<27:56,  3.62s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1858/2320 [22:04<20:51,  2.71s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1859/2320 [22:05<15:53,  2.07s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1860/2320 [22:05<12:28,  1.63s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1861/2320 [22:06<10:10,  1.33s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1862/2320 [22:07<08:30,  1.12s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1863/2320 [22:07<07:58,  1.05s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1864/2320 [22:08<07:04,  1.07it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1865/2320 [22:09<06:25,  1.18it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1866/2320 [22:09<05:57,  1.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1867/2320 [22:10<05:33,  1.36it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1868/2320 [22:11<05:18,  1.42it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1869/2320 [22:11<05:12,  1.45it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1870/2320 [22:12<05:06,  1.47it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1871/2320 [22:13<05:05,  1.47it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1872/2320 [22:13<05:03,  1.48it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1873/2320 [22:14<05:02,  1.48it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1874/2320 [22:15<04:58,  1.49it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1875/2320 [22:15<04:54,  1.51it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1876/2320 [22:16<04:50,  1.53it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1877/2320 [22:17<04:51,  1.52it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1878/2320 [22:17<04:48,  1.53it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1879/2320 [22:18<04:46,  1.54it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1880/2320 [22:18<04:44,  1.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1881/2320 [22:19<04:42,  1.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1882/2320 [22:20<04:45,  1.53it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1883/2320 [22:20<04:48,  1.52it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1884/2320 [22:21<04:47,  1.52it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1885/2320 [22:22<04:44,  1.53it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1886/2320 [22:22<04:39,  1.56it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1887/2320 [22:23<04:40,  1.55it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1888/2320 [22:24<04:40,  1.54it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1889/2320 [22:24<04:40,  1.54it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1890/2320 [22:25<04:47,  1.50it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1891/2320 [22:26<04:53,  1.46it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1892/2320 [22:27<05:01,  1.42it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1893/2320 [22:27<04:55,  1.44it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1894/2320 [22:28<05:02,  1.41it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1895/2320 [22:29<05:09,  1.37it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1896/2320 [22:29<05:10,  1.37it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1897/2320 [22:30<05:05,  1.39it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1898/2320 [22:31<05:03,  1.39it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1899/2320 [22:32<04:58,  1.41it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [22:32<04:49,  1.45it/s]                                                    82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [22:32<04:49,  1.45it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1901/2320 [22:33<04:43,  1.48it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1902/2320 [22:33<04:40,  1.49it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1903/2320 [22:34<04:36,  1.51it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1904/2320 [22:35<04:33,  1.52it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1905/2320 [22:35<04:31,  1.53it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1906/2320 [22:36<04:31,  1.53it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1907/2320 [22:37<04:25,  1.56it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1908/2320 [22:37<04:23,  1.56it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1909/2320 [22:38<04:27,  1.53it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1910/2320 [22:39<04:28,  1.52it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1911/2320 [22:39<04:34,  1.49it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1912/2320 [22:40<04:44,  1.44it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1913/2320 [22:41<04:51,  1.40it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1914/2320 [22:42<04:54,  1.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1915/2320 [22:42<04:51,  1.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1916/2320 [22:43<04:47,  1.41it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1917/2320 [22:44<04:37,  1.45it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1918/2320 [22:44<04:33,  1.47it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1919/2320 [22:45<04:36,  1.45it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1920/2320 [22:46<04:41,  1.42it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1921/2320 [22:46<04:38,  1.43it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1922/2320 [22:47<04:33,  1.46it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1923/2320 [22:48<04:22,  1.51it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1924/2320 [22:48<04:21,  1.51it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1925/2320 [22:49<04:20,  1.52it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1926/2320 [22:50<04:17,  1.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1927/2320 [22:50<04:15,  1.54it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1928/2320 [22:51<04:17,  1.52it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1929/2320 [22:52<04:18,  1.51it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1930/2320 [22:52<04:15,  1.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1931/2320 [22:53<04:12,  1.54it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1932/2320 [22:54<04:10,  1.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1933/2320 [22:54<04:09,  1.55it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1934/2320 [22:55<04:10,  1.54it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1935/2320 [22:56<04:11,  1.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1936/2320 [22:56<04:11,  1.53it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1937/2320 [22:57<04:10,  1.53it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1938/2320 [22:58<04:07,  1.54it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1939/2320 [22:58<04:06,  1.55it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1940/2320 [22:59<04:06,  1.54it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1941/2320 [23:00<04:17,  1.47it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1942/2320 [23:00<04:12,  1.50it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1943/2320 [23:01<04:09,  1.51it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1944/2320 [23:01<04:07,  1.52it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1945/2320 [23:02<04:00,  1.56it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1946/2320 [23:03<03:56,  1.58it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1947/2320 [23:03<03:51,  1.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1948/2320 [23:04<03:53,  1.59it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1949/2320 [23:05<03:50,  1.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [23:05<03:49,  1.61it/s]                                                    84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [23:05<03:49,  1.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1951/2320 [23:06<03:46,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1952/2320 [23:06<03:48,  1.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1953/2320 [23:07<03:48,  1.60it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1954/2320 [23:08<03:46,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1955/2320 [23:08<03:43,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1956/2320 [23:09<03:40,  1.65it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1957/2320 [23:09<03:46,  1.60it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1958/2320 [23:10<03:50,  1.57it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1959/2320 [23:11<03:51,  1.56it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1960/2320 [23:11<03:53,  1.54it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1961/2320 [23:12<03:56,  1.52it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1962/2320 [23:13<04:02,  1.47it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1963/2320 [23:14<04:01,  1.48it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1964/2320 [23:14<04:03,  1.46it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1965/2320 [23:15<04:03,  1.46it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1966/2320 [23:16<04:04,  1.45it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1967/2320 [23:16<04:05,  1.44it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1968/2320 [23:17<04:07,  1.42it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1969/2320 [23:18<04:03,  1.44it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1970/2320 [23:18<03:59,  1.46it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1971/2320 [23:19<03:53,  1.50it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [23:19<03:29,  1.66it/s]{'eval_loss': 1.56493079662323, 'eval_precision': 0.9078152406938219, 'eval_recall': 0.6542134831460674, 'eval_f1': 0.7604277201861073, 'eval_report': {'PAGE_HEADER': {'precision': 0.6161137440758294, 'recall': 0.4166666666666667, 'f1-score': 0.497131931166348, 'support': 312.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.5112781954887218, 'recall': 0.31336405529953915, 'f1-score': 0.38857142857142857, 'support': 217.0}, 'INGREDIENT_LINE': {'precision': 0.7326649958228906, 'recall': 0.6760020554984584, 'f1-score': 0.703193906187358, 'support': 3892.0}, 'INSTRUCTION_STEP': {'precision': 0.6408549404344779, 'recall': 0.6824626865671641, 'f1-score': 0.661004698229129, 'support': 2680.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 15.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8646570495372891, 'recall': 0.8840267149019062, 'f1-score': 0.8742346061231511, 'support': 14374.0}, 'accuracy': 0.80789987903601, 'macro avg': {'precision': 0.4206961156699011, 'recall': 0.37156527236671677, 'f1-score': 0.39051707128467683, 'support': 21494.0}, 'weighted avg': {'precision': 0.804912007570894, 'recall': 0.80789987903601, 'f1-score': 0.8055269686923484, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[130, 0, 9, 21, 4, 0, 0, 148], [0, 0, 0, 0, 0, 0, 0, 4], [4, 0, 68, 12, 8, 0, 0, 125], [34, 1, 27, 2631, 129, 0, 8, 1062], [38, 0, 29, 149, 1829, 0, 0, 635], [0, 0, 0, 0, 0, 0, 0, 15], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 778, 884, 0, 0, 12707]], 'eval_PAGE_HEADER_precision': 0.2583732057416268, 'eval_PAGE_HEADER_recall': 0.4976958525345622, 'eval_PAGE_HEADER_f1': 0.3401574803149607, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.11462450592885376, 'eval_RECIPE_TITLE_recall': 0.20422535211267606, 'eval_RECIPE_TITLE_f1': 0.1468354430379747, 'eval_header_false_positive_rate': 0.08450704225352113, 'eval_title_false_negative_rate': 0.20465116279069767, 'eval_header_title_confusion_count': 74, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14792, 'INGREDIENT_LINE': 4678, 'INSTRUCTION_STEP': 2112, 'PAGE_HEADER': 418, 'RECIPE_TITLE': 253, 'SECTION_HEADER': 8, 'TEMP': 19}, 'eval_title_anchor_accuracy': 0.3333333333333333, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 2, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.7972, 'eval_samples_per_second': 13.535, 'eval_steps_per_second': 3.384, 'epoch': 16.0}
{'loss': 0.0685, 'grad_norm': 0.7518965005874634, 'learning_rate': 1.0057471264367816e-05, 'epoch': 16.38}
{'loss': 0.067, 'grad_norm': 2.3751180171966553, 'learning_rate': 8.860153256704981e-06, 'epoch': 16.81}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.57it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.70it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.03it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  3.86it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.80it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.76it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.75it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.60it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.57it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.51it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.49it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.49it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.46it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.45it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.48it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.55it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.57it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.57it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.57it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.46it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:06<00:00,  3.46it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.87it/s][A                                                   
                                               [A 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [23:26<03:29,  1.66it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.87it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1973/2320 [23:30<21:01,  3.63s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1974/2320 [23:31<15:40,  2.72s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1975/2320 [23:31<11:57,  2.08s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1976/2320 [23:32<09:26,  1.65s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1977/2320 [23:33<07:39,  1.34s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1978/2320 [23:33<06:22,  1.12s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1979/2320 [23:34<05:31,  1.03it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1980/2320 [23:35<05:14,  1.08it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1981/2320 [23:35<04:41,  1.20it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1982/2320 [23:36<04:20,  1.30it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1983/2320 [23:37<04:06,  1.37it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1984/2320 [23:37<03:53,  1.44it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1985/2320 [23:38<03:46,  1.48it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1986/2320 [23:38<03:41,  1.51it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1987/2320 [23:39<03:39,  1.51it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1988/2320 [23:40<03:38,  1.52it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1989/2320 [23:40<03:42,  1.49it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1990/2320 [23:41<03:38,  1.51it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1991/2320 [23:42<03:35,  1.53it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1992/2320 [23:42<03:34,  1.53it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1993/2320 [23:43<03:33,  1.53it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1994/2320 [23:44<03:32,  1.54it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1995/2320 [23:44<03:26,  1.58it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1996/2320 [23:45<03:25,  1.57it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1997/2320 [23:45<03:21,  1.60it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1998/2320 [23:46<03:19,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1999/2320 [23:47<03:18,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [23:47<03:18,  1.61it/s]                                                    86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [23:47<03:18,  1.61it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2001/2320 [23:48<03:16,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2002/2320 [23:49<03:15,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2003/2320 [23:49<03:17,  1.61it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2004/2320 [23:50<03:14,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2005/2320 [23:50<03:13,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2006/2320 [23:51<03:12,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2007/2320 [23:52<03:10,  1.64it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2008/2320 [23:52<03:12,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2009/2320 [23:53<03:11,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2010/2320 [23:53<03:11,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2011/2320 [23:54<03:12,  1.61it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2012/2320 [23:55<03:13,  1.59it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2013/2320 [23:55<03:13,  1.58it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2014/2320 [23:56<03:13,  1.58it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2015/2320 [23:57<03:12,  1.58it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2016/2320 [23:57<03:12,  1.58it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2017/2320 [23:58<03:12,  1.57it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2018/2320 [23:59<03:13,  1.56it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2019/2320 [23:59<03:08,  1.59it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2020/2320 [24:00<03:06,  1.61it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2021/2320 [24:00<03:07,  1.59it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2022/2320 [24:01<03:04,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2023/2320 [24:02<03:05,  1.60it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2024/2320 [24:02<03:04,  1.60it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2025/2320 [24:03<03:03,  1.61it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2026/2320 [24:04<03:01,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2027/2320 [24:04<02:59,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2028/2320 [24:05<03:00,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2029/2320 [24:05<03:04,  1.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2030/2320 [24:06<03:04,  1.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2031/2320 [24:07<03:10,  1.52it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2032/2320 [24:07<03:08,  1.53it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2033/2320 [24:08<03:03,  1.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2034/2320 [24:09<02:58,  1.60it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2035/2320 [24:09<03:00,  1.58it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2036/2320 [24:10<02:57,  1.60it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2037/2320 [24:11<02:57,  1.60it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2038/2320 [24:11<02:52,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2039/2320 [24:12<02:53,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2040/2320 [24:12<02:53,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2041/2320 [24:13<02:57,  1.57it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2042/2320 [24:14<02:57,  1.56it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2043/2320 [24:14<02:57,  1.56it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2044/2320 [24:15<02:58,  1.55it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2045/2320 [24:16<02:57,  1.55it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2046/2320 [24:16<03:00,  1.52it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2047/2320 [24:17<03:00,  1.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2048/2320 [24:18<03:00,  1.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2049/2320 [24:18<02:58,  1.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [24:19<02:59,  1.51it/s]                                                    88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [24:19<02:59,  1.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2051/2320 [24:20<02:59,  1.50it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2052/2320 [24:20<02:56,  1.51it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2053/2320 [24:21<02:55,  1.52it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2054/2320 [24:22<02:51,  1.55it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2055/2320 [24:22<02:46,  1.59it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2056/2320 [24:23<02:46,  1.58it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2057/2320 [24:23<02:43,  1.61it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2058/2320 [24:24<02:44,  1.59it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2059/2320 [24:25<02:46,  1.56it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2060/2320 [24:25<02:49,  1.54it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2061/2320 [24:26<02:50,  1.52it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2062/2320 [24:27<02:45,  1.56it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2063/2320 [24:27<02:45,  1.55it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2064/2320 [24:28<02:45,  1.54it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2065/2320 [24:29<02:46,  1.53it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2066/2320 [24:29<02:45,  1.54it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2067/2320 [24:30<02:45,  1.53it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2068/2320 [24:31<02:44,  1.53it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2069/2320 [24:31<02:40,  1.56it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2070/2320 [24:32<02:38,  1.57it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2071/2320 [24:32<02:37,  1.58it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2072/2320 [24:33<02:36,  1.58it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2073/2320 [24:34<02:37,  1.57it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2074/2320 [24:34<02:37,  1.56it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2075/2320 [24:35<02:39,  1.54it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2076/2320 [24:36<02:38,  1.54it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2077/2320 [24:36<02:35,  1.57it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2078/2320 [24:37<02:34,  1.57it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2079/2320 [24:38<02:35,  1.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2080/2320 [24:38<02:34,  1.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2081/2320 [24:39<02:34,  1.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2082/2320 [24:40<02:35,  1.53it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2083/2320 [24:40<02:33,  1.55it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2084/2320 [24:41<02:31,  1.56it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2085/2320 [24:41<02:29,  1.57it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2086/2320 [24:42<02:29,  1.56it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2087/2320 [24:43<02:25,  1.60it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [24:43<02:12,  1.76it/s]{'eval_loss': 1.6935908794403076, 'eval_precision': 0.909637347225005, 'eval_recall': 0.6795389911689866, 'eval_f1': 0.7779300891021247, 'eval_report': {'PAGE_HEADER': {'precision': 0.46445497630331756, 'recall': 0.593939393939394, 'f1-score': 0.5212765957446809, 'support': 165.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.3082706766917293, 'recall': 0.3904761904761905, 'f1-score': 0.3445378151260504, 'support': 105.0}, 'INGREDIENT_LINE': {'precision': 0.732943469785575, 'recall': 0.6886446886446886, 'f1-score': 0.7101038715769594, 'support': 3822.0}, 'INSTRUCTION_STEP': {'precision': 0.6198318149964962, 'recall': 0.6856589147286821, 'f1-score': 0.6510857563489142, 'support': 2580.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8850027218290691, 'recall': 0.8780125565381759, 'f1-score': 0.8814937815581687, 'support': 14813.0}, 'accuracy': 0.8163208337210385, 'macro avg': {'precision': 0.3763129574507734, 'recall': 0.4045914680408914, 'f1-score': 0.3885622275443467, 'support': 21494.0}, 'weighted avg': {'precision': 0.819718285791761, 'recall': 0.8163208337210385, 'f1-score': 0.8176036449080953, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[98, 0, 5, 21, 1, 0, 0, 40], [0, 0, 0, 0, 0, 0, 0, 4], [2, 0, 41, 18, 3, 0, 0, 41], [50, 1, 47, 2632, 120, 0, 8, 964], [23, 0, 12, 140, 1769, 0, 0, 636], [0, 0, 0, 0, 0, 0, 0, 5], [0, 0, 0, 0, 0, 0, 0, 0], [38, 0, 28, 780, 961, 0, 0, 13006]], 'eval_PAGE_HEADER_precision': 0.3333333333333333, 'eval_PAGE_HEADER_recall': 0.391705069124424, 'eval_PAGE_HEADER_f1': 0.3601694915254237, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.08270676691729323, 'eval_RECIPE_TITLE_recall': 0.07746478873239436, 'eval_RECIPE_TITLE_f1': 0.07999999999999999, 'eval_header_false_positive_rate': 0.03514376996805112, 'eval_title_false_negative_rate': 0.15, 'eval_header_title_confusion_count': 38, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15119, 'INGREDIENT_LINE': 4643, 'INSTRUCTION_STEP': 2115, 'PAGE_HEADER': 255, 'RECIPE_TITLE': 133, 'SECTION_HEADER': 8, 'TEMP': 7}, 'eval_title_anchor_accuracy': 0.3333333333333333, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 2, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.9954, 'eval_samples_per_second': 13.152, 'eval_steps_per_second': 3.288, 'epoch': 17.0}
{'loss': 0.0636, 'grad_norm': 6.9197211265563965, 'learning_rate': 7.662835249042145e-06, 'epoch': 17.24}
{'loss': 0.056, 'grad_norm': 1.3842273950576782, 'learning_rate': 6.465517241379311e-06, 'epoch': 17.67}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.53it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.29it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.40it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.10it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.09it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.93it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.62it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.55it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.41it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.53it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.60it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.62it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.57it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.60it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.68it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.68it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.63it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.72it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.61it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.65it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.72it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.09it/s][A                                                   
                                               [A 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [24:50<02:12,  1.76it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.09it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2089/2320 [24:53<13:17,  3.45s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2090/2320 [24:54<09:56,  2.59s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2091/2320 [24:55<07:38,  2.00s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2092/2320 [24:55<06:05,  1.60s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2093/2320 [24:56<05:00,  1.32s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2094/2320 [24:57<04:14,  1.12s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2095/2320 [24:57<03:41,  1.02it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2096/2320 [24:58<03:19,  1.12it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2097/2320 [24:59<03:03,  1.22it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2098/2320 [24:59<02:52,  1.29it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2099/2320 [25:00<02:43,  1.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [25:00<02:36,  1.41it/s]                                                    91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [25:00<02:36,  1.41it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2101/2320 [25:01<02:36,  1.40it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2102/2320 [25:02<02:32,  1.43it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2103/2320 [25:03<02:28,  1.46it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2104/2320 [25:03<02:25,  1.48it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2105/2320 [25:04<02:24,  1.49it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2106/2320 [25:04<02:22,  1.51it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2107/2320 [25:05<02:20,  1.51it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2108/2320 [25:06<02:18,  1.53it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2109/2320 [25:06<02:15,  1.56it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2110/2320 [25:07<02:16,  1.54it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2111/2320 [25:08<02:12,  1.58it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2112/2320 [25:08<02:10,  1.59it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2113/2320 [25:09<02:07,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2114/2320 [25:09<02:08,  1.61it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2115/2320 [25:10<02:07,  1.61it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2116/2320 [25:11<02:09,  1.57it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2117/2320 [25:11<02:08,  1.57it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2118/2320 [25:12<02:09,  1.56it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2119/2320 [25:13<02:08,  1.57it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2120/2320 [25:13<02:07,  1.56it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2121/2320 [25:14<02:07,  1.55it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2122/2320 [25:15<02:04,  1.59it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2123/2320 [25:15<02:02,  1.61it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2124/2320 [25:16<02:04,  1.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2125/2320 [25:16<02:01,  1.61it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2126/2320 [25:17<02:01,  1.60it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2127/2320 [25:18<02:02,  1.57it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2128/2320 [25:18<02:02,  1.57it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2129/2320 [25:19<02:02,  1.56it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2130/2320 [25:20<02:01,  1.56it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2131/2320 [25:20<02:03,  1.53it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2132/2320 [25:21<02:02,  1.53it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2133/2320 [25:22<02:02,  1.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2134/2320 [25:22<02:00,  1.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2135/2320 [25:23<02:00,  1.54it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2136/2320 [25:24<02:00,  1.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2137/2320 [25:24<02:01,  1.50it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2138/2320 [25:25<01:59,  1.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2139/2320 [25:26<02:08,  1.41it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2140/2320 [25:26<02:04,  1.45it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2141/2320 [25:27<02:01,  1.47it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2142/2320 [25:28<01:57,  1.52it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2143/2320 [25:28<01:55,  1.53it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2144/2320 [25:29<01:52,  1.57it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2145/2320 [25:30<01:50,  1.58it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2146/2320 [25:30<01:49,  1.59it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2147/2320 [25:31<01:47,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2148/2320 [25:31<01:45,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2149/2320 [25:32<01:46,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [25:33<01:46,  1.60it/s]                                                    93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [25:33<01:46,  1.60it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2151/2320 [25:33<01:44,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2152/2320 [25:34<01:43,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2153/2320 [25:34<01:42,  1.64it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2154/2320 [25:35<01:42,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2155/2320 [25:36<01:42,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2156/2320 [25:36<01:41,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2157/2320 [25:37<01:41,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2158/2320 [25:38<01:41,  1.59it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2159/2320 [25:38<01:41,  1.58it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2160/2320 [25:39<01:41,  1.58it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2161/2320 [25:40<01:40,  1.58it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2162/2320 [25:40<01:40,  1.57it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2163/2320 [25:41<01:40,  1.56it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2164/2320 [25:41<01:39,  1.56it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2165/2320 [25:42<01:37,  1.59it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2166/2320 [25:43<01:36,  1.60it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2167/2320 [25:43<01:34,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2168/2320 [25:44<01:34,  1.61it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2169/2320 [25:45<01:33,  1.61it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2170/2320 [25:45<01:33,  1.60it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2171/2320 [25:46<01:36,  1.55it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2172/2320 [25:47<01:36,  1.53it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2173/2320 [25:47<01:35,  1.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2174/2320 [25:48<01:34,  1.55it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2175/2320 [25:48<01:32,  1.57it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2176/2320 [25:49<01:31,  1.58it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2177/2320 [25:50<01:29,  1.59it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2178/2320 [25:50<01:28,  1.60it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2179/2320 [25:51<01:27,  1.61it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2180/2320 [25:52<01:29,  1.56it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2181/2320 [25:52<01:28,  1.56it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2182/2320 [25:53<01:28,  1.56it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2183/2320 [25:54<01:28,  1.54it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2184/2320 [25:54<01:29,  1.52it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2185/2320 [25:55<01:29,  1.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2186/2320 [25:56<01:28,  1.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2187/2320 [25:56<01:27,  1.52it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2188/2320 [25:57<01:27,  1.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2189/2320 [25:58<01:26,  1.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2190/2320 [25:58<01:25,  1.52it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2191/2320 [25:59<01:25,  1.51it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2192/2320 [25:59<01:23,  1.54it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2193/2320 [26:00<01:20,  1.57it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2194/2320 [26:01<01:22,  1.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2195/2320 [26:01<01:21,  1.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2196/2320 [26:02<01:21,  1.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2197/2320 [26:03<01:20,  1.53it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2198/2320 [26:03<01:18,  1.56it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2199/2320 [26:04<01:17,  1.57it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [26:05<01:15,  1.58it/s]                                                    95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [26:05<01:15,  1.58it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2201/2320 [26:05<01:14,  1.59it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2202/2320 [26:06<01:13,  1.61it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2203/2320 [26:06<01:12,  1.60it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [26:07<01:05,  1.76it/s]{'eval_loss': 1.7377378940582275, 'eval_precision': 0.9202956452257292, 'eval_recall': 0.7124961336220229, 'eval_f1': 0.8031729428172942, 'eval_report': {'PAGE_HEADER': {'precision': 0.6208530805687204, 'recall': 0.45964912280701753, 'f1-score': 0.5282258064516129, 'support': 285.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.5112781954887218, 'recall': 0.35051546391752575, 'f1-score': 0.41590214067278286, 'support': 194.0}, 'INGREDIENT_LINE': {'precision': 0.7357282094124199, 'recall': 0.7602877697841727, 'f1-score': 0.7478063968298896, 'support': 3475.0}, 'INSTRUCTION_STEP': {'precision': 0.6187806587245971, 'recall': 0.7058353317346123, 'f1-score': 0.6594473487677371, 'support': 2502.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.9006532389765922, 'recall': 0.8807559222784136, 'f1-score': 0.89059345983044, 'support': 15028.0}, 'accuracy': 0.8301386433423281, 'macro avg': {'precision': 0.42341167289638143, 'recall': 0.39463045131521773, 'f1-score': 0.4052468940690578, 'support': 21494.0}, 'weighted avg': {'precision': 0.8335346007752967, 'recall': 0.8301386433423281, 'f1-score': 0.8310985568094271, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[131, 0, 9, 12, 1, 0, 3, 129], [0, 0, 0, 0, 0, 0, 0, 4], [3, 0, 68, 7, 7, 0, 3, 106], [34, 1, 27, 2642, 95, 0, 1, 675], [38, 0, 29, 128, 1766, 0, 1, 540], [0, 0, 0, 0, 0, 0, 0, 6], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 802, 985, 0, 0, 13236]], 'eval_PAGE_HEADER_precision': 0.272264631043257, 'eval_PAGE_HEADER_recall': 0.4930875576036866, 'eval_PAGE_HEADER_f1': 0.35081967213114745, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.12719298245614036, 'eval_RECIPE_TITLE_recall': 0.20422535211267606, 'eval_RECIPE_TITLE_f1': 0.15675675675675677, 'eval_header_false_positive_rate': 0.09497206703910614, 'eval_title_false_negative_rate': 0.20833333333333334, 'eval_header_title_confusion_count': 79, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15391, 'INGREDIENT_LINE': 4287, 'INSTRUCTION_STEP': 1965, 'PAGE_HEADER': 393, 'RECIPE_TITLE': 228, 'SECTION_HEADER': 8, 'TEMP': 8}, 'eval_title_anchor_accuracy': 0.16666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 1, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6279, 'eval_samples_per_second': 13.881, 'eval_steps_per_second': 3.47, 'epoch': 18.0}
{'loss': 0.0481, 'grad_norm': 1.5965572595596313, 'learning_rate': 5.268199233716475e-06, 'epoch': 18.1}
{'loss': 0.059, 'grad_norm': 0.6154084801673889, 'learning_rate': 4.07088122605364e-06, 'epoch': 18.53}
{'loss': 0.0508, 'grad_norm': 0.6518428325653076, 'learning_rate': 2.8735632183908046e-06, 'epoch': 18.97}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.14it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.96it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.32it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.11it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.90it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.83it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.69it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.53it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.51it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.59it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.64it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.57it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.58it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.59it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.63it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.63it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.62it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.70it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.60it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.63it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.74it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.10it/s][A                                                   
                                               [A 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [26:14<01:05,  1.76it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.10it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2205/2320 [26:17<06:43,  3.51s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2206/2320 [26:18<05:00,  2.64s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2207/2320 [26:18<03:49,  2.03s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2208/2320 [26:19<03:01,  1.62s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2209/2320 [26:20<02:27,  1.33s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2210/2320 [26:20<02:04,  1.13s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2211/2320 [26:21<01:47,  1.01it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2212/2320 [26:22<01:36,  1.12it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2213/2320 [26:22<01:28,  1.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2214/2320 [26:23<01:22,  1.29it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2215/2320 [26:24<01:17,  1.36it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2216/2320 [26:24<01:13,  1.41it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2217/2320 [26:25<01:11,  1.44it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2218/2320 [26:26<01:08,  1.50it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2219/2320 [26:26<01:06,  1.52it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2220/2320 [26:27<01:03,  1.56it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2221/2320 [26:28<01:03,  1.57it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2222/2320 [26:28<01:01,  1.60it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2223/2320 [26:29<00:59,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2224/2320 [26:29<00:59,  1.60it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2225/2320 [26:30<00:58,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2226/2320 [26:31<00:58,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2227/2320 [26:31<00:57,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2228/2320 [26:32<00:56,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2229/2320 [26:32<00:56,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2230/2320 [26:33<00:56,  1.60it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2231/2320 [26:34<00:54,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2232/2320 [26:34<00:53,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2233/2320 [26:35<00:53,  1.61it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2234/2320 [26:36<00:54,  1.59it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2235/2320 [26:36<00:53,  1.58it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2236/2320 [26:37<00:53,  1.57it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2237/2320 [26:37<00:53,  1.56it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2238/2320 [26:38<00:52,  1.55it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2239/2320 [26:39<00:52,  1.55it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2240/2320 [26:39<00:50,  1.59it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2241/2320 [26:40<00:49,  1.60it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2242/2320 [26:41<00:48,  1.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2243/2320 [26:41<00:48,  1.60it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2244/2320 [26:42<00:46,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2245/2320 [26:42<00:45,  1.64it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2246/2320 [26:43<00:45,  1.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2247/2320 [26:44<00:45,  1.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2248/2320 [26:44<00:44,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2249/2320 [26:45<00:43,  1.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [26:46<00:43,  1.60it/s]                                                    97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [26:46<00:43,  1.60it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2251/2320 [26:46<00:43,  1.59it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2252/2320 [26:47<00:43,  1.57it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2253/2320 [26:48<00:43,  1.56it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2254/2320 [26:48<00:42,  1.55it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2255/2320 [26:49<00:42,  1.54it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2256/2320 [26:49<00:40,  1.58it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2257/2320 [26:50<00:39,  1.58it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2258/2320 [26:51<00:38,  1.60it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2259/2320 [26:51<00:37,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2260/2320 [26:52<00:37,  1.61it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2261/2320 [26:52<00:36,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2262/2320 [26:53<00:36,  1.59it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2263/2320 [26:54<00:36,  1.57it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2264/2320 [26:54<00:35,  1.56it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2265/2320 [26:55<00:35,  1.56it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2266/2320 [26:56<00:34,  1.55it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2267/2320 [26:56<00:33,  1.58it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2268/2320 [26:57<00:33,  1.56it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2269/2320 [26:58<00:33,  1.54it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2270/2320 [26:58<00:32,  1.54it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2271/2320 [26:59<00:32,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2272/2320 [27:00<00:31,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2273/2320 [27:00<00:30,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2274/2320 [27:01<00:30,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2275/2320 [27:02<00:29,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2276/2320 [27:02<00:29,  1.52it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2277/2320 [27:03<00:27,  1.54it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2278/2320 [27:04<00:26,  1.57it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2279/2320 [27:04<00:26,  1.57it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2280/2320 [27:05<00:25,  1.58it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2281/2320 [27:05<00:24,  1.60it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2282/2320 [27:06<00:23,  1.60it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2283/2320 [27:07<00:25,  1.48it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2284/2320 [27:07<00:23,  1.51it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2285/2320 [27:08<00:23,  1.50it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2286/2320 [27:09<00:22,  1.51it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2287/2320 [27:09<00:21,  1.51it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2288/2320 [27:10<00:21,  1.51it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2289/2320 [27:11<00:20,  1.54it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2290/2320 [27:11<00:19,  1.56it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2291/2320 [27:12<00:18,  1.58it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2292/2320 [27:13<00:17,  1.59it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2293/2320 [27:13<00:16,  1.60it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2294/2320 [27:14<00:16,  1.61it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295/2320 [27:14<00:15,  1.60it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2296/2320 [27:15<00:14,  1.60it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2297/2320 [27:16<00:14,  1.57it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2298/2320 [27:17<00:15,  1.46it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2299/2320 [27:17<00:14,  1.48it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [27:18<00:13,  1.49it/s]                                                    99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [27:18<00:13,  1.49it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2301/2320 [27:18<00:12,  1.50it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2302/2320 [27:19<00:11,  1.52it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2303/2320 [27:20<00:10,  1.56it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2304/2320 [27:20<00:10,  1.58it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2305/2320 [27:21<00:09,  1.59it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2306/2320 [27:22<00:08,  1.56it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2307/2320 [27:22<00:08,  1.56it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2308/2320 [27:23<00:07,  1.56it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2309/2320 [27:24<00:07,  1.55it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310/2320 [27:24<00:06,  1.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2311/2320 [27:25<00:05,  1.54it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2312/2320 [27:25<00:05,  1.57it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2313/2320 [27:26<00:04,  1.59it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2314/2320 [27:27<00:03,  1.60it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2315/2320 [27:27<00:03,  1.61it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2316/2320 [27:28<00:02,  1.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2317/2320 [27:29<00:01,  1.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2318/2320 [27:29<00:01,  1.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2319/2320 [27:30<00:00,  1.62it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [27:30<00:00,  1.78it/s]/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.742190957069397, 'eval_precision': 0.9198270780113972, 'eval_recall': 0.670438269836723, 'eval_f1': 0.7755778311656035, 'eval_report': {'PAGE_HEADER': {'precision': 0.6398104265402843, 'recall': 0.4166666666666667, 'f1-score': 0.5046728971962616, 'support': 324.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.556390977443609, 'recall': 0.334841628959276, 'f1-score': 0.4180790960451977, 'support': 221.0}, 'INGREDIENT_LINE': {'precision': 0.7412976886661097, 'recall': 0.7025600422275007, 'f1-score': 0.7214092140921409, 'support': 3789.0}, 'INSTRUCTION_STEP': {'precision': 0.6341976173791171, 'recall': 0.6871678056188307, 'f1-score': 0.6596209912536443, 'support': 2634.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 10.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8711894393032118, 'recall': 0.8822353914002206, 'f1-score': 0.8766776225691592, 'support': 14512.0}, 'accuracy': 0.8134363078068299, 'macro avg': {'precision': 0.4303607686665415, 'recall': 0.3779339418590618, 'f1-score': 0.3975574776445504, 'support': 21494.0}, 'weighted avg': {'precision': 0.8119575506613373, 'recall': 0.8134363078068299, 'f1-score': 0.8118133600445908, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[135, 0, 8, 19, 5, 0, 4, 153], [0, 0, 0, 0, 0, 0, 0, 4], [4, 0, 74, 8, 9, 0, 3, 123], [33, 1, 27, 2662, 96, 0, 1, 969], [34, 0, 24, 132, 1810, 0, 0, 634], [0, 0, 0, 0, 0, 0, 0, 10], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 770, 934, 0, 0, 12803]], 'eval_PAGE_HEADER_precision': 0.2576112412177986, 'eval_PAGE_HEADER_recall': 0.5069124423963134, 'eval_PAGE_HEADER_f1': 0.3416149068322981, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.12749003984063745, 'eval_RECIPE_TITLE_recall': 0.22535211267605634, 'eval_RECIPE_TITLE_f1': 0.16284987277353688, 'eval_header_false_positive_rate': 0.09668508287292818, 'eval_title_false_negative_rate': 0.20909090909090908, 'eval_header_title_confusion_count': 81, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14900, 'INGREDIENT_LINE': 4554, 'INSTRUCTION_STEP': 2127, 'PAGE_HEADER': 427, 'RECIPE_TITLE': 251, 'SECTION_HEADER': 9, 'TEMP': 12}, 'eval_title_anchor_accuracy': 0.16666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 1, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6947, 'eval_samples_per_second': 13.742, 'eval_steps_per_second': 3.436, 'epoch': 19.0}
{'loss': 0.0395, 'grad_norm': 1.3517259359359741, 'learning_rate': 1.6762452107279694e-06, 'epoch': 19.4}
{'loss': 0.0546, 'grad_norm': 0.36256858706474304, 'learning_rate': 4.789272030651341e-07, 'epoch': 19.83}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.62it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.57it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.57it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.26it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.12it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.92it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.81it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.65it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.60it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.48it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.40it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.38it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.39it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.49it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.39it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.37it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.46it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.53it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.52it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.60it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.61it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.93it/s][A                                                   
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [27:40<00:00,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.93it/s][A
                                               [A                                                   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [27:43<00:00,  1.78it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [27:43<00:00,  1.39it/s]
2026-01-12 21:35:29,737 [INFO] Saving final model to models/layoutlmv3_v3_improved...
2026-01-12 21:35:30,916 [INFO] 
================================================================================
2026-01-12 21:35:30,916 [INFO] FINAL EVALUATION
2026-01-12 21:35:30,916 [INFO] ================================================================================
2026-01-12 21:35:30,916 [INFO] 
Evaluating on validation...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.7481802701950073, 'eval_precision': 0.9202273618188945, 'eval_recall': 0.6719622155431516, 'eval_f1': 0.7767391843824965, 'eval_report': {'PAGE_HEADER': {'precision': 0.6445497630331753, 'recall': 0.4171779141104294, 'f1-score': 0.5065176908752328, 'support': 326.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.5488721804511278, 'recall': 0.3395348837209302, 'f1-score': 0.41954022988505746, 'support': 215.0}, 'INGREDIENT_LINE': {'precision': 0.7443609022556391, 'recall': 0.70864262990456, 'f1-score': 0.7260627461632487, 'support': 3772.0}, 'INSTRUCTION_STEP': {'precision': 0.6352487736510161, 'recall': 0.6810668670172803, 'f1-score': 0.6573604060913706, 'support': 2662.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8717338051170387, 'recall': 0.8830909216240436, 'f1-score': 0.8773756120946478, 'support': 14507.0}, 'accuracy': 0.8144598492602587, 'macro avg': {'precision': 0.43059567806349963, 'recall': 0.3786891520471554, 'f1-score': 0.39835708563869465, 'support': 21494.0}, 'weighted avg': {'precision': 0.8129307998113876, 'recall': 0.8144598492602587, 'f1-score': 0.8128787569019573, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[136, 0, 9, 19, 5, 0, 4, 153], [0, 0, 0, 0, 0, 0, 0, 4], [4, 0, 73, 13, 9, 0, 3, 113], [33, 1, 27, 2673, 87, 0, 1, 950], [33, 0, 24, 135, 1813, 0, 0, 657], [0, 0, 0, 0, 0, 0, 0, 8], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 751, 940, 0, 0, 12811]], 'eval_PAGE_HEADER_precision': 0.26157407407407407, 'eval_PAGE_HEADER_recall': 0.5207373271889401, 'eval_PAGE_HEADER_f1': 0.3482280431432974, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.125, 'eval_RECIPE_TITLE_recall': 0.21830985915492956, 'eval_RECIPE_TITLE_f1': 0.15897435897435896, 'eval_header_false_positive_rate': 0.0958904109589041, 'eval_title_false_negative_rate': 0.2100456621004566, 'eval_header_title_confusion_count': 81, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14914, 'INGREDIENT_LINE': 4122, 'INSTRUCTION_STEP': 2876, 'PAGE_HEADER': 217, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14902, 'INGREDIENT_LINE': 4517, 'INSTRUCTION_STEP': 2162, 'PAGE_HEADER': 432, 'RECIPE_TITLE': 248, 'SECTION_HEADER': 9, 'TEMP': 10}, 'eval_title_anchor_accuracy': 0.3333333333333333, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 2, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.973, 'eval_samples_per_second': 13.194, 'eval_steps_per_second': 3.298, 'epoch': 20.0}
{'train_runtime': 1663.6904, 'train_samples_per_second': 5.566, 'train_steps_per_second': 1.394, 'train_loss': 0.46407353913989563, 'epoch': 20.0}
  0%|          | 0/23 [00:00<?, ?it/s]  9%|â–Š         | 2/23 [00:00<00:02,  7.89it/s] 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.36it/s] 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.60it/s] 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.10it/s] 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.95it/s] 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.84it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.52it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.69it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.79it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.77it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.73it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.80it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.79it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.87it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.91it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.88it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.84it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.83it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.90it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.72it/s]
2026-01-12 21:35:37,610 [INFO] 
Evaluating on test...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/16 [00:00<?, ?it/s] 12%|â–ˆâ–Ž        | 2/16 [00:00<00:01,  7.32it/s] 19%|â–ˆâ–‰        | 3/16 [00:00<00:02,  5.32it/s] 25%|â–ˆâ–ˆâ–Œ       | 4/16 [00:00<00:02,  4.58it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 5/16 [00:01<00:02,  4.23it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 6/16 [00:01<00:02,  4.07it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 7/16 [00:01<00:02,  3.92it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 8/16 [00:01<00:02,  3.84it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 9/16 [00:02<00:01,  3.86it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 10/16 [00:02<00:01,  3.74it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 11/16 [00:02<00:01,  3.74it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 12/16 [00:03<00:01,  3.56it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 13/16 [00:03<00:00,  3.54it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 14/16 [00:03<00:00,  3.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 15/16 [00:03<00:00,  3.89it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 16/16 [00:04<00:00,  3.97it/s]
2026-01-12 21:35:42,009 [INFO] 
Evaluating on demo_eval...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/2 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 14.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 11.76it/s]
2026-01-12 21:35:42,579 [INFO] âœ“ Training complete!
2026-01-12 21:35:42,579 [INFO] âœ“ Model saved to: models/layoutlmv3_v3_improved
2026-01-12 21:35:42,580 [INFO] âœ“ Report saved to: models/layoutlmv3_v3_improved/training_report.json

================================================================================
DEMO SCORECARD - Header-Aware Evaluation
================================================================================

ðŸ“ Title Anchor Accuracy
  Anchor Accuracy (IoU >= 0.3): 0.0%
  Pages with correct anchor: 0 / 0

ðŸŽ¯ Recipe Title Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ“„ Page Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ”€ Section Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

âš ï¸  Critical Errors
  Headerâ†’Title confusion count: 0
  Header false positive rate:   0.0%
  Title false negative rate:    0.0%

ðŸ“Š Ingredient & Instruction F1
  Ingredients: 0.0%
  Instructions: 0.0%
================================================================================


================================================================================
TRAINING SUMMARY
================================================================================
Best checkpoint: models/layoutlmv3_v3_improved
Demo eval title anchor accuracy: 0.0%
Demo eval headerâ†’title confusion: 0 tokens
================================================================================

