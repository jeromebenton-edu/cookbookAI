2026-01-13 11:11:17,353 [INFO] Using v3 label taxonomy: 10 labels
2026-01-13 11:11:17,353 [INFO] Loading dataset from data/datasets/boston_layoutlmv3_v3_manual/dataset_dict...
2026-01-13 11:11:17,366 [INFO] Dataset loaded:
2026-01-13 11:11:17,366 [INFO]   train: 463 examples
2026-01-13 11:11:17,366 [INFO]   validation: 92 examples
2026-01-13 11:11:17,366 [INFO]   test: 61 examples
2026-01-13 11:11:17,366 [INFO]   demo_eval: 7 examples
2026-01-13 11:11:17,366 [INFO] Initializing LayoutLMv3 processor and model...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:1601: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be depracted in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Some weights of LayoutLMv3ForTokenClassification were not initialized from the model checkpoint at microsoft/layoutlmv3-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2026-01-13 11:11:18,132 [INFO] Model initialized with 10 labels
2026-01-13 11:11:18,133 [INFO] Computing class weights from training data...
2026-01-13 11:11:18,696 [INFO] Class weights computed:
2026-01-13 11:11:18,697 [INFO]   PAGE_HEADER         : weight=5.04, count=2193
2026-01-13 11:11:18,697 [INFO]   SECTION_HEADER      : weight=481.16, count=22
2026-01-13 11:11:18,697 [INFO]   RECIPE_TITLE        : weight=6.21, count=1781
2026-01-13 11:11:18,697 [INFO]   INGREDIENT_LINE     : weight=0.62, count=17944
2026-01-13 11:11:18,697 [INFO]   INSTRUCTION_STEP    : weight=0.82, count=13543
2026-01-13 11:11:18,697 [INFO]   TIME                : weight=11066.70, count=0
2026-01-13 11:11:18,697 [INFO]   TEMP                : weight=481.16, count=22
2026-01-13 11:11:18,697 [INFO]   SERVINGS            : weight=356.99, count=30
2026-01-13 11:11:18,697 [INFO]   NOTE                : weight=11066.70, count=0
2026-01-13 11:11:18,697 [INFO]   O                   : weight=0.15, count=75132
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/training_args.py:1525: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of ðŸ¤— Transformers. Use `eval_strategy` instead
  warnings.warn(
2026-01-13 11:11:20,803 [INFO] Starting training...
  0%|          | 0/2320 [00:00<?, ?it/s]/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 1/2320 [00:01<55:54,  1.45s/it]  0%|          | 2/2320 [00:02<36:31,  1.06it/s]  0%|          | 3/2320 [00:02<30:15,  1.28it/s]  0%|          | 4/2320 [00:03<27:27,  1.41it/s]  0%|          | 5/2320 [00:03<26:00,  1.48it/s]  0%|          | 6/2320 [00:04<24:46,  1.56it/s]  0%|          | 7/2320 [00:04<23:56,  1.61it/s]  0%|          | 8/2320 [00:05<23:17,  1.65it/s]  0%|          | 9/2320 [00:06<22:53,  1.68it/s]  0%|          | 10/2320 [00:06<22:54,  1.68it/s]  0%|          | 11/2320 [00:07<22:38,  1.70it/s]  1%|          | 12/2320 [00:07<22:27,  1.71it/s]  1%|          | 13/2320 [00:08<22:28,  1.71it/s]  1%|          | 14/2320 [00:09<22:26,  1.71it/s]  1%|          | 15/2320 [00:09<22:17,  1.72it/s]  1%|          | 16/2320 [00:10<22:02,  1.74it/s]  1%|          | 17/2320 [00:10<22:01,  1.74it/s]  1%|          | 18/2320 [00:11<21:51,  1.76it/s]  1%|          | 19/2320 [00:11<21:56,  1.75it/s]  1%|          | 20/2320 [00:12<22:08,  1.73it/s]  1%|          | 21/2320 [00:13<22:29,  1.70it/s]  1%|          | 22/2320 [00:13<22:13,  1.72it/s]  1%|          | 23/2320 [00:14<21:59,  1.74it/s]  1%|          | 24/2320 [00:14<21:54,  1.75it/s]  1%|          | 25/2320 [00:15<21:54,  1.75it/s]  1%|          | 26/2320 [00:15<21:42,  1.76it/s]  1%|          | 27/2320 [00:16<21:46,  1.75it/s]  1%|          | 28/2320 [00:17<21:52,  1.75it/s]  1%|â–         | 29/2320 [00:17<21:56,  1.74it/s]  1%|â–         | 30/2320 [00:18<22:00,  1.73it/s]  1%|â–         | 31/2320 [00:18<21:50,  1.75it/s]  1%|â–         | 32/2320 [00:19<21:46,  1.75it/s]  1%|â–         | 33/2320 [00:19<22:19,  1.71it/s]  1%|â–         | 34/2320 [00:20<22:07,  1.72it/s]  2%|â–         | 35/2320 [00:21<22:24,  1.70it/s]  2%|â–         | 36/2320 [00:21<22:17,  1.71it/s]  2%|â–         | 37/2320 [00:22<22:11,  1.71it/s]  2%|â–         | 38/2320 [00:22<22:05,  1.72it/s]  2%|â–         | 39/2320 [00:23<22:07,  1.72it/s]  2%|â–         | 40/2320 [00:24<22:16,  1.71it/s]  2%|â–         | 41/2320 [00:24<22:19,  1.70it/s]  2%|â–         | 42/2320 [00:25<22:28,  1.69it/s]  2%|â–         | 43/2320 [00:25<22:15,  1.71it/s]  2%|â–         | 44/2320 [00:26<22:13,  1.71it/s]  2%|â–         | 45/2320 [00:26<22:04,  1.72it/s]  2%|â–         | 46/2320 [00:27<22:04,  1.72it/s]  2%|â–         | 47/2320 [00:28<22:02,  1.72it/s]  2%|â–         | 48/2320 [00:28<22:15,  1.70it/s]  2%|â–         | 49/2320 [00:29<22:09,  1.71it/s]  2%|â–         | 50/2320 [00:29<22:05,  1.71it/s]                                                   2%|â–         | 50/2320 [00:29<22:05,  1.71it/s]  2%|â–         | 51/2320 [00:30<22:02,  1.72it/s]  2%|â–         | 52/2320 [00:31<21:55,  1.72it/s]  2%|â–         | 53/2320 [00:31<21:56,  1.72it/s]  2%|â–         | 54/2320 [00:32<21:54,  1.72it/s]  2%|â–         | 55/2320 [00:32<22:01,  1.71it/s]  2%|â–         | 56/2320 [00:33<21:57,  1.72it/s]  2%|â–         | 57/2320 [00:33<22:05,  1.71it/s]  2%|â–Ž         | 58/2320 [00:34<22:02,  1.71it/s]  3%|â–Ž         | 59/2320 [00:35<22:03,  1.71it/s]  3%|â–Ž         | 60/2320 [00:35<22:02,  1.71it/s]  3%|â–Ž         | 61/2320 [00:36<21:54,  1.72it/s]  3%|â–Ž         | 62/2320 [00:36<21:47,  1.73it/s]  3%|â–Ž         | 63/2320 [00:37<21:46,  1.73it/s]  3%|â–Ž         | 64/2320 [00:38<21:52,  1.72it/s]  3%|â–Ž         | 65/2320 [00:38<21:50,  1.72it/s]  3%|â–Ž         | 66/2320 [00:39<21:49,  1.72it/s]  3%|â–Ž         | 67/2320 [00:39<21:46,  1.72it/s]  3%|â–Ž         | 68/2320 [00:40<21:59,  1.71it/s]  3%|â–Ž         | 69/2320 [00:40<22:01,  1.70it/s]  3%|â–Ž         | 70/2320 [00:41<22:05,  1.70it/s]  3%|â–Ž         | 71/2320 [00:42<21:59,  1.70it/s]  3%|â–Ž         | 72/2320 [00:42<22:07,  1.69it/s]  3%|â–Ž         | 73/2320 [00:43<22:02,  1.70it/s]  3%|â–Ž         | 74/2320 [00:43<21:54,  1.71it/s]  3%|â–Ž         | 75/2320 [00:44<21:43,  1.72it/s]  3%|â–Ž         | 76/2320 [00:45<21:46,  1.72it/s]  3%|â–Ž         | 77/2320 [00:45<23:19,  1.60it/s]  3%|â–Ž         | 78/2320 [00:46<23:00,  1.62it/s]  3%|â–Ž         | 79/2320 [00:46<22:32,  1.66it/s]  3%|â–Ž         | 80/2320 [00:47<22:13,  1.68it/s]  3%|â–Ž         | 81/2320 [00:48<22:23,  1.67it/s]  4%|â–Ž         | 82/2320 [00:48<22:14,  1.68it/s]  4%|â–Ž         | 83/2320 [00:49<22:26,  1.66it/s]  4%|â–Ž         | 84/2320 [00:49<22:23,  1.66it/s]  4%|â–Ž         | 85/2320 [00:50<22:18,  1.67it/s]  4%|â–Ž         | 86/2320 [00:51<22:40,  1.64it/s]  4%|â–         | 87/2320 [00:51<22:23,  1.66it/s]  4%|â–         | 88/2320 [00:52<22:10,  1.68it/s]  4%|â–         | 89/2320 [00:52<22:04,  1.68it/s]  4%|â–         | 90/2320 [00:53<22:00,  1.69it/s]  4%|â–         | 91/2320 [00:54<21:56,  1.69it/s]  4%|â–         | 92/2320 [00:54<21:53,  1.70it/s]  4%|â–         | 93/2320 [00:55<22:03,  1.68it/s]  4%|â–         | 94/2320 [00:55<21:56,  1.69it/s]  4%|â–         | 95/2320 [00:56<21:54,  1.69it/s]  4%|â–         | 96/2320 [00:57<21:48,  1.70it/s]  4%|â–         | 97/2320 [00:57<21:55,  1.69it/s]  4%|â–         | 98/2320 [00:58<21:46,  1.70it/s]  4%|â–         | 99/2320 [00:58<21:55,  1.69it/s]  4%|â–         | 100/2320 [00:59<21:55,  1.69it/s]                                                    4%|â–         | 100/2320 [00:59<21:55,  1.69it/s]  4%|â–         | 101/2320 [01:00<21:57,  1.68it/s]  4%|â–         | 102/2320 [01:00<21:42,  1.70it/s]  4%|â–         | 103/2320 [01:01<21:36,  1.71it/s]  4%|â–         | 104/2320 [01:01<21:39,  1.71it/s]  5%|â–         | 105/2320 [01:02<21:39,  1.70it/s]  5%|â–         | 106/2320 [01:02<21:47,  1.69it/s]  5%|â–         | 107/2320 [01:03<21:40,  1.70it/s]  5%|â–         | 108/2320 [01:04<21:33,  1.71it/s]  5%|â–         | 109/2320 [01:04<21:34,  1.71it/s]  5%|â–         | 110/2320 [01:05<21:31,  1.71it/s]  5%|â–         | 111/2320 [01:05<21:29,  1.71it/s]  5%|â–         | 112/2320 [01:06<21:31,  1.71it/s]  5%|â–         | 113/2320 [01:07<21:28,  1.71it/s]  5%|â–         | 114/2320 [01:07<21:29,  1.71it/s]  5%|â–         | 115/2320 [01:08<21:13,  1.73it/s]  5%|â–Œ         | 116/2320 [01:08<19:06,  1.92it/s]{'loss': 1.966, 'grad_norm': 4.420489311218262, 'learning_rate': 1.0775862068965516e-05, 'epoch': 0.43}
{'loss': 1.6751, 'grad_norm': 6.479526042938232, 'learning_rate': 2.1551724137931033e-05, 'epoch': 0.86}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.50it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.25it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.52it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.24it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.13it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.87it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.75it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.71it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.70it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.72it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.75it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.74it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.64it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.67it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.71it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.70it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.72it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.75it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.61it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.74it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.16it/s][A                                                  
                                               [A  5%|â–Œ         | 116/2320 [01:15<19:06,  1.92it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.16it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  5%|â–Œ         | 117/2320 [01:21<2:33:27,  4.18s/it]  5%|â–Œ         | 118/2320 [01:21<1:53:33,  3.09s/it]  5%|â–Œ         | 119/2320 [01:22<1:25:56,  2.34s/it]  5%|â–Œ         | 120/2320 [01:23<1:06:31,  1.81s/it]  5%|â–Œ         | 121/2320 [01:23<52:58,  1.45s/it]    5%|â–Œ         | 122/2320 [01:24<43:21,  1.18s/it]  5%|â–Œ         | 123/2320 [01:24<36:50,  1.01s/it]  5%|â–Œ         | 124/2320 [01:25<32:01,  1.14it/s]  5%|â–Œ         | 125/2320 [01:25<28:45,  1.27it/s]  5%|â–Œ         | 126/2320 [01:26<26:38,  1.37it/s]  5%|â–Œ         | 127/2320 [01:27<25:13,  1.45it/s]  6%|â–Œ         | 128/2320 [01:27<24:14,  1.51it/s]  6%|â–Œ         | 129/2320 [01:28<23:29,  1.55it/s]  6%|â–Œ         | 130/2320 [01:28<22:58,  1.59it/s]  6%|â–Œ         | 131/2320 [01:29<22:36,  1.61it/s]  6%|â–Œ         | 132/2320 [01:30<22:06,  1.65it/s]  6%|â–Œ         | 133/2320 [01:30<21:43,  1.68it/s]  6%|â–Œ         | 134/2320 [01:31<21:26,  1.70it/s]  6%|â–Œ         | 135/2320 [01:31<21:16,  1.71it/s]  6%|â–Œ         | 136/2320 [01:32<21:21,  1.70it/s]  6%|â–Œ         | 137/2320 [01:32<21:07,  1.72it/s]  6%|â–Œ         | 138/2320 [01:33<21:05,  1.72it/s]  6%|â–Œ         | 139/2320 [01:34<21:05,  1.72it/s]  6%|â–Œ         | 140/2320 [01:34<21:11,  1.71it/s]  6%|â–Œ         | 141/2320 [01:35<21:03,  1.72it/s]  6%|â–Œ         | 142/2320 [01:35<20:57,  1.73it/s]  6%|â–Œ         | 143/2320 [01:36<21:05,  1.72it/s]  6%|â–Œ         | 144/2320 [01:37<20:54,  1.73it/s]  6%|â–‹         | 145/2320 [01:37<20:48,  1.74it/s]  6%|â–‹         | 146/2320 [01:38<20:51,  1.74it/s]  6%|â–‹         | 147/2320 [01:38<21:05,  1.72it/s]  6%|â–‹         | 148/2320 [01:39<21:03,  1.72it/s]  6%|â–‹         | 149/2320 [01:39<21:00,  1.72it/s]  6%|â–‹         | 150/2320 [01:40<21:01,  1.72it/s]                                                    6%|â–‹         | 150/2320 [01:40<21:01,  1.72it/s]  7%|â–‹         | 151/2320 [01:41<20:46,  1.74it/s]  7%|â–‹         | 152/2320 [01:41<20:50,  1.73it/s]  7%|â–‹         | 153/2320 [01:42<20:47,  1.74it/s]  7%|â–‹         | 154/2320 [01:42<20:53,  1.73it/s]  7%|â–‹         | 155/2320 [01:43<20:58,  1.72it/s]  7%|â–‹         | 156/2320 [01:43<21:06,  1.71it/s]  7%|â–‹         | 157/2320 [01:44<21:00,  1.72it/s]  7%|â–‹         | 158/2320 [01:45<20:59,  1.72it/s]  7%|â–‹         | 159/2320 [01:45<20:57,  1.72it/s]  7%|â–‹         | 160/2320 [01:46<21:11,  1.70it/s]  7%|â–‹         | 161/2320 [01:46<20:55,  1.72it/s]  7%|â–‹         | 162/2320 [01:47<20:50,  1.73it/s]  7%|â–‹         | 163/2320 [01:48<20:56,  1.72it/s]  7%|â–‹         | 164/2320 [01:48<20:58,  1.71it/s]  7%|â–‹         | 165/2320 [01:49<20:48,  1.73it/s]  7%|â–‹         | 166/2320 [01:49<20:52,  1.72it/s]  7%|â–‹         | 167/2320 [01:50<20:45,  1.73it/s]  7%|â–‹         | 168/2320 [01:50<20:43,  1.73it/s]  7%|â–‹         | 169/2320 [01:51<20:46,  1.72it/s]  7%|â–‹         | 170/2320 [01:52<20:47,  1.72it/s]  7%|â–‹         | 171/2320 [01:52<20:51,  1.72it/s]  7%|â–‹         | 172/2320 [01:53<20:51,  1.72it/s]  7%|â–‹         | 173/2320 [01:53<20:50,  1.72it/s]  8%|â–Š         | 174/2320 [01:54<20:45,  1.72it/s]  8%|â–Š         | 175/2320 [01:55<20:41,  1.73it/s]  8%|â–Š         | 176/2320 [01:55<20:51,  1.71it/s]  8%|â–Š         | 177/2320 [01:56<20:56,  1.71it/s]  8%|â–Š         | 178/2320 [01:56<21:02,  1.70it/s]  8%|â–Š         | 179/2320 [01:57<21:09,  1.69it/s]  8%|â–Š         | 180/2320 [01:57<21:02,  1.69it/s]  8%|â–Š         | 181/2320 [01:58<20:59,  1.70it/s]  8%|â–Š         | 182/2320 [01:59<20:48,  1.71it/s]  8%|â–Š         | 183/2320 [01:59<21:10,  1.68it/s]  8%|â–Š         | 184/2320 [02:00<21:00,  1.70it/s]  8%|â–Š         | 185/2320 [02:00<20:52,  1.70it/s]  8%|â–Š         | 186/2320 [02:01<20:50,  1.71it/s]  8%|â–Š         | 187/2320 [02:02<20:46,  1.71it/s]  8%|â–Š         | 188/2320 [02:02<20:53,  1.70it/s]  8%|â–Š         | 189/2320 [02:03<21:03,  1.69it/s]  8%|â–Š         | 190/2320 [02:03<20:59,  1.69it/s]  8%|â–Š         | 191/2320 [02:04<20:54,  1.70it/s]  8%|â–Š         | 192/2320 [02:05<20:49,  1.70it/s]  8%|â–Š         | 193/2320 [02:05<20:46,  1.71it/s]  8%|â–Š         | 194/2320 [02:06<20:39,  1.72it/s]  8%|â–Š         | 195/2320 [02:06<20:44,  1.71it/s]  8%|â–Š         | 196/2320 [02:07<20:39,  1.71it/s]  8%|â–Š         | 197/2320 [02:07<20:41,  1.71it/s]  9%|â–Š         | 198/2320 [02:08<20:41,  1.71it/s]  9%|â–Š         | 199/2320 [02:09<20:49,  1.70it/s]  9%|â–Š         | 200/2320 [02:09<20:52,  1.69it/s]                                                    9%|â–Š         | 200/2320 [02:09<20:52,  1.69it/s]  9%|â–Š         | 201/2320 [02:10<20:47,  1.70it/s]  9%|â–Š         | 202/2320 [02:10<20:53,  1.69it/s]  9%|â–‰         | 203/2320 [02:11<20:55,  1.69it/s]  9%|â–‰         | 204/2320 [02:12<20:52,  1.69it/s]  9%|â–‰         | 205/2320 [02:12<20:43,  1.70it/s]  9%|â–‰         | 206/2320 [02:13<20:30,  1.72it/s]  9%|â–‰         | 207/2320 [02:13<20:51,  1.69it/s]  9%|â–‰         | 208/2320 [02:14<21:22,  1.65it/s]  9%|â–‰         | 209/2320 [02:15<21:41,  1.62it/s]  9%|â–‰         | 210/2320 [02:15<21:47,  1.61it/s]  9%|â–‰         | 211/2320 [02:16<21:35,  1.63it/s]  9%|â–‰         | 212/2320 [02:16<21:32,  1.63it/s]  9%|â–‰         | 213/2320 [02:17<21:26,  1.64it/s]  9%|â–‰         | 214/2320 [02:18<21:23,  1.64it/s]  9%|â–‰         | 215/2320 [02:18<21:24,  1.64it/s]  9%|â–‰         | 216/2320 [02:19<21:15,  1.65it/s]  9%|â–‰         | 217/2320 [02:20<21:37,  1.62it/s]  9%|â–‰         | 218/2320 [02:20<21:50,  1.60it/s]  9%|â–‰         | 219/2320 [02:21<21:42,  1.61it/s]  9%|â–‰         | 220/2320 [02:21<21:41,  1.61it/s] 10%|â–‰         | 221/2320 [02:22<21:27,  1.63it/s] 10%|â–‰         | 222/2320 [02:23<21:27,  1.63it/s] 10%|â–‰         | 223/2320 [02:23<21:25,  1.63it/s] 10%|â–‰         | 224/2320 [02:24<21:18,  1.64it/s] 10%|â–‰         | 225/2320 [02:24<21:17,  1.64it/s] 10%|â–‰         | 226/2320 [02:25<21:00,  1.66it/s] 10%|â–‰         | 227/2320 [02:26<21:24,  1.63it/s] 10%|â–‰         | 228/2320 [02:26<21:48,  1.60it/s] 10%|â–‰         | 229/2320 [02:27<21:53,  1.59it/s] 10%|â–‰         | 230/2320 [02:28<21:42,  1.60it/s] 10%|â–‰         | 231/2320 [02:28<21:29,  1.62it/s] 10%|â–ˆ         | 232/2320 [02:29<19:18,  1.80it/s]{'eval_loss': 1.4659978151321411, 'eval_precision': 0.8757637474541752, 'eval_recall': 0.3651804670912951, 'eval_f1': 0.5154330236739586, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'INGREDIENT_LINE': {'precision': 0.13613861386138615, 'recall': 0.8490566037735849, 'f1-score': 0.23465276131784782, 'support': 583.0}, 'INSTRUCTION_STEP': {'precision': 0.4278728606356968, 'recall': 0.29682578143930216, 'f1-score': 0.35050071530758226, 'support': 4127.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.812406066402514, 'recall': 0.7085319351763585, 'f1-score': 0.7569219018522054, 'support': 16784.0}, 'accuracy': 0.6332930120033498, 'macro avg': {'precision': 0.19663107727137102, 'recall': 0.2649163314841779, 'f1-score': 0.19172505406823362, 'support': 21494.0}, 'weighted avg': {'precision': 0.7202299956371314, 'recall': 0.6332930120033498, 'f1-score': 0.6647202108779247, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [8, 0, 0, 495, 12, 0, 68], [0, 0, 0, 224, 1225, 0, 2678], [0, 0, 0, 0, 0, 0, 0], [207, 1, 133, 2917, 1626, 8, 11892]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 1994, 'O': 19767, 'INGREDIENT_LINE': 519}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.5021, 'eval_samples_per_second': 14.149, 'eval_steps_per_second': 3.537, 'epoch': 1.0}
{'loss': 1.5716, 'grad_norm': 2.433784008026123, 'learning_rate': 3.232758620689655e-05, 'epoch': 1.29}
{'loss': 1.5134, 'grad_norm': 4.743434906005859, 'learning_rate': 4.3103448275862066e-05, 'epoch': 1.72}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.96it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.48it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.73it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.42it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.18it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:03,  4.10it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.93it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.89it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.90it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.91it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.95it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.81it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.70it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.77it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:03<00:01,  3.72it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.73it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.76it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.82it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:04<00:00,  3.81it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.80it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.88it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.27it/s][A                                                  
                                               [A 10%|â–ˆ         | 232/2320 [02:35<19:18,  1.80it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.27it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 10%|â–ˆ         | 233/2320 [02:41<2:22:41,  4.10s/it] 10%|â–ˆ         | 234/2320 [02:42<1:45:53,  3.05s/it] 10%|â–ˆ         | 235/2320 [02:42<1:20:05,  2.30s/it] 10%|â–ˆ         | 236/2320 [02:43<1:01:57,  1.78s/it] 10%|â–ˆ         | 237/2320 [02:43<49:20,  1.42s/it]   10%|â–ˆ         | 238/2320 [02:44<41:58,  1.21s/it] 10%|â–ˆ         | 239/2320 [02:45<35:31,  1.02s/it] 10%|â–ˆ         | 240/2320 [02:45<30:49,  1.12it/s] 10%|â–ˆ         | 241/2320 [02:46<27:28,  1.26it/s] 10%|â–ˆ         | 242/2320 [02:46<25:07,  1.38it/s] 10%|â–ˆ         | 243/2320 [02:47<23:36,  1.47it/s] 11%|â–ˆ         | 244/2320 [02:47<22:34,  1.53it/s] 11%|â–ˆ         | 245/2320 [02:48<21:59,  1.57it/s] 11%|â–ˆ         | 246/2320 [02:49<21:20,  1.62it/s] 11%|â–ˆ         | 247/2320 [02:49<20:54,  1.65it/s] 11%|â–ˆ         | 248/2320 [02:50<20:26,  1.69it/s] 11%|â–ˆ         | 249/2320 [02:50<20:10,  1.71it/s] 11%|â–ˆ         | 250/2320 [02:51<19:59,  1.73it/s]                                                   11%|â–ˆ         | 250/2320 [02:51<19:59,  1.73it/s] 11%|â–ˆ         | 251/2320 [02:51<20:01,  1.72it/s] 11%|â–ˆ         | 252/2320 [02:52<20:00,  1.72it/s] 11%|â–ˆ         | 253/2320 [02:53<19:56,  1.73it/s] 11%|â–ˆ         | 254/2320 [02:53<20:02,  1.72it/s] 11%|â–ˆ         | 255/2320 [02:54<19:58,  1.72it/s] 11%|â–ˆ         | 256/2320 [02:54<19:53,  1.73it/s] 11%|â–ˆ         | 257/2320 [02:55<19:49,  1.73it/s] 11%|â–ˆ         | 258/2320 [02:56<19:47,  1.74it/s] 11%|â–ˆ         | 259/2320 [02:56<19:44,  1.74it/s] 11%|â–ˆ         | 260/2320 [02:57<19:45,  1.74it/s] 11%|â–ˆâ–        | 261/2320 [02:57<19:55,  1.72it/s] 11%|â–ˆâ–        | 262/2320 [02:58<19:55,  1.72it/s] 11%|â–ˆâ–        | 263/2320 [02:58<19:59,  1.71it/s] 11%|â–ˆâ–        | 264/2320 [02:59<20:29,  1.67it/s] 11%|â–ˆâ–        | 265/2320 [03:00<20:56,  1.63it/s] 11%|â–ˆâ–        | 266/2320 [03:00<21:11,  1.62it/s] 12%|â–ˆâ–        | 267/2320 [03:01<21:04,  1.62it/s] 12%|â–ˆâ–        | 268/2320 [03:02<20:54,  1.64it/s] 12%|â–ˆâ–        | 269/2320 [03:02<20:46,  1.65it/s] 12%|â–ˆâ–        | 270/2320 [03:03<20:28,  1.67it/s] 12%|â–ˆâ–        | 271/2320 [03:03<20:22,  1.68it/s] 12%|â–ˆâ–        | 272/2320 [03:04<20:30,  1.66it/s] 12%|â–ˆâ–        | 273/2320 [03:05<20:24,  1.67it/s] 12%|â–ˆâ–        | 274/2320 [03:05<20:17,  1.68it/s] 12%|â–ˆâ–        | 275/2320 [03:06<20:19,  1.68it/s] 12%|â–ˆâ–        | 276/2320 [03:06<20:39,  1.65it/s] 12%|â–ˆâ–        | 277/2320 [03:07<21:01,  1.62it/s] 12%|â–ˆâ–        | 278/2320 [03:08<21:10,  1.61it/s] 12%|â–ˆâ–        | 279/2320 [03:08<21:23,  1.59it/s] 12%|â–ˆâ–        | 280/2320 [03:09<21:40,  1.57it/s] 12%|â–ˆâ–        | 281/2320 [03:10<21:33,  1.58it/s] 12%|â–ˆâ–        | 282/2320 [03:10<21:37,  1.57it/s] 12%|â–ˆâ–        | 283/2320 [03:11<21:11,  1.60it/s] 12%|â–ˆâ–        | 284/2320 [03:11<20:47,  1.63it/s] 12%|â–ˆâ–        | 285/2320 [03:12<20:55,  1.62it/s] 12%|â–ˆâ–        | 286/2320 [03:13<20:56,  1.62it/s] 12%|â–ˆâ–        | 287/2320 [03:13<21:01,  1.61it/s] 12%|â–ˆâ–        | 288/2320 [03:14<20:47,  1.63it/s] 12%|â–ˆâ–        | 289/2320 [03:14<20:28,  1.65it/s] 12%|â–ˆâ–Ž        | 290/2320 [03:15<20:20,  1.66it/s] 13%|â–ˆâ–Ž        | 291/2320 [03:16<20:42,  1.63it/s] 13%|â–ˆâ–Ž        | 292/2320 [03:16<20:29,  1.65it/s] 13%|â–ˆâ–Ž        | 293/2320 [03:17<20:44,  1.63it/s] 13%|â–ˆâ–Ž        | 294/2320 [03:18<21:05,  1.60it/s] 13%|â–ˆâ–Ž        | 295/2320 [03:18<21:21,  1.58it/s] 13%|â–ˆâ–Ž        | 296/2320 [03:19<21:25,  1.57it/s] 13%|â–ˆâ–Ž        | 297/2320 [03:19<21:33,  1.56it/s] 13%|â–ˆâ–Ž        | 298/2320 [03:20<21:50,  1.54it/s] 13%|â–ˆâ–Ž        | 299/2320 [03:21<21:28,  1.57it/s] 13%|â–ˆâ–Ž        | 300/2320 [03:21<21:31,  1.56it/s]                                                   13%|â–ˆâ–Ž        | 300/2320 [03:21<21:31,  1.56it/s] 13%|â–ˆâ–Ž        | 301/2320 [03:22<21:29,  1.57it/s] 13%|â–ˆâ–Ž        | 302/2320 [03:23<21:37,  1.56it/s] 13%|â–ˆâ–Ž        | 303/2320 [03:23<21:29,  1.56it/s] 13%|â–ˆâ–Ž        | 304/2320 [03:24<21:17,  1.58it/s] 13%|â–ˆâ–Ž        | 305/2320 [03:25<21:21,  1.57it/s] 13%|â–ˆâ–Ž        | 306/2320 [03:25<21:26,  1.56it/s] 13%|â–ˆâ–Ž        | 307/2320 [03:26<21:36,  1.55it/s] 13%|â–ˆâ–Ž        | 308/2320 [03:27<21:29,  1.56it/s] 13%|â–ˆâ–Ž        | 309/2320 [03:27<21:03,  1.59it/s] 13%|â–ˆâ–Ž        | 310/2320 [03:28<21:15,  1.58it/s] 13%|â–ˆâ–Ž        | 311/2320 [03:28<21:06,  1.59it/s] 13%|â–ˆâ–Ž        | 312/2320 [03:29<20:59,  1.59it/s] 13%|â–ˆâ–Ž        | 313/2320 [03:30<21:01,  1.59it/s] 14%|â–ˆâ–Ž        | 314/2320 [03:30<20:41,  1.62it/s] 14%|â–ˆâ–Ž        | 315/2320 [03:31<20:41,  1.61it/s] 14%|â–ˆâ–Ž        | 316/2320 [03:31<20:22,  1.64it/s] 14%|â–ˆâ–Ž        | 317/2320 [03:32<20:06,  1.66it/s] 14%|â–ˆâ–Ž        | 318/2320 [03:33<20:25,  1.63it/s] 14%|â–ˆâ–        | 319/2320 [03:33<20:50,  1.60it/s] 14%|â–ˆâ–        | 320/2320 [03:34<20:53,  1.60it/s] 14%|â–ˆâ–        | 321/2320 [03:35<20:45,  1.60it/s] 14%|â–ˆâ–        | 322/2320 [03:35<20:45,  1.60it/s] 14%|â–ˆâ–        | 323/2320 [03:36<20:42,  1.61it/s] 14%|â–ˆâ–        | 324/2320 [03:36<20:21,  1.63it/s] 14%|â–ˆâ–        | 325/2320 [03:37<20:36,  1.61it/s] 14%|â–ˆâ–        | 326/2320 [03:38<20:27,  1.62it/s] 14%|â–ˆâ–        | 327/2320 [03:38<20:17,  1.64it/s] 14%|â–ˆâ–        | 328/2320 [03:39<20:06,  1.65it/s] 14%|â–ˆâ–        | 329/2320 [03:39<20:25,  1.62it/s] 14%|â–ˆâ–        | 330/2320 [03:40<20:26,  1.62it/s] 14%|â–ˆâ–        | 331/2320 [03:41<20:20,  1.63it/s] 14%|â–ˆâ–        | 332/2320 [03:41<20:29,  1.62it/s] 14%|â–ˆâ–        | 333/2320 [03:42<20:19,  1.63it/s] 14%|â–ˆâ–        | 334/2320 [03:43<20:22,  1.63it/s] 14%|â–ˆâ–        | 335/2320 [03:43<20:34,  1.61it/s] 14%|â–ˆâ–        | 336/2320 [03:44<20:23,  1.62it/s] 15%|â–ˆâ–        | 337/2320 [03:44<20:19,  1.63it/s] 15%|â–ˆâ–        | 338/2320 [03:45<20:17,  1.63it/s] 15%|â–ˆâ–        | 339/2320 [03:46<19:54,  1.66it/s] 15%|â–ˆâ–        | 340/2320 [03:46<20:16,  1.63it/s] 15%|â–ˆâ–        | 341/2320 [03:47<20:03,  1.64it/s] 15%|â–ˆâ–        | 342/2320 [03:47<19:58,  1.65it/s] 15%|â–ˆâ–        | 343/2320 [03:48<20:16,  1.63it/s] 15%|â–ˆâ–        | 344/2320 [03:49<20:27,  1.61it/s] 15%|â–ˆâ–        | 345/2320 [03:49<20:18,  1.62it/s] 15%|â–ˆâ–        | 346/2320 [03:50<20:23,  1.61it/s] 15%|â–ˆâ–        | 347/2320 [03:51<20:27,  1.61it/s] 15%|â–ˆâ–Œ        | 348/2320 [03:51<18:29,  1.78it/s]{'eval_loss': 1.1803576946258545, 'eval_precision': 0.8580420738777539, 'eval_recall': 0.33831885572464243, 'eval_f1': 0.4852913621884954, 'eval_report': {'PAGE_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 84.0}, 'RECIPE_TITLE': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'INGREDIENT_LINE': {'precision': 0.7535753575357536, 'recall': 0.5011889518931772, 'f1-score': 0.6019993408766341, 'support': 5467.0}, 'INSTRUCTION_STEP': {'precision': 0.8522528815927349, 'recall': 0.25, 'f1-score': 0.3865958963796245, 'support': 9760.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.36644350321082114, 'recall': 0.8675400291120815, 'f1-score': 0.5152490274242352, 'support': 6183.0}, 'accuracy': 0.49055550386154273, 'macro avg': {'precision': 0.28175310604847276, 'recall': 0.23124699728646553, 'f1-score': 0.21483489495435623, 'support': 21494.0}, 'weighted avg': {'precision': 0.684074848066696, 'recall': 0.49055550386154273, 'f1-score': 0.47688150562025405, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[0, 0, 0, 0, 0, 0, 0], [19, 0, 13, 2, 0, 0, 50], [0, 0, 0, 0, 0, 0, 0], [64, 1, 45, 2740, 197, 8, 2412], [5, 0, 2, 501, 2440, 0, 6812], [0, 0, 0, 0, 0, 0, 0], [127, 0, 73, 393, 226, 0, 5364]], 'eval_PAGE_HEADER_precision': 0.0, 'eval_PAGE_HEADER_recall': 0.0, 'eval_PAGE_HEADER_f1': 0.0, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 7399, 'INSTRUCTION_STEP': 8185, 'INGREDIENT_LINE': 6521, 'SECTION_HEADER': 175}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.2998, 'eval_samples_per_second': 14.604, 'eval_steps_per_second': 3.651, 'epoch': 2.0}
{'loss': 1.2828, 'grad_norm': 7.884551525115967, 'learning_rate': 4.9568965517241384e-05, 'epoch': 2.16}
{'loss': 1.3784, 'grad_norm': 41.916744232177734, 'learning_rate': 4.837164750957854e-05, 'epoch': 2.59}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.90it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.57it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.71it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.29it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.11it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.95it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.84it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.72it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.71it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.70it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.69it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.68it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.65it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.69it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.69it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.74it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.75it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.72it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.72it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.77it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.83it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.14it/s][A                                                  
                                               [A 15%|â–ˆâ–Œ        | 348/2320 [03:57<18:29,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.14it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 15%|â–ˆâ–Œ        | 349/2320 [04:01<1:50:24,  3.36s/it] 15%|â–ˆâ–Œ        | 350/2320 [04:01<1:22:52,  2.52s/it]                                                     15%|â–ˆâ–Œ        | 350/2320 [04:01<1:22:52,  2.52s/it] 15%|â–ˆâ–Œ        | 351/2320 [04:02<1:03:42,  1.94s/it] 15%|â–ˆâ–Œ        | 352/2320 [04:03<50:16,  1.53s/it]   15%|â–ˆâ–Œ        | 353/2320 [04:03<40:51,  1.25s/it] 15%|â–ˆâ–Œ        | 354/2320 [04:04<34:14,  1.05s/it] 15%|â–ˆâ–Œ        | 355/2320 [04:04<29:36,  1.11it/s] 15%|â–ˆâ–Œ        | 356/2320 [04:05<26:30,  1.23it/s] 15%|â–ˆâ–Œ        | 357/2320 [04:06<24:25,  1.34it/s] 15%|â–ˆâ–Œ        | 358/2320 [04:06<22:41,  1.44it/s] 15%|â–ˆâ–Œ        | 359/2320 [04:07<21:37,  1.51it/s] 16%|â–ˆâ–Œ        | 360/2320 [04:07<20:55,  1.56it/s] 16%|â–ˆâ–Œ        | 361/2320 [04:08<20:11,  1.62it/s] 16%|â–ˆâ–Œ        | 362/2320 [04:08<19:58,  1.63it/s] 16%|â–ˆâ–Œ        | 363/2320 [04:09<20:06,  1.62it/s] 16%|â–ˆâ–Œ        | 364/2320 [04:10<20:04,  1.62it/s] 16%|â–ˆâ–Œ        | 365/2320 [04:10<20:15,  1.61it/s] 16%|â–ˆâ–Œ        | 366/2320 [04:11<20:07,  1.62it/s] 16%|â–ˆâ–Œ        | 367/2320 [04:12<19:54,  1.64it/s] 16%|â–ˆâ–Œ        | 368/2320 [04:12<19:57,  1.63it/s] 16%|â–ˆâ–Œ        | 369/2320 [04:13<19:48,  1.64it/s] 16%|â–ˆâ–Œ        | 370/2320 [04:13<19:38,  1.65it/s] 16%|â–ˆâ–Œ        | 371/2320 [04:14<19:37,  1.66it/s] 16%|â–ˆâ–Œ        | 372/2320 [04:15<19:34,  1.66it/s] 16%|â–ˆâ–Œ        | 373/2320 [04:15<19:35,  1.66it/s] 16%|â–ˆâ–Œ        | 374/2320 [04:16<19:20,  1.68it/s] 16%|â–ˆâ–Œ        | 375/2320 [04:16<19:18,  1.68it/s] 16%|â–ˆâ–Œ        | 376/2320 [04:17<19:26,  1.67it/s] 16%|â–ˆâ–‹        | 377/2320 [04:18<19:15,  1.68it/s] 16%|â–ˆâ–‹        | 378/2320 [04:18<19:18,  1.68it/s] 16%|â–ˆâ–‹        | 379/2320 [04:19<19:43,  1.64it/s] 16%|â–ˆâ–‹        | 380/2320 [04:19<19:28,  1.66it/s] 16%|â–ˆâ–‹        | 381/2320 [04:20<19:38,  1.65it/s] 16%|â–ˆâ–‹        | 382/2320 [04:21<19:38,  1.65it/s] 17%|â–ˆâ–‹        | 383/2320 [04:21<19:46,  1.63it/s] 17%|â–ˆâ–‹        | 384/2320 [04:22<19:59,  1.61it/s] 17%|â–ˆâ–‹        | 385/2320 [04:22<20:09,  1.60it/s] 17%|â–ˆâ–‹        | 386/2320 [04:23<19:40,  1.64it/s] 17%|â–ˆâ–‹        | 387/2320 [04:24<19:23,  1.66it/s] 17%|â–ˆâ–‹        | 388/2320 [04:24<19:49,  1.62it/s] 17%|â–ˆâ–‹        | 389/2320 [04:25<20:01,  1.61it/s] 17%|â–ˆâ–‹        | 390/2320 [04:25<19:34,  1.64it/s] 17%|â–ˆâ–‹        | 391/2320 [04:26<19:25,  1.65it/s] 17%|â–ˆâ–‹        | 392/2320 [04:27<19:51,  1.62it/s] 17%|â–ˆâ–‹        | 393/2320 [04:27<21:19,  1.51it/s] 17%|â–ˆâ–‹        | 394/2320 [04:28<21:04,  1.52it/s] 17%|â–ˆâ–‹        | 395/2320 [04:29<20:52,  1.54it/s] 17%|â–ˆâ–‹        | 396/2320 [04:29<20:40,  1.55it/s] 17%|â–ˆâ–‹        | 397/2320 [04:30<20:43,  1.55it/s] 17%|â–ˆâ–‹        | 398/2320 [04:31<20:38,  1.55it/s] 17%|â–ˆâ–‹        | 399/2320 [04:31<20:37,  1.55it/s] 17%|â–ˆâ–‹        | 400/2320 [04:32<20:29,  1.56it/s]                                                   17%|â–ˆâ–‹        | 400/2320 [04:32<20:29,  1.56it/s] 17%|â–ˆâ–‹        | 401/2320 [04:33<20:01,  1.60it/s] 17%|â–ˆâ–‹        | 402/2320 [04:33<19:54,  1.61it/s] 17%|â–ˆâ–‹        | 403/2320 [04:34<19:53,  1.61it/s] 17%|â–ˆâ–‹        | 404/2320 [04:34<20:08,  1.59it/s] 17%|â–ˆâ–‹        | 405/2320 [04:35<19:58,  1.60it/s] 18%|â–ˆâ–Š        | 406/2320 [04:36<20:03,  1.59it/s] 18%|â–ˆâ–Š        | 407/2320 [04:36<20:06,  1.58it/s] 18%|â–ˆâ–Š        | 408/2320 [04:37<19:43,  1.62it/s] 18%|â–ˆâ–Š        | 409/2320 [04:38<19:38,  1.62it/s] 18%|â–ˆâ–Š        | 410/2320 [04:38<19:59,  1.59it/s] 18%|â–ˆâ–Š        | 411/2320 [04:39<19:59,  1.59it/s] 18%|â–ˆâ–Š        | 412/2320 [04:39<20:06,  1.58it/s] 18%|â–ˆâ–Š        | 413/2320 [04:40<20:00,  1.59it/s] 18%|â–ˆâ–Š        | 414/2320 [04:41<20:07,  1.58it/s] 18%|â–ˆâ–Š        | 415/2320 [04:41<20:07,  1.58it/s] 18%|â–ˆâ–Š        | 416/2320 [04:42<19:56,  1.59it/s] 18%|â–ˆâ–Š        | 417/2320 [04:43<19:35,  1.62it/s] 18%|â–ˆâ–Š        | 418/2320 [04:43<19:27,  1.63it/s] 18%|â–ˆâ–Š        | 419/2320 [04:44<19:16,  1.64it/s] 18%|â–ˆâ–Š        | 420/2320 [04:44<19:18,  1.64it/s] 18%|â–ˆâ–Š        | 421/2320 [04:45<19:17,  1.64it/s] 18%|â–ˆâ–Š        | 422/2320 [04:46<19:31,  1.62it/s] 18%|â–ˆâ–Š        | 423/2320 [04:46<19:23,  1.63it/s] 18%|â–ˆâ–Š        | 424/2320 [04:47<19:15,  1.64it/s] 18%|â–ˆâ–Š        | 425/2320 [04:47<19:06,  1.65it/s] 18%|â–ˆâ–Š        | 426/2320 [04:48<18:43,  1.69it/s] 18%|â–ˆâ–Š        | 427/2320 [04:49<19:15,  1.64it/s] 18%|â–ˆâ–Š        | 428/2320 [04:49<18:56,  1.66it/s] 18%|â–ˆâ–Š        | 429/2320 [04:50<19:17,  1.63it/s] 19%|â–ˆâ–Š        | 430/2320 [04:50<19:31,  1.61it/s] 19%|â–ˆâ–Š        | 431/2320 [04:51<19:50,  1.59it/s] 19%|â–ˆâ–Š        | 432/2320 [04:52<19:58,  1.57it/s] 19%|â–ˆâ–Š        | 433/2320 [04:52<19:58,  1.57it/s] 19%|â–ˆâ–Š        | 434/2320 [04:53<19:57,  1.58it/s] 19%|â–ˆâ–‰        | 435/2320 [04:54<20:09,  1.56it/s] 19%|â–ˆâ–‰        | 436/2320 [04:54<20:14,  1.55it/s] 19%|â–ˆâ–‰        | 437/2320 [04:55<20:14,  1.55it/s] 19%|â–ˆâ–‰        | 438/2320 [04:56<20:09,  1.56it/s] 19%|â–ˆâ–‰        | 439/2320 [04:56<20:06,  1.56it/s] 19%|â–ˆâ–‰        | 440/2320 [04:57<19:51,  1.58it/s] 19%|â–ˆâ–‰        | 441/2320 [04:58<19:50,  1.58it/s] 19%|â–ˆâ–‰        | 442/2320 [04:58<19:36,  1.60it/s] 19%|â–ˆâ–‰        | 443/2320 [04:59<19:35,  1.60it/s] 19%|â–ˆâ–‰        | 444/2320 [04:59<19:45,  1.58it/s] 19%|â–ˆâ–‰        | 445/2320 [05:00<19:50,  1.58it/s] 19%|â–ˆâ–‰        | 446/2320 [05:01<19:56,  1.57it/s] 19%|â–ˆâ–‰        | 447/2320 [05:01<20:02,  1.56it/s] 19%|â–ˆâ–‰        | 448/2320 [05:02<19:24,  1.61it/s] 19%|â–ˆâ–‰        | 449/2320 [05:03<19:07,  1.63it/s] 19%|â–ˆâ–‰        | 450/2320 [05:03<19:14,  1.62it/s]                                                   19%|â–ˆâ–‰        | 450/2320 [05:03<19:14,  1.62it/s] 19%|â–ˆâ–‰        | 451/2320 [05:04<19:20,  1.61it/s] 19%|â–ˆâ–‰        | 452/2320 [05:04<19:33,  1.59it/s] 20%|â–ˆâ–‰        | 453/2320 [05:05<19:35,  1.59it/s] 20%|â–ˆâ–‰        | 454/2320 [05:06<19:44,  1.58it/s] 20%|â–ˆâ–‰        | 455/2320 [05:06<19:46,  1.57it/s] 20%|â–ˆâ–‰        | 456/2320 [05:07<19:45,  1.57it/s] 20%|â–ˆâ–‰        | 457/2320 [05:08<19:35,  1.59it/s] 20%|â–ˆâ–‰        | 458/2320 [05:08<19:51,  1.56it/s] 20%|â–ˆâ–‰        | 459/2320 [05:09<19:44,  1.57it/s] 20%|â–ˆâ–‰        | 460/2320 [05:09<19:21,  1.60it/s] 20%|â–ˆâ–‰        | 461/2320 [05:10<19:33,  1.58it/s] 20%|â–ˆâ–‰        | 462/2320 [05:11<19:39,  1.58it/s] 20%|â–ˆâ–‰        | 463/2320 [05:11<19:03,  1.62it/s] 20%|â–ˆâ–ˆ        | 464/2320 [05:12<17:20,  1.78it/s]{'eval_loss': 1.163132905960083, 'eval_precision': 0.9229775135693977, 'eval_recall': 0.5952658776462744, 'eval_f1': 0.7237535468179975, 'eval_report': {'PAGE_HEADER': {'precision': 0.04186046511627907, 'recall': 1.0, 'f1-score': 0.08035714285714286, 'support': 9.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 108.0}, 'RECIPE_TITLE': {'precision': 0.007518796992481203, 'recall': 0.5, 'f1-score': 0.014814814814814815, 'support': 2.0}, 'INGREDIENT_LINE': {'precision': 0.7059955995599559, 'recall': 0.5365802675585284, 'f1-score': 0.6097387173396674, 'support': 4784.0}, 'INSTRUCTION_STEP': {'precision': 0.3471882640586797, 'recall': 0.906934306569343, 'f1-score': 0.502147006819904, 'support': 1096.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8544883180762399, 'recall': 0.8072281381090675, 'f1-score': 0.8301861746258256, 'support': 15495.0}, 'accuracy': 0.748069228621941, 'macro avg': {'precision': 0.2795787776862337, 'recall': 0.5358203874624199, 'f1-score': 0.291034836636765, 'support': 21494.0}, 'weighted avg': {'precision': 0.7908574279368433, 'recall': 0.748069228621941, 'f1-score': 0.7598320816493018, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[9, 0, 0, 0, 0, 0, 0], [4, 0, 13, 9, 0, 0, 82], [0, 0, 1, 1, 0, 0, 0], [47, 1, 28, 2567, 178, 1, 1962], [0, 0, 0, 16, 994, 0, 86], [0, 0, 0, 0, 0, 0, 0], [155, 0, 91, 1043, 1691, 7, 12508]], 'eval_PAGE_HEADER_precision': 0.5294117647058824, 'eval_PAGE_HEADER_recall': 0.04072398190045249, 'eval_PAGE_HEADER_f1': 0.07563025210084033, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.0, 'eval_RECIPE_TITLE_recall': 0.0, 'eval_RECIPE_TITLE_f1': 0.0, 'eval_header_false_positive_rate': 0.0, 'eval_title_false_negative_rate': 0.0, 'eval_header_title_confusion_count': 0, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15987, 'INGREDIENT_LINE': 5210, 'INSTRUCTION_STEP': 879, 'SECTION_HEADER': 184, 'PAGE_HEADER': 17, 'RECIPE_TITLE': 3}, 'eval_title_anchor_accuracy': 0.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 0, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.4638, 'eval_samples_per_second': 14.233, 'eval_steps_per_second': 3.558, 'epoch': 3.0}
{'loss': 1.2039, 'grad_norm': 5.575856685638428, 'learning_rate': 4.717432950191571e-05, 'epoch': 3.02}
{'loss': 0.9629, 'grad_norm': 9.165705680847168, 'learning_rate': 4.597701149425287e-05, 'epoch': 3.45}
{'loss': 1.1145, 'grad_norm': 8.487784385681152, 'learning_rate': 4.477969348659004e-05, 'epoch': 3.88}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.23it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.18it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.47it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.13it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.96it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.81it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.64it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.61it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.64it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.67it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.70it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.65it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.62it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.65it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.67it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.73it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.74it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.67it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.65it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.66it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  3.98it/s][A                                                  
                                               [A 20%|â–ˆâ–ˆ        | 464/2320 [05:18<17:20,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.98it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 20%|â–ˆâ–ˆ        | 465/2320 [05:22<1:47:03,  3.46s/it] 20%|â–ˆâ–ˆ        | 466/2320 [05:23<1:20:12,  2.60s/it] 20%|â–ˆâ–ˆ        | 467/2320 [05:23<1:01:47,  2.00s/it] 20%|â–ˆâ–ˆ        | 468/2320 [05:24<48:30,  1.57s/it]   20%|â–ˆâ–ˆ        | 469/2320 [05:24<39:13,  1.27s/it] 20%|â–ˆâ–ˆ        | 470/2320 [05:25<32:46,  1.06s/it] 20%|â–ˆâ–ˆ        | 471/2320 [05:25<28:12,  1.09it/s] 20%|â–ˆâ–ˆ        | 472/2320 [05:26<25:16,  1.22it/s] 20%|â–ˆâ–ˆ        | 473/2320 [05:27<23:19,  1.32it/s] 20%|â–ˆâ–ˆ        | 474/2320 [05:27<21:54,  1.40it/s] 20%|â–ˆâ–ˆ        | 475/2320 [05:28<20:58,  1.47it/s] 21%|â–ˆâ–ˆ        | 476/2320 [05:29<20:16,  1.52it/s] 21%|â–ˆâ–ˆ        | 477/2320 [05:29<19:32,  1.57it/s] 21%|â–ˆâ–ˆ        | 478/2320 [05:30<19:18,  1.59it/s] 21%|â–ˆâ–ˆ        | 479/2320 [05:30<18:54,  1.62it/s] 21%|â–ˆâ–ˆ        | 480/2320 [05:31<18:49,  1.63it/s] 21%|â–ˆâ–ˆ        | 481/2320 [05:32<18:54,  1.62it/s] 21%|â–ˆâ–ˆ        | 482/2320 [05:32<18:56,  1.62it/s] 21%|â–ˆâ–ˆ        | 483/2320 [05:33<18:43,  1.64it/s] 21%|â–ˆâ–ˆ        | 484/2320 [05:33<18:42,  1.64it/s] 21%|â–ˆâ–ˆ        | 485/2320 [05:34<18:49,  1.62it/s] 21%|â–ˆâ–ˆ        | 486/2320 [05:35<18:41,  1.63it/s] 21%|â–ˆâ–ˆ        | 487/2320 [05:35<18:38,  1.64it/s] 21%|â–ˆâ–ˆ        | 488/2320 [05:36<18:45,  1.63it/s] 21%|â–ˆâ–ˆ        | 489/2320 [05:36<18:59,  1.61it/s] 21%|â–ˆâ–ˆ        | 490/2320 [05:37<19:03,  1.60it/s] 21%|â–ˆâ–ˆ        | 491/2320 [05:38<19:11,  1.59it/s] 21%|â–ˆâ–ˆ        | 492/2320 [05:38<19:19,  1.58it/s] 21%|â–ˆâ–ˆâ–       | 493/2320 [05:39<19:23,  1.57it/s] 21%|â–ˆâ–ˆâ–       | 494/2320 [05:40<19:37,  1.55it/s] 21%|â–ˆâ–ˆâ–       | 495/2320 [05:40<19:34,  1.55it/s] 21%|â–ˆâ–ˆâ–       | 496/2320 [05:41<19:22,  1.57it/s] 21%|â–ˆâ–ˆâ–       | 497/2320 [05:42<19:14,  1.58it/s] 21%|â–ˆâ–ˆâ–       | 498/2320 [05:42<19:27,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 499/2320 [05:43<19:25,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 500/2320 [05:44<19:24,  1.56it/s]                                                   22%|â–ˆâ–ˆâ–       | 500/2320 [05:44<19:24,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 501/2320 [05:44<18:54,  1.60it/s] 22%|â–ˆâ–ˆâ–       | 502/2320 [05:45<19:03,  1.59it/s] 22%|â–ˆâ–ˆâ–       | 503/2320 [05:45<19:08,  1.58it/s] 22%|â–ˆâ–ˆâ–       | 504/2320 [05:46<19:37,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 505/2320 [05:47<19:40,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 506/2320 [05:47<19:40,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 507/2320 [05:48<19:37,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 508/2320 [05:49<19:32,  1.55it/s] 22%|â–ˆâ–ˆâ–       | 509/2320 [05:49<19:08,  1.58it/s] 22%|â–ˆâ–ˆâ–       | 510/2320 [05:50<18:49,  1.60it/s] 22%|â–ˆâ–ˆâ–       | 511/2320 [05:50<18:26,  1.63it/s] 22%|â–ˆâ–ˆâ–       | 512/2320 [05:51<18:44,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 513/2320 [05:52<19:00,  1.58it/s] 22%|â–ˆâ–ˆâ–       | 514/2320 [05:52<19:10,  1.57it/s] 22%|â–ˆâ–ˆâ–       | 515/2320 [05:53<19:06,  1.57it/s] 22%|â–ˆâ–ˆâ–       | 516/2320 [05:54<19:20,  1.56it/s] 22%|â–ˆâ–ˆâ–       | 517/2320 [05:54<19:26,  1.55it/s] 22%|â–ˆâ–ˆâ–       | 518/2320 [05:55<19:28,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 519/2320 [05:56<19:29,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 520/2320 [05:56<19:26,  1.54it/s] 22%|â–ˆâ–ˆâ–       | 521/2320 [05:57<19:17,  1.55it/s] 22%|â–ˆâ–ˆâ–Ž       | 522/2320 [05:58<19:20,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 523/2320 [05:58<19:22,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 524/2320 [05:59<19:25,  1.54it/s] 23%|â–ˆâ–ˆâ–Ž       | 525/2320 [06:00<19:36,  1.53it/s] 23%|â–ˆâ–ˆâ–Ž       | 526/2320 [06:00<19:29,  1.53it/s] 23%|â–ˆâ–ˆâ–Ž       | 527/2320 [06:01<19:21,  1.54it/s] 23%|â–ˆâ–ˆâ–Ž       | 528/2320 [06:01<19:18,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 529/2320 [06:02<19:18,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 530/2320 [06:03<19:13,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 531/2320 [06:03<19:10,  1.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 532/2320 [06:04<19:09,  1.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 533/2320 [06:05<19:10,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 534/2320 [06:05<19:20,  1.54it/s] 23%|â–ˆâ–ˆâ–Ž       | 535/2320 [06:06<20:10,  1.47it/s] 23%|â–ˆâ–ˆâ–Ž       | 536/2320 [06:07<19:38,  1.51it/s] 23%|â–ˆâ–ˆâ–Ž       | 537/2320 [06:07<19:24,  1.53it/s] 23%|â–ˆâ–ˆâ–Ž       | 538/2320 [06:08<19:11,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 539/2320 [06:09<19:07,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 540/2320 [06:09<19:08,  1.55it/s] 23%|â–ˆâ–ˆâ–Ž       | 541/2320 [06:10<19:00,  1.56it/s] 23%|â–ˆâ–ˆâ–Ž       | 542/2320 [06:11<18:53,  1.57it/s] 23%|â–ˆâ–ˆâ–Ž       | 543/2320 [06:11<18:46,  1.58it/s] 23%|â–ˆâ–ˆâ–Ž       | 544/2320 [06:12<18:51,  1.57it/s] 23%|â–ˆâ–ˆâ–Ž       | 545/2320 [06:12<18:56,  1.56it/s] 24%|â–ˆâ–ˆâ–Ž       | 546/2320 [06:13<18:53,  1.56it/s] 24%|â–ˆâ–ˆâ–Ž       | 547/2320 [06:14<18:55,  1.56it/s] 24%|â–ˆâ–ˆâ–Ž       | 548/2320 [06:14<19:02,  1.55it/s] 24%|â–ˆâ–ˆâ–Ž       | 549/2320 [06:15<18:58,  1.56it/s] 24%|â–ˆâ–ˆâ–Ž       | 550/2320 [06:16<18:55,  1.56it/s]                                                   24%|â–ˆâ–ˆâ–Ž       | 550/2320 [06:16<18:55,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 551/2320 [06:16<18:53,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 552/2320 [06:17<18:56,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 553/2320 [06:18<18:54,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 554/2320 [06:18<18:51,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 555/2320 [06:19<18:48,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 556/2320 [06:20<18:50,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 557/2320 [06:20<18:49,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 558/2320 [06:21<18:46,  1.56it/s] 24%|â–ˆâ–ˆâ–       | 559/2320 [06:21<18:15,  1.61it/s] 24%|â–ˆâ–ˆâ–       | 560/2320 [06:22<18:21,  1.60it/s] 24%|â–ˆâ–ˆâ–       | 561/2320 [06:23<18:16,  1.60it/s] 24%|â–ˆâ–ˆâ–       | 562/2320 [06:23<18:25,  1.59it/s] 24%|â–ˆâ–ˆâ–       | 563/2320 [06:24<18:33,  1.58it/s] 24%|â–ˆâ–ˆâ–       | 564/2320 [06:25<18:35,  1.57it/s] 24%|â–ˆâ–ˆâ–       | 565/2320 [06:25<18:30,  1.58it/s] 24%|â–ˆâ–ˆâ–       | 566/2320 [06:26<18:23,  1.59it/s] 24%|â–ˆâ–ˆâ–       | 567/2320 [06:26<18:34,  1.57it/s] 24%|â–ˆâ–ˆâ–       | 568/2320 [06:27<18:34,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 569/2320 [06:28<18:40,  1.56it/s] 25%|â–ˆâ–ˆâ–       | 570/2320 [06:28<18:36,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 571/2320 [06:29<18:40,  1.56it/s] 25%|â–ˆâ–ˆâ–       | 572/2320 [06:30<18:32,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 573/2320 [06:30<18:33,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 574/2320 [06:31<18:37,  1.56it/s] 25%|â–ˆâ–ˆâ–       | 575/2320 [06:32<18:27,  1.58it/s] 25%|â–ˆâ–ˆâ–       | 576/2320 [06:32<18:36,  1.56it/s] 25%|â–ˆâ–ˆâ–       | 577/2320 [06:33<18:33,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 578/2320 [06:33<18:30,  1.57it/s] 25%|â–ˆâ–ˆâ–       | 579/2320 [06:34<18:17,  1.59it/s] 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [06:35<16:37,  1.74it/s]{'eval_loss': 0.964745044708252, 'eval_precision': 0.8953356086461889, 'eval_recall': 0.48326680994780474, 'eval_f1': 0.6277168494516451, 'eval_report': {'PAGE_HEADER': {'precision': 0.6139534883720931, 'recall': 0.1800818553888131, 'f1-score': 0.27848101265822783, 'support': 733.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 43.0}, 'RECIPE_TITLE': {'precision': 0.3007518796992481, 'recall': 0.07797270955165692, 'f1-score': 0.1238390092879257, 'support': 513.0}, 'INGREDIENT_LINE': {'precision': 0.679042904290429, 'recall': 0.6592790387182911, 'f1-score': 0.6690150386126541, 'support': 3745.0}, 'INSTRUCTION_STEP': {'precision': 0.7268599371288857, 'recall': 0.4393075786362677, 'f1-score': 0.5476315789473685, 'support': 4737.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.6927858997130756, 'recall': 0.8650516079501834, 'f1-score': 0.7693941807973901, 'support': 11723.0}, 'accuracy': 0.6914953010142365, 'macro avg': {'precision': 0.4304848727433902, 'recall': 0.3173846843207446, 'f1-score': 0.34119440290050945, 'support': 21494.0}, 'weighted avg': {'precision': 0.6844698019143032, 'recall': 0.6914953010142365, 'f1-score': 0.6693428903233025, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[132, 0, 26, 63, 8, 0, 504], [0, 0, 8, 3, 0, 0, 32], [6, 0, 40, 42, 2, 0, 423], [61, 1, 53, 2469, 62, 8, 1091], [1, 0, 0, 208, 2081, 0, 2447], [0, 0, 0, 0, 0, 0, 0], [15, 0, 6, 851, 710, 0, 10141]], 'eval_PAGE_HEADER_precision': 0.11400966183574879, 'eval_PAGE_HEADER_recall': 0.5339366515837104, 'eval_PAGE_HEADER_f1': 0.18789808917197454, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.026223776223776224, 'eval_RECIPE_TITLE_recall': 0.1056338028169014, 'eval_RECIPE_TITLE_f1': 0.04201680672268908, 'eval_header_false_positive_rate': 0.055710306406685235, 'eval_title_false_negative_rate': 0.24519230769230768, 'eval_header_title_confusion_count': 71, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 11880, 'INGREDIENT_LINE': 4520, 'INSTRUCTION_STEP': 4191, 'PAGE_HEADER': 1035, 'RECIPE_TITLE': 572, 'SECTION_HEADER': 82}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6101, 'eval_samples_per_second': 13.918, 'eval_steps_per_second': 3.48, 'epoch': 4.0}
{'loss': 0.8255, 'grad_norm': 3.163421869277954, 'learning_rate': 4.3582375478927204e-05, 'epoch': 4.31}
{'loss': 0.9313, 'grad_norm': 24.880447387695312, 'learning_rate': 4.238505747126437e-05, 'epoch': 4.74}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.44it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.23it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.45it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.15it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.01it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.89it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.81it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.65it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.65it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.69it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.71it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.75it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.71it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.74it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.72it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.70it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.73it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.71it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.66it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.65it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.67it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  3.98it/s][A                                                  
                                               [A 25%|â–ˆâ–ˆâ–Œ       | 580/2320 [06:41<16:37,  1.74it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.98it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 25%|â–ˆâ–ˆâ–Œ       | 581/2320 [06:45<1:40:53,  3.48s/it] 25%|â–ˆâ–ˆâ–Œ       | 582/2320 [06:45<1:15:37,  2.61s/it] 25%|â–ˆâ–ˆâ–Œ       | 583/2320 [06:46<57:51,  2.00s/it]   25%|â–ˆâ–ˆâ–Œ       | 584/2320 [06:47<45:35,  1.58s/it] 25%|â–ˆâ–ˆâ–Œ       | 585/2320 [06:47<36:53,  1.28s/it] 25%|â–ˆâ–ˆâ–Œ       | 586/2320 [06:48<30:49,  1.07s/it] 25%|â–ˆâ–ˆâ–Œ       | 587/2320 [06:48<26:45,  1.08it/s] 25%|â–ˆâ–ˆâ–Œ       | 588/2320 [06:49<23:39,  1.22it/s] 25%|â–ˆâ–ˆâ–Œ       | 589/2320 [06:49<21:40,  1.33it/s] 25%|â–ˆâ–ˆâ–Œ       | 590/2320 [06:50<20:19,  1.42it/s] 25%|â–ˆâ–ˆâ–Œ       | 591/2320 [06:51<19:34,  1.47it/s] 26%|â–ˆâ–ˆâ–Œ       | 592/2320 [06:51<18:55,  1.52it/s] 26%|â–ˆâ–ˆâ–Œ       | 593/2320 [06:52<18:26,  1.56it/s] 26%|â–ˆâ–ˆâ–Œ       | 594/2320 [06:52<18:12,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 595/2320 [06:53<18:15,  1.57it/s] 26%|â–ˆâ–ˆâ–Œ       | 596/2320 [06:54<18:08,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 597/2320 [06:54<18:11,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 598/2320 [06:55<17:47,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 599/2320 [06:56<17:30,  1.64it/s] 26%|â–ˆâ–ˆâ–Œ       | 600/2320 [06:56<17:43,  1.62it/s]                                                   26%|â–ˆâ–ˆâ–Œ       | 600/2320 [06:56<17:43,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 601/2320 [06:57<17:46,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 602/2320 [06:57<17:58,  1.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 603/2320 [06:58<18:01,  1.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 604/2320 [06:59<18:05,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 605/2320 [06:59<17:57,  1.59it/s] 26%|â–ˆâ–ˆâ–Œ       | 606/2320 [07:00<17:53,  1.60it/s] 26%|â–ˆâ–ˆâ–Œ       | 607/2320 [07:01<18:03,  1.58it/s] 26%|â–ˆâ–ˆâ–Œ       | 608/2320 [07:01<17:50,  1.60it/s] 26%|â–ˆâ–ˆâ–‹       | 609/2320 [07:02<17:40,  1.61it/s] 26%|â–ˆâ–ˆâ–‹       | 610/2320 [07:02<17:49,  1.60it/s] 26%|â–ˆâ–ˆâ–‹       | 611/2320 [07:03<17:43,  1.61it/s] 26%|â–ˆâ–ˆâ–‹       | 612/2320 [07:04<17:40,  1.61it/s] 26%|â–ˆâ–ˆâ–‹       | 613/2320 [07:04<17:43,  1.60it/s] 26%|â–ˆâ–ˆâ–‹       | 614/2320 [07:05<17:46,  1.60it/s] 27%|â–ˆâ–ˆâ–‹       | 615/2320 [07:06<17:51,  1.59it/s] 27%|â–ˆâ–ˆâ–‹       | 616/2320 [07:06<17:51,  1.59it/s] 27%|â–ˆâ–ˆâ–‹       | 617/2320 [07:07<17:58,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 618/2320 [07:07<17:30,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 619/2320 [07:08<17:41,  1.60it/s] 27%|â–ˆâ–ˆâ–‹       | 620/2320 [07:09<17:20,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 621/2320 [07:09<17:31,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 622/2320 [07:10<17:39,  1.60it/s] 27%|â–ˆâ–ˆâ–‹       | 623/2320 [07:11<17:49,  1.59it/s] 27%|â–ˆâ–ˆâ–‹       | 624/2320 [07:11<17:53,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 625/2320 [07:12<17:53,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 626/2320 [07:13<17:51,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 627/2320 [07:13<17:47,  1.59it/s] 27%|â–ˆâ–ˆâ–‹       | 628/2320 [07:14<17:49,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 629/2320 [07:14<17:47,  1.58it/s] 27%|â–ˆâ–ˆâ–‹       | 630/2320 [07:15<17:58,  1.57it/s] 27%|â–ˆâ–ˆâ–‹       | 631/2320 [07:16<18:10,  1.55it/s] 27%|â–ˆâ–ˆâ–‹       | 632/2320 [07:16<18:09,  1.55it/s] 27%|â–ˆâ–ˆâ–‹       | 633/2320 [07:17<18:04,  1.56it/s] 27%|â–ˆâ–ˆâ–‹       | 634/2320 [07:18<17:59,  1.56it/s] 27%|â–ˆâ–ˆâ–‹       | 635/2320 [07:18<17:57,  1.56it/s] 27%|â–ˆâ–ˆâ–‹       | 636/2320 [07:19<17:57,  1.56it/s] 27%|â–ˆâ–ˆâ–‹       | 637/2320 [07:20<17:51,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 638/2320 [07:20<17:46,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 639/2320 [07:21<17:46,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 640/2320 [07:21<17:20,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 641/2320 [07:22<17:23,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 642/2320 [07:23<17:31,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 643/2320 [07:23<17:13,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 644/2320 [07:24<17:05,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 645/2320 [07:25<17:30,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 646/2320 [07:25<17:36,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 647/2320 [07:26<17:45,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 648/2320 [07:26<17:42,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 649/2320 [07:27<17:43,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 650/2320 [07:28<17:41,  1.57it/s]                                                   28%|â–ˆâ–ˆâ–Š       | 650/2320 [07:28<17:41,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 651/2320 [07:28<17:43,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 652/2320 [07:29<17:40,  1.57it/s] 28%|â–ˆâ–ˆâ–Š       | 653/2320 [07:30<17:37,  1.58it/s] 28%|â–ˆâ–ˆâ–Š       | 654/2320 [07:30<17:14,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 655/2320 [07:31<17:20,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 656/2320 [07:31<17:16,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 657/2320 [07:32<17:06,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 658/2320 [07:33<16:58,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 659/2320 [07:33<17:12,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 660/2320 [07:34<16:58,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 661/2320 [07:35<16:57,  1.63it/s] 29%|â–ˆâ–ˆâ–Š       | 662/2320 [07:35<16:50,  1.64it/s] 29%|â–ˆâ–ˆâ–Š       | 663/2320 [07:36<17:05,  1.62it/s] 29%|â–ˆâ–ˆâ–Š       | 664/2320 [07:36<16:49,  1.64it/s] 29%|â–ˆâ–ˆâ–Š       | 665/2320 [07:37<17:02,  1.62it/s] 29%|â–ˆâ–ˆâ–Š       | 666/2320 [07:38<16:55,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 667/2320 [07:38<17:00,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 668/2320 [07:39<16:50,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 669/2320 [07:39<16:59,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 670/2320 [07:40<16:50,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 671/2320 [07:41<17:02,  1.61it/s] 29%|â–ˆâ–ˆâ–‰       | 672/2320 [07:41<16:48,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 673/2320 [07:42<16:52,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 674/2320 [07:42<16:44,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 675/2320 [07:43<16:53,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 676/2320 [07:44<16:45,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 677/2320 [07:44<17:17,  1.58it/s] 29%|â–ˆâ–ˆâ–‰       | 678/2320 [07:45<16:52,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 679/2320 [07:46<16:39,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 680/2320 [07:46<16:50,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 681/2320 [07:47<16:38,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 682/2320 [07:47<16:46,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 683/2320 [07:48<16:50,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 684/2320 [07:49<16:41,  1.63it/s] 30%|â–ˆâ–ˆâ–‰       | 685/2320 [07:49<16:45,  1.63it/s] 30%|â–ˆâ–ˆâ–‰       | 686/2320 [07:50<16:51,  1.61it/s] 30%|â–ˆâ–ˆâ–‰       | 687/2320 [07:50<16:31,  1.65it/s] 30%|â–ˆâ–ˆâ–‰       | 688/2320 [07:51<16:41,  1.63it/s] 30%|â–ˆâ–ˆâ–‰       | 689/2320 [07:52<16:50,  1.61it/s] 30%|â–ˆâ–ˆâ–‰       | 690/2320 [07:52<16:36,  1.64it/s] 30%|â–ˆâ–ˆâ–‰       | 691/2320 [07:53<16:48,  1.62it/s] 30%|â–ˆâ–ˆâ–‰       | 692/2320 [07:54<17:04,  1.59it/s] 30%|â–ˆâ–ˆâ–‰       | 693/2320 [07:54<17:15,  1.57it/s] 30%|â–ˆâ–ˆâ–‰       | 694/2320 [07:55<17:23,  1.56it/s] 30%|â–ˆâ–ˆâ–‰       | 695/2320 [07:56<17:20,  1.56it/s] 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [07:56<15:43,  1.72it/s]{'eval_loss': 0.9407632946968079, 'eval_precision': 0.9255786113328013, 'eval_recall': 0.6382773802971932, 'eval_f1': 0.7555374592833877, 'eval_report': {'PAGE_HEADER': {'precision': 0.6139534883720931, 'recall': 0.35294117647058826, 'f1-score': 0.44821731748726656, 'support': 374.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 11.0}, 'RECIPE_TITLE': {'precision': 0.3308270676691729, 'recall': 0.36666666666666664, 'f1-score': 0.34782608695652173, 'support': 120.0}, 'INGREDIENT_LINE': {'precision': 0.6985698569856986, 'recall': 0.7582089552238805, 'f1-score': 0.7271686229602061, 'support': 3350.0}, 'INSTRUCTION_STEP': {'precision': 0.6716730702060776, 'recall': 0.5634339290946382, 'f1-score': 0.612810707456979, 'support': 3413.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8458805847793415, 'recall': 0.8703781807957262, 'f1-score': 0.8579545454545454, 'support': 14226.0}, 'accuracy': 0.7918954126733042, 'macro avg': {'precision': 0.4515577240017691, 'recall': 0.41594698689307136, 'f1-score': 0.42771104004507415, 'support': 21494.0}, 'weighted avg': {'precision': 0.7879149651697128, 'recall': 0.7918954126733042, 'f1-score': 0.7882279520926186, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[132, 0, 25, 9, 33, 0, 175], [0, 0, 0, 1, 0, 0, 10], [2, 0, 44, 0, 8, 0, 66], [61, 1, 54, 2540, 78, 8, 608], [0, 0, 0, 93, 1923, 0, 1397], [0, 0, 0, 0, 0, 0, 0], [20, 0, 10, 993, 821, 0, 12382]], 'eval_PAGE_HEADER_precision': 0.23690205011389523, 'eval_PAGE_HEADER_recall': 0.47058823529411764, 'eval_PAGE_HEADER_f1': 0.3151515151515152, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.11594202898550725, 'eval_RECIPE_TITLE_recall': 0.11267605633802817, 'eval_RECIPE_TITLE_f1': 0.1142857142857143, 'eval_header_false_positive_rate': 0.055232558139534885, 'eval_title_false_negative_rate': 0.24401913875598086, 'eval_header_title_confusion_count': 70, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14566, 'INGREDIENT_LINE': 4346, 'INSTRUCTION_STEP': 2776, 'PAGE_HEADER': 439, 'RECIPE_TITLE': 138, 'SECTION_HEADER': 15}, 'eval_title_anchor_accuracy': 0.3333333333333333, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 2, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.5835, 'eval_samples_per_second': 13.974, 'eval_steps_per_second': 3.494, 'epoch': 5.0}
{'loss': 0.8636, 'grad_norm': 29.853225708007812, 'learning_rate': 4.1187739463601534e-05, 'epoch': 5.17}
{'loss': 0.6167, 'grad_norm': 18.473186492919922, 'learning_rate': 3.99904214559387e-05, 'epoch': 5.6}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:04,  4.38it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.06it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  3.95it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  3.96it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.85it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.79it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.59it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.54it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.47it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.48it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.51it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.36it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.39it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.43it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.48it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.52it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.58it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.63it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.59it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:06<00:00,  3.65it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.97it/s][A                                                  
                                               [A 30%|â–ˆâ–ˆâ–ˆ       | 696/2320 [08:03<15:43,  1.72it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.97it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 30%|â–ˆâ–ˆâ–ˆ       | 697/2320 [08:06<1:35:13,  3.52s/it] 30%|â–ˆâ–ˆâ–ˆ       | 698/2320 [08:07<1:11:11,  2.63s/it] 30%|â–ˆâ–ˆâ–ˆ       | 699/2320 [08:08<54:25,  2.01s/it]   30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [08:08<42:56,  1.59s/it]                                                   30%|â–ˆâ–ˆâ–ˆ       | 700/2320 [08:08<42:56,  1.59s/it] 30%|â–ˆâ–ˆâ–ˆ       | 701/2320 [08:09<34:58,  1.30s/it] 30%|â–ˆâ–ˆâ–ˆ       | 702/2320 [08:09<29:24,  1.09s/it] 30%|â–ˆâ–ˆâ–ˆ       | 703/2320 [08:10<25:27,  1.06it/s] 30%|â–ˆâ–ˆâ–ˆ       | 704/2320 [08:11<22:44,  1.18it/s] 30%|â–ˆâ–ˆâ–ˆ       | 705/2320 [08:11<21:15,  1.27it/s] 30%|â–ˆâ–ˆâ–ˆ       | 706/2320 [08:12<20:13,  1.33it/s] 30%|â–ˆâ–ˆâ–ˆ       | 707/2320 [08:12<19:07,  1.41it/s] 31%|â–ˆâ–ˆâ–ˆ       | 708/2320 [08:13<18:14,  1.47it/s] 31%|â–ˆâ–ˆâ–ˆ       | 709/2320 [08:14<17:47,  1.51it/s] 31%|â–ˆâ–ˆâ–ˆ       | 710/2320 [08:14<17:18,  1.55it/s] 31%|â–ˆâ–ˆâ–ˆ       | 711/2320 [08:15<17:04,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 712/2320 [08:16<16:57,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆ       | 713/2320 [08:16<16:59,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆ       | 714/2320 [08:17<17:03,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆ       | 715/2320 [08:17<16:58,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆ       | 716/2320 [08:18<16:51,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆ       | 717/2320 [08:19<17:04,  1.56it/s] 31%|â–ˆâ–ˆâ–ˆ       | 718/2320 [08:19<16:37,  1.61it/s] 31%|â–ˆâ–ˆâ–ˆ       | 719/2320 [08:20<16:48,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆ       | 720/2320 [08:21<16:27,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 721/2320 [08:21<16:34,  1.61it/s] 31%|â–ˆâ–ˆâ–ˆ       | 722/2320 [08:22<16:37,  1.60it/s] 31%|â–ˆâ–ˆâ–ˆ       | 723/2320 [08:22<16:24,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 724/2320 [08:23<16:13,  1.64it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 725/2320 [08:24<16:36,  1.60it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 726/2320 [08:24<16:41,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 727/2320 [08:25<16:44,  1.59it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 728/2320 [08:26<16:48,  1.58it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 729/2320 [08:26<16:52,  1.57it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 730/2320 [08:27<16:54,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 731/2320 [08:28<16:49,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 732/2320 [08:28<16:46,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 733/2320 [08:29<16:47,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 734/2320 [08:29<16:49,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 735/2320 [08:30<17:02,  1.55it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 736/2320 [08:31<16:56,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 737/2320 [08:31<16:53,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 738/2320 [08:32<16:50,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 739/2320 [08:33<16:53,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 740/2320 [08:33<16:52,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 741/2320 [08:34<16:47,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 742/2320 [08:35<16:47,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 743/2320 [08:35<16:43,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 744/2320 [08:36<16:44,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 745/2320 [08:36<16:44,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 746/2320 [08:37<16:42,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 747/2320 [08:38<16:39,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 748/2320 [08:38<16:38,  1.57it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 749/2320 [08:39<16:45,  1.56it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [08:40<16:25,  1.59it/s]                                                   32%|â–ˆâ–ˆâ–ˆâ–      | 750/2320 [08:40<16:25,  1.59it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 751/2320 [08:40<16:30,  1.58it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 752/2320 [08:41<16:08,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 753/2320 [08:41<16:11,  1.61it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 754/2320 [08:42<16:21,  1.60it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 755/2320 [08:43<16:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 756/2320 [08:43<15:58,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 757/2320 [08:44<16:07,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 758/2320 [08:45<15:48,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 759/2320 [08:45<16:06,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 760/2320 [08:46<15:54,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 761/2320 [08:46<16:06,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 762/2320 [08:47<15:55,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 763/2320 [08:48<15:53,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 764/2320 [08:48<16:04,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 765/2320 [08:49<15:59,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 766/2320 [08:49<15:40,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 767/2320 [08:50<15:56,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 768/2320 [08:51<15:43,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 769/2320 [08:51<15:54,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 770/2320 [08:52<16:07,  1.60it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 771/2320 [08:53<15:45,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 772/2320 [08:53<16:01,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 773/2320 [08:54<15:45,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 774/2320 [08:54<16:02,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 775/2320 [08:55<15:53,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 776/2320 [08:56<15:41,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 777/2320 [08:56<15:52,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 778/2320 [08:57<15:35,  1.65it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 779/2320 [08:57<15:50,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 780/2320 [08:58<15:44,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 781/2320 [08:59<15:58,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 782/2320 [08:59<15:39,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 783/2320 [09:00<15:31,  1.65it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 784/2320 [09:01<15:45,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 785/2320 [09:01<15:37,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 786/2320 [09:02<15:53,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 787/2320 [09:02<15:37,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 788/2320 [09:03<15:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 789/2320 [09:04<15:55,  1.60it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 790/2320 [09:04<15:44,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 791/2320 [09:05<15:42,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 792/2320 [09:05<15:46,  1.61it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 793/2320 [09:06<15:38,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 794/2320 [09:07<15:33,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 795/2320 [09:07<15:35,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 796/2320 [09:08<15:55,  1.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 797/2320 [09:09<16:00,  1.59it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 798/2320 [09:09<16:07,  1.57it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 799/2320 [09:10<16:04,  1.58it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [09:11<16:18,  1.55it/s]                                                   34%|â–ˆâ–ˆâ–ˆâ–      | 800/2320 [09:11<16:18,  1.55it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 801/2320 [09:11<16:27,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 802/2320 [09:12<16:27,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 803/2320 [09:12<16:23,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 804/2320 [09:13<16:27,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 805/2320 [09:14<16:25,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 806/2320 [09:14<16:24,  1.54it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 807/2320 [09:15<15:59,  1.58it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 808/2320 [09:16<15:56,  1.58it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 809/2320 [09:16<15:35,  1.62it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 810/2320 [09:17<15:41,  1.60it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 811/2320 [09:18<15:42,  1.60it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [09:18<14:20,  1.75it/s]{'eval_loss': 1.0389337539672852, 'eval_precision': 0.9045204900718209, 'eval_recall': 0.599551946233548, 'eval_f1': 0.7211182216234422, 'eval_report': {'PAGE_HEADER': {'precision': 0.22790697674418606, 'recall': 0.15960912052117263, 'f1-score': 0.18773946360153257, 'support': 307.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26.0}, 'RECIPE_TITLE': {'precision': 0.09774436090225563, 'recall': 0.07103825136612021, 'f1-score': 0.08227848101265822, 'support': 183.0}, 'INGREDIENT_LINE': {'precision': 0.6064356435643564, 'recall': 0.8032786885245902, 'f1-score': 0.691114245416079, 'support': 2745.0}, 'INSTRUCTION_STEP': {'precision': 0.703807195249738, 'recall': 0.5191960834836382, 'f1-score': 0.5975682087781732, 'support': 3881.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8354966525481623, 'recall': 0.8521460423634337, 'f1-score': 0.8437392204208348, 'support': 14352.0}, 'accuracy': 0.7682143854098819, 'macro avg': {'precision': 0.3530558327155284, 'recall': 0.34360974089413643, 'f1-score': 0.3432056598898968, 'support': 21494.0}, 'weighted avg': {'precision': 0.7664950304096583, 'recall': 0.7682143854098819, 'f1-score': 0.7629249600244736, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[49, 0, 5, 89, 2, 3, 159], [0, 0, 13, 3, 0, 0, 10], [1, 0, 13, 95, 0, 1, 73], [19, 1, 15, 2205, 31, 0, 474], [0, 0, 0, 174, 2015, 0, 1692], [0, 0, 0, 0, 0, 0, 0], [146, 0, 87, 1070, 815, 4, 12230]], 'eval_PAGE_HEADER_precision': 0.10810810810810811, 'eval_PAGE_HEADER_recall': 0.2171945701357466, 'eval_PAGE_HEADER_f1': 0.1443609022556391, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.024390243902439025, 'eval_RECIPE_TITLE_recall': 0.04225352112676056, 'eval_RECIPE_TITLE_f1': 0.030927835051546393, 'eval_header_false_positive_rate': 0.007380073800738007, 'eval_title_false_negative_rate': 0.10303030303030303, 'eval_header_title_confusion_count': 19, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14827, 'INGREDIENT_LINE': 3352, 'INSTRUCTION_STEP': 3371, 'PAGE_HEADER': 444, 'RECIPE_TITLE': 246, 'SECTION_HEADER': 40}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.904, 'eval_samples_per_second': 13.326, 'eval_steps_per_second': 3.331, 'epoch': 6.0}
{'loss': 0.6544, 'grad_norm': 4.5669989585876465, 'learning_rate': 3.8793103448275865e-05, 'epoch': 6.03}
{'loss': 0.4787, 'grad_norm': 10.777196884155273, 'learning_rate': 3.759578544061303e-05, 'epoch': 6.47}
{'loss': 0.537, 'grad_norm': 7.9477925300598145, 'learning_rate': 3.6398467432950195e-05, 'epoch': 6.9}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.12it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.27it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.67it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.31it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.14it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.94it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.80it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.77it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.81it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.72it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.72it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.70it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.63it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.65it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.75it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.81it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.80it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.84it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.82it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.76it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.71it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.02it/s][A                                                  
                                               [A 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 812/2320 [09:24<14:20,  1.75it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.02it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 813/2320 [09:28<1:24:08,  3.35s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 814/2320 [09:28<1:03:15,  2.52s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 815/2320 [09:29<49:33,  1.98s/it]   35%|â–ˆâ–ˆâ–ˆâ–Œ      | 816/2320 [09:30<39:00,  1.56s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 817/2320 [09:30<31:57,  1.28s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 818/2320 [09:31<27:13,  1.09s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 819/2320 [09:32<23:48,  1.05it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 820/2320 [09:32<21:33,  1.16it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 821/2320 [09:33<20:00,  1.25it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 822/2320 [09:34<18:50,  1.32it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 823/2320 [09:34<17:53,  1.39it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 824/2320 [09:35<17:15,  1.44it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 825/2320 [09:35<16:50,  1.48it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 826/2320 [09:36<16:24,  1.52it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 827/2320 [09:37<16:19,  1.52it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 828/2320 [09:37<16:08,  1.54it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 829/2320 [09:38<16:02,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 830/2320 [09:39<15:58,  1.56it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 831/2320 [09:39<15:56,  1.56it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 832/2320 [09:40<15:53,  1.56it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 833/2320 [09:41<15:49,  1.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 834/2320 [09:41<15:44,  1.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 835/2320 [09:42<15:39,  1.58it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 836/2320 [09:42<15:40,  1.58it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 837/2320 [09:43<15:40,  1.58it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 838/2320 [09:44<15:41,  1.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 839/2320 [09:44<15:49,  1.56it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 840/2320 [09:45<15:45,  1.57it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 841/2320 [09:46<15:53,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 842/2320 [09:46<15:51,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 843/2320 [09:47<15:51,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 844/2320 [09:48<16:02,  1.53it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 845/2320 [09:48<15:54,  1.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 846/2320 [09:49<15:46,  1.56it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 847/2320 [09:49<15:41,  1.57it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 848/2320 [09:50<15:17,  1.60it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 849/2320 [09:51<15:24,  1.59it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [09:51<15:03,  1.63it/s]                                                   37%|â–ˆâ–ˆâ–ˆâ–‹      | 850/2320 [09:51<15:03,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 851/2320 [09:52<15:18,  1.60it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 852/2320 [09:53<15:05,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 853/2320 [09:53<14:50,  1.65it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 854/2320 [09:54<15:02,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 855/2320 [09:54<14:57,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 856/2320 [09:55<15:04,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 857/2320 [09:56<14:48,  1.65it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 858/2320 [09:56<15:03,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 859/2320 [09:57<14:47,  1.65it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 860/2320 [09:57<14:58,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 861/2320 [09:58<15:06,  1.61it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 862/2320 [09:59<15:18,  1.59it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 863/2320 [09:59<15:24,  1.58it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 864/2320 [10:00<15:37,  1.55it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 865/2320 [10:01<15:41,  1.55it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 866/2320 [10:01<15:43,  1.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 867/2320 [10:02<15:40,  1.54it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 868/2320 [10:03<15:16,  1.58it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 869/2320 [10:03<15:03,  1.61it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 870/2320 [10:04<14:53,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 871/2320 [10:04<14:54,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 872/2320 [10:05<15:04,  1.60it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 873/2320 [10:06<15:14,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 874/2320 [10:06<15:15,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 875/2320 [10:07<15:15,  1.58it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 876/2320 [10:08<15:19,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 877/2320 [10:08<15:19,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 878/2320 [10:09<15:22,  1.56it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 879/2320 [10:10<15:18,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 880/2320 [10:10<15:18,  1.57it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 881/2320 [10:11<14:52,  1.61it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 882/2320 [10:11<14:56,  1.60it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 883/2320 [10:12<14:47,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 884/2320 [10:13<14:54,  1.61it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 885/2320 [10:13<14:47,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 886/2320 [10:14<14:47,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 887/2320 [10:14<14:36,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 888/2320 [10:15<14:48,  1.61it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 889/2320 [10:16<14:36,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 890/2320 [10:16<14:50,  1.61it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 891/2320 [10:17<14:38,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 892/2320 [10:18<14:29,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 893/2320 [10:18<14:41,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 894/2320 [10:19<14:21,  1.66it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 895/2320 [10:19<14:34,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 896/2320 [10:20<14:45,  1.61it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 897/2320 [10:21<14:36,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 898/2320 [10:21<14:24,  1.64it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 899/2320 [10:22<14:45,  1.60it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [10:22<14:32,  1.63it/s]                                                   39%|â–ˆâ–ˆâ–ˆâ–‰      | 900/2320 [10:22<14:32,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 901/2320 [10:23<14:42,  1.61it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 902/2320 [10:24<14:55,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 903/2320 [10:24<15:05,  1.57it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 904/2320 [10:25<15:10,  1.56it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 905/2320 [10:26<15:17,  1.54it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 906/2320 [10:26<15:13,  1.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 907/2320 [10:27<14:48,  1.59it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 908/2320 [10:28<14:48,  1.59it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 909/2320 [10:28<14:30,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 910/2320 [10:29<14:27,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 911/2320 [10:29<14:37,  1.61it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 912/2320 [10:30<14:35,  1.61it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 913/2320 [10:31<14:30,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 914/2320 [10:31<14:28,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 915/2320 [10:32<14:49,  1.58it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 916/2320 [10:33<14:56,  1.57it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 917/2320 [10:33<14:52,  1.57it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 918/2320 [10:34<15:01,  1.55it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 919/2320 [10:35<15:16,  1.53it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 920/2320 [10:35<14:46,  1.58it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 921/2320 [10:36<14:50,  1.57it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 922/2320 [10:36<14:27,  1.61it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 923/2320 [10:37<14:37,  1.59it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 924/2320 [10:38<14:20,  1.62it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 925/2320 [10:38<14:28,  1.61it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 926/2320 [10:39<14:16,  1.63it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 927/2320 [10:39<14:15,  1.63it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [10:40<13:00,  1.78it/s]{'eval_loss': 1.0764439105987549, 'eval_precision': 0.9222746950019677, 'eval_recall': 0.6479126347802046, 'eval_f1': 0.7611237414745047, 'eval_report': {'PAGE_HEADER': {'precision': 0.26046511627906976, 'recall': 0.3522012578616352, 'f1-score': 0.2994652406417112, 'support': 159.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7.0}, 'RECIPE_TITLE': {'precision': 0.20300751879699247, 'recall': 0.36, 'f1-score': 0.25961538461538464, 'support': 75.0}, 'INGREDIENT_LINE': {'precision': 0.7629262926292629, 'recall': 0.6933266683329168, 'f1-score': 0.7264632709178998, 'support': 4001.0}, 'INSTRUCTION_STEP': {'precision': 0.6391896611945511, 'recall': 0.6116310160427807, 'f1-score': 0.6251067463706234, 'support': 2992.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.852985380516464, 'recall': 0.8755960729312763, 'f1-score': 0.8641428472558654, 'support': 14260.0}, 'accuracy': 0.7989671536242673, 'macro avg': {'precision': 0.38836770991662, 'recall': 0.4132507164526585, 'f1-score': 0.39639906997164065, 'support': 21494.0}, 'weighted avg': {'precision': 0.7995317114853775, 'recall': 0.7989671536242673, 'f1-score': 0.7986722834772609, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[56, 0, 3, 13, 7, 0, 80], [1, 0, 0, 0, 0, 0, 6], [1, 0, 27, 11, 7, 0, 29], [85, 1, 64, 2774, 83, 8, 986], [0, 0, 0, 111, 1830, 0, 1051], [0, 0, 0, 0, 0, 0, 0], [72, 0, 39, 727, 936, 0, 12486]], 'eval_PAGE_HEADER_precision': 0.19696969696969696, 'eval_PAGE_HEADER_recall': 0.17647058823529413, 'eval_PAGE_HEADER_f1': 0.18615751789976134, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.05, 'eval_RECIPE_TITLE_recall': 0.035211267605633804, 'eval_RECIPE_TITLE_f1': 0.041322314049586785, 'eval_header_false_positive_rate': 0.029850746268656716, 'eval_title_false_negative_rate': 0.09259259259259259, 'eval_header_title_confusion_count': 23, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14798, 'INGREDIENT_LINE': 4814, 'INSTRUCTION_STEP': 2355, 'PAGE_HEADER': 198, 'SECTION_HEADER': 15, 'RECIPE_TITLE': 100}, 'eval_title_anchor_accuracy': 0.5, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 3, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.4712, 'eval_samples_per_second': 14.217, 'eval_steps_per_second': 3.554, 'epoch': 7.0}
{'loss': 0.5247, 'grad_norm': 6.143082618713379, 'learning_rate': 3.5201149425287353e-05, 'epoch': 7.33}
{'loss': 0.5273, 'grad_norm': 4.186371803283691, 'learning_rate': 3.400383141762452e-05, 'epoch': 7.76}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.54it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.35it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.68it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.26it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.08it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:03,  4.08it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.83it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.75it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.74it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.73it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.68it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.63it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.59it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.68it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.74it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.67it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.67it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.74it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.65it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.73it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.76it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.16it/s][A                                                  
                                               [A 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 928/2320 [10:46<13:00,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.16it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 929/2320 [10:50<1:17:32,  3.34s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 930/2320 [10:50<58:18,  2.52s/it]   40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 931/2320 [10:51<44:56,  1.94s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 932/2320 [10:52<35:50,  1.55s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 933/2320 [10:52<29:34,  1.28s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 934/2320 [10:53<25:09,  1.09s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 935/2320 [10:53<22:07,  1.04it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 936/2320 [10:54<19:47,  1.17it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 937/2320 [10:55<18:13,  1.26it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 938/2320 [10:55<17:08,  1.34it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 939/2320 [10:56<16:21,  1.41it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 940/2320 [10:57<15:49,  1.45it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 941/2320 [10:57<15:27,  1.49it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 942/2320 [10:58<15:19,  1.50it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 943/2320 [10:59<15:10,  1.51it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 944/2320 [10:59<14:58,  1.53it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 945/2320 [11:00<14:53,  1.54it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 946/2320 [11:01<14:56,  1.53it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 947/2320 [11:01<14:52,  1.54it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 948/2320 [11:02<14:19,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 949/2320 [11:02<14:26,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [11:03<14:28,  1.58it/s]                                                   41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 950/2320 [11:03<14:28,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 951/2320 [11:04<14:08,  1.61it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 952/2320 [11:04<14:12,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 953/2320 [11:05<14:16,  1.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 954/2320 [11:06<14:17,  1.59it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 955/2320 [11:06<14:21,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 956/2320 [11:07<14:23,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 957/2320 [11:07<14:21,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 958/2320 [11:08<14:24,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 959/2320 [11:09<14:20,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 960/2320 [11:09<14:22,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 961/2320 [11:10<14:21,  1.58it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 962/2320 [11:11<14:21,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 963/2320 [11:11<14:06,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 964/2320 [11:12<14:09,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 965/2320 [11:12<13:53,  1.62it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 966/2320 [11:13<14:03,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 967/2320 [11:14<14:16,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 968/2320 [11:14<14:15,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 969/2320 [11:15<14:17,  1.57it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 970/2320 [11:16<14:16,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 971/2320 [11:16<14:16,  1.58it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 972/2320 [11:17<14:19,  1.57it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 973/2320 [11:18<14:30,  1.55it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 974/2320 [11:18<14:21,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 975/2320 [11:19<13:59,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 976/2320 [11:19<13:56,  1.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 977/2320 [11:20<13:37,  1.64it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 978/2320 [11:21<13:51,  1.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 979/2320 [11:21<13:56,  1.60it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 980/2320 [11:22<13:34,  1.64it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 981/2320 [11:22<13:45,  1.62it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 982/2320 [11:23<13:53,  1.61it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 983/2320 [11:24<14:54,  1.49it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 984/2320 [11:25<14:41,  1.52it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 985/2320 [11:25<14:14,  1.56it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 986/2320 [11:26<14:14,  1.56it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 987/2320 [11:26<14:09,  1.57it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 988/2320 [11:27<13:44,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 989/2320 [11:28<13:44,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 990/2320 [11:28<13:54,  1.59it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 991/2320 [11:29<13:34,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 992/2320 [11:29<13:45,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 993/2320 [11:30<13:42,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 994/2320 [11:31<13:57,  1.58it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 995/2320 [11:31<14:16,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 996/2320 [11:32<14:19,  1.54it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 997/2320 [11:33<14:20,  1.54it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 998/2320 [11:33<13:57,  1.58it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 999/2320 [11:34<14:04,  1.56it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [11:35<14:08,  1.56it/s]                                                    43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1000/2320 [11:35<14:08,  1.56it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1001/2320 [11:35<14:06,  1.56it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1002/2320 [11:36<14:07,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1003/2320 [11:37<14:07,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1004/2320 [11:37<14:08,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1005/2320 [11:38<14:08,  1.55it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1006/2320 [11:38<13:49,  1.58it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1007/2320 [11:39<13:51,  1.58it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1008/2320 [11:40<13:34,  1.61it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1009/2320 [11:40<13:45,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1010/2320 [11:41<13:26,  1.62it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1011/2320 [11:42<13:30,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1012/2320 [11:42<13:24,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1013/2320 [11:43<13:23,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 1014/2320 [11:43<13:23,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1015/2320 [11:44<13:28,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1016/2320 [11:45<13:29,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1017/2320 [11:45<13:22,  1.62it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1018/2320 [11:46<13:27,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1019/2320 [11:46<13:40,  1.59it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1020/2320 [11:47<13:46,  1.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1021/2320 [11:48<13:49,  1.57it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1022/2320 [11:48<13:55,  1.55it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1023/2320 [11:49<14:08,  1.53it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1024/2320 [11:50<14:13,  1.52it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1025/2320 [11:50<14:06,  1.53it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1026/2320 [11:51<14:01,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1027/2320 [11:52<14:00,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1028/2320 [11:52<13:57,  1.54it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1029/2320 [11:53<13:48,  1.56it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1030/2320 [11:54<13:27,  1.60it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1031/2320 [11:54<13:20,  1.61it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1032/2320 [11:55<13:25,  1.60it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1033/2320 [11:55<13:08,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1034/2320 [11:56<13:19,  1.61it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1035/2320 [11:57<13:25,  1.60it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1036/2320 [11:57<13:10,  1.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1037/2320 [11:58<13:08,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1038/2320 [11:58<13:04,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1039/2320 [11:59<13:13,  1.61it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1040/2320 [12:00<13:11,  1.62it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1041/2320 [12:00<13:01,  1.64it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1042/2320 [12:01<13:03,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 1043/2320 [12:02<13:03,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [12:02<11:56,  1.78it/s]{'eval_loss': 1.0391170978546143, 'eval_precision': 0.9144112478031634, 'eval_recall': 0.5244431004939019, 'eval_f1': 0.6665812568060983, 'eval_report': {'PAGE_HEADER': {'precision': 0.7069767441860465, 'recall': 0.39276485788113696, 'f1-score': 0.5049833887043189, 'support': 387.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7.0}, 'RECIPE_TITLE': {'precision': 0.7218045112781954, 'recall': 0.2865671641791045, 'f1-score': 0.41025641025641024, 'support': 335.0}, 'INGREDIENT_LINE': {'precision': 0.7497249724972497, 'recall': 0.7082359054299818, 'f1-score': 0.7283901135604542, 'support': 3849.0}, 'INSTRUCTION_STEP': {'precision': 0.7785539643730353, 'recall': 0.4171813587871982, 'f1-score': 0.5432610285157202, 'support': 5343.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7109577811176391, 'recall': 0.899248250237622, 'f1-score': 0.7940940826370608, 'support': 11573.0}, 'accuracy': 0.7262491858192984, 'macro avg': {'precision': 0.5240025676360237, 'recall': 0.3862853623592919, 'f1-score': 0.42585500338199495, 'support': 21494.0}, 'weighted avg': {'precision': 0.7345689105303654, 'recall': 0.7262491858192984, 'f1-score': 0.7085294737916096, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[152, 0, 11, 20, 41, 4, 159], [1, 0, 0, 0, 0, 0, 6], [18, 0, 96, 31, 33, 4, 153], [36, 1, 26, 2726, 70, 0, 990], [0, 0, 0, 191, 2229, 0, 2923], [0, 0, 0, 0, 0, 0, 0], [8, 0, 0, 668, 490, 0, 10407]], 'eval_PAGE_HEADER_precision': 0.24129930394431554, 'eval_PAGE_HEADER_recall': 0.47058823529411764, 'eval_PAGE_HEADER_f1': 0.31901840490797545, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.10052910052910052, 'eval_RECIPE_TITLE_recall': 0.2676056338028169, 'eval_RECIPE_TITLE_f1': 0.14615384615384613, 'eval_header_false_positive_rate': 0.1356382978723404, 'eval_title_false_negative_rate': 0.2, 'eval_header_title_confusion_count': 96, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 12492, 'INGREDIENT_LINE': 4528, 'INSTRUCTION_STEP': 4436, 'PAGE_HEADER': 431, 'SECTION_HEADER': 15, 'RECIPE_TITLE': 378}, 'eval_title_anchor_accuracy': 1.0, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 6, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.5071, 'eval_samples_per_second': 14.138, 'eval_steps_per_second': 3.535, 'epoch': 8.0}
{'loss': 0.378, 'grad_norm': 3.404872417449951, 'learning_rate': 3.2806513409961684e-05, 'epoch': 8.19}
{'loss': 0.328, 'grad_norm': 4.155355930328369, 'learning_rate': 3.160919540229885e-05, 'epoch': 8.62}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:02,  7.55it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.33it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.50it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.26it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  4.08it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.94it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:03,  3.76it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.74it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.83it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.73it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:02<00:02,  3.78it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.76it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.75it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.73it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.77it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.87it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.75it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.77it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.76it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.74it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  4.05it/s][A                                                   
                                               [A 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1044/2320 [12:08<11:56,  1.78it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  4.05it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1045/2320 [12:12<1:11:07,  3.35s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1046/2320 [12:12<53:25,  2.52s/it]   45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1047/2320 [12:13<41:16,  1.95s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1048/2320 [12:14<32:51,  1.55s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1049/2320 [12:14<26:44,  1.26s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [12:15<22:36,  1.07s/it]                                                    45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1050/2320 [12:15<22:36,  1.07s/it] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1051/2320 [12:15<19:36,  1.08it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1052/2320 [12:16<17:42,  1.19it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1053/2320 [12:17<16:26,  1.28it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1054/2320 [12:17<15:34,  1.35it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1055/2320 [12:18<15:00,  1.40it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1056/2320 [12:19<14:33,  1.45it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1057/2320 [12:19<14:26,  1.46it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1058/2320 [12:20<14:15,  1.48it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1059/2320 [12:21<14:12,  1.48it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1060/2320 [12:21<13:56,  1.51it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1061/2320 [12:22<13:47,  1.52it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1062/2320 [12:23<13:50,  1.51it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1063/2320 [12:23<13:44,  1.52it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1064/2320 [12:24<13:22,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1065/2320 [12:25<13:16,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1066/2320 [12:25<12:59,  1.61it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1067/2320 [12:26<13:13,  1.58it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1068/2320 [12:26<13:16,  1.57it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1069/2320 [12:27<13:20,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1070/2320 [12:28<13:20,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1071/2320 [12:28<13:23,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 1072/2320 [12:29<13:21,  1.56it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1073/2320 [12:30<13:26,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1074/2320 [12:30<13:22,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1075/2320 [12:31<13:25,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1076/2320 [12:32<13:24,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1077/2320 [12:32<13:22,  1.55it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1078/2320 [12:33<13:21,  1.55it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1079/2320 [12:34<13:29,  1.53it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1080/2320 [12:34<13:16,  1.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1081/2320 [12:35<12:54,  1.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1082/2320 [12:35<12:47,  1.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1083/2320 [12:36<12:53,  1.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1084/2320 [12:37<12:44,  1.62it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1085/2320 [12:37<12:54,  1.59it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1086/2320 [12:38<12:38,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1087/2320 [12:38<12:35,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1088/2320 [12:39<12:46,  1.61it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1089/2320 [12:40<12:33,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1090/2320 [12:40<12:26,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1091/2320 [12:41<12:33,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1092/2320 [12:41<12:28,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1093/2320 [12:42<12:39,  1.62it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1094/2320 [12:43<12:32,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1095/2320 [12:43<12:36,  1.62it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1096/2320 [12:44<12:29,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1097/2320 [12:45<12:43,  1.60it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1098/2320 [12:45<12:55,  1.58it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1099/2320 [12:46<13:02,  1.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [12:47<13:01,  1.56it/s]                                                    47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1100/2320 [12:47<13:01,  1.56it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 1101/2320 [12:47<13:03,  1.56it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1102/2320 [12:48<13:04,  1.55it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1103/2320 [12:48<12:46,  1.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1104/2320 [12:49<12:51,  1.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1105/2320 [12:50<12:33,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1106/2320 [12:50<12:42,  1.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1107/2320 [12:51<12:29,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1108/2320 [12:52<12:21,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1109/2320 [12:52<12:38,  1.60it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1110/2320 [12:53<12:22,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1111/2320 [12:53<12:34,  1.60it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1112/2320 [12:54<12:24,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1113/2320 [12:55<12:24,  1.62it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1114/2320 [12:55<12:45,  1.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1115/2320 [12:56<12:47,  1.57it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1116/2320 [12:57<12:45,  1.57it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1117/2320 [12:57<12:52,  1.56it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1118/2320 [12:58<12:59,  1.54it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1119/2320 [12:59<12:48,  1.56it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1120/2320 [12:59<12:38,  1.58it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1121/2320 [13:00<12:32,  1.59it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1122/2320 [13:00<12:26,  1.60it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1123/2320 [13:01<12:21,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1124/2320 [13:02<12:22,  1.61it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1125/2320 [13:02<12:21,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1126/2320 [13:03<12:32,  1.59it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1127/2320 [13:04<12:38,  1.57it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1128/2320 [13:04<13:12,  1.50it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1129/2320 [13:05<12:44,  1.56it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 1130/2320 [13:05<12:49,  1.55it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1131/2320 [13:06<12:34,  1.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1132/2320 [13:07<12:28,  1.59it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1133/2320 [13:07<12:18,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1134/2320 [13:08<12:11,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1135/2320 [13:09<12:04,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1136/2320 [13:09<12:17,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1137/2320 [13:10<12:09,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1138/2320 [13:10<12:14,  1.61it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1139/2320 [13:11<12:11,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1140/2320 [13:12<12:07,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1141/2320 [13:12<12:07,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1142/2320 [13:13<12:04,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1143/2320 [13:13<12:03,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1144/2320 [13:14<12:13,  1.60it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1145/2320 [13:15<12:21,  1.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1146/2320 [13:15<12:24,  1.58it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1147/2320 [13:16<12:34,  1.55it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1148/2320 [13:17<12:36,  1.55it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1149/2320 [13:17<12:23,  1.57it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [13:18<12:18,  1.58it/s]                                                    50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1150/2320 [13:18<12:18,  1.58it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1151/2320 [13:19<12:21,  1.58it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1152/2320 [13:19<12:30,  1.56it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1153/2320 [13:20<12:28,  1.56it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1154/2320 [13:21<12:29,  1.56it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1155/2320 [13:21<12:30,  1.55it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1156/2320 [13:22<12:29,  1.55it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1157/2320 [13:22<12:30,  1.55it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1158/2320 [13:23<12:15,  1.58it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 1159/2320 [13:24<12:10,  1.59it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [13:24<11:02,  1.75it/s]{'eval_loss': 1.1108301877975464, 'eval_precision': 0.9210188748396555, 'eval_recall': 0.5780998389694042, 'eval_f1': 0.7103384919793654, 'eval_report': {'PAGE_HEADER': {'precision': 0.4744186046511628, 'recall': 0.35051546391752575, 'f1-score': 0.4031620553359684, 'support': 291.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.3458646616541353, 'recall': 0.2987012987012987, 'f1-score': 0.3205574912891986, 'support': 154.0}, 'INGREDIENT_LINE': {'precision': 0.7887788778877888, 'recall': 0.6203763789746918, 'f1-score': 0.6945150744642209, 'support': 4623.0}, 'INSTRUCTION_STEP': {'precision': 0.7020607754104087, 'recall': 0.5592654424040067, 'f1-score': 0.622580145578442, 'support': 3594.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 26.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.7788632326820604, 'recall': 0.890703125, 'f1-score': 0.8310372476127997, 'support': 12800.0}, 'accuracy': 0.7642597934307248, 'macro avg': {'precision': 0.38624826903569454, 'recall': 0.3399452136246903, 'f1-score': 0.3589815017850787, 'support': 21494.0}, 'weighted avg': {'precision': 0.7597701465282802, 'recall': 0.7642597934307248, 'f1-score': 0.7561300369248234, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[102, 0, 7, 32, 15, 0, 0, 135], [0, 0, 0, 0, 0, 0, 0, 6], [3, 0, 46, 9, 12, 0, 0, 84], [57, 1, 49, 2868, 134, 0, 8, 1506], [0, 0, 0, 104, 2010, 0, 0, 1480], [0, 0, 0, 0, 0, 0, 0, 26], [0, 0, 0, 0, 0, 0, 0, 0], [53, 0, 31, 623, 692, 0, 0, 11401]], 'eval_PAGE_HEADER_precision': 0.1787709497206704, 'eval_PAGE_HEADER_recall': 0.2895927601809955, 'eval_PAGE_HEADER_f1': 0.2210708117443869, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.07909604519774012, 'eval_RECIPE_TITLE_recall': 0.09859154929577464, 'eval_RECIPE_TITLE_f1': 0.0877742946708464, 'eval_header_false_positive_rate': 0.04040404040404041, 'eval_title_false_negative_rate': 0.15675675675675677, 'eval_header_title_confusion_count': 41, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 13233, 'INGREDIENT_LINE': 5406, 'INSTRUCTION_STEP': 3063, 'PAGE_HEADER': 358, 'RECIPE_TITLE': 177, 'SECTION_HEADER': 11, 'TEMP': 32}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.4625, 'eval_samples_per_second': 14.236, 'eval_steps_per_second': 3.559, 'epoch': 9.0}
{'loss': 0.3106, 'grad_norm': 6.371334552764893, 'learning_rate': 3.0411877394636018e-05, 'epoch': 9.05}
{'loss': 0.2801, 'grad_norm': 2.1016385555267334, 'learning_rate': 2.9214559386973183e-05, 'epoch': 9.48}
{'loss': 0.2693, 'grad_norm': 8.797404289245605, 'learning_rate': 2.8017241379310345e-05, 'epoch': 9.91}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.96it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:03,  5.06it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  4.27it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  4.09it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.96it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.85it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:01<00:04,  3.73it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:03,  3.69it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:03,  3.69it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:02<00:03,  3.71it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:02,  3.71it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:02,  3.64it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:03<00:02,  3.65it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:03<00:02,  3.70it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:01,  3.65it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:04<00:01,  3.65it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:04<00:01,  3.70it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:04<00:01,  3.68it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.68it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:05<00:00,  3.67it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:05<00:00,  3.65it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:05<00:00,  3.97it/s][A                                                   
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1160/2320 [13:31<11:02,  1.75it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.97it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1161/2320 [13:34<1:06:29,  3.44s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1162/2320 [13:35<49:55,  2.59s/it]   50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1163/2320 [13:35<38:17,  1.99s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1164/2320 [13:36<30:19,  1.57s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1165/2320 [13:37<24:38,  1.28s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1166/2320 [13:37<20:57,  1.09s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1167/2320 [13:38<18:07,  1.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1168/2320 [13:39<16:19,  1.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1169/2320 [13:39<15:10,  1.26it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1170/2320 [13:40<14:16,  1.34it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1171/2320 [13:40<13:37,  1.41it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1172/2320 [13:41<13:10,  1.45it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1173/2320 [13:42<12:36,  1.52it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1174/2320 [13:42<12:26,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1175/2320 [13:43<12:30,  1.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1176/2320 [13:44<12:27,  1.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1177/2320 [13:44<12:23,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1178/2320 [13:45<12:18,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1179/2320 [13:46<12:13,  1.55it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1180/2320 [13:46<12:11,  1.56it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1181/2320 [13:47<12:20,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1182/2320 [13:48<12:22,  1.53it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1183/2320 [13:48<12:16,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1184/2320 [13:49<12:18,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1185/2320 [13:49<12:15,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1186/2320 [13:50<12:15,  1.54it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1187/2320 [13:51<11:57,  1.58it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1188/2320 [13:51<12:00,  1.57it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1189/2320 [13:52<11:42,  1.61it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1190/2320 [13:53<11:36,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1191/2320 [13:53<11:41,  1.61it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1192/2320 [13:54<11:46,  1.60it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1193/2320 [13:54<11:54,  1.58it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1194/2320 [13:55<11:56,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1195/2320 [13:56<11:57,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1196/2320 [13:56<11:57,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1197/2320 [13:57<12:00,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1198/2320 [13:58<11:58,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1199/2320 [13:58<11:53,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [13:59<11:55,  1.57it/s]                                                    52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1200/2320 [13:59<11:55,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1201/2320 [14:00<11:51,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1202/2320 [14:00<11:53,  1.57it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1203/2320 [14:01<11:55,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1204/2320 [14:02<11:53,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1205/2320 [14:02<11:58,  1.55it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1206/2320 [14:03<11:56,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1207/2320 [14:03<11:55,  1.56it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1208/2320 [14:04<11:41,  1.58it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1209/2320 [14:05<11:30,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1210/2320 [14:05<11:21,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1211/2320 [14:06<11:28,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1212/2320 [14:07<11:30,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1213/2320 [14:07<11:23,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1214/2320 [14:08<11:24,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1215/2320 [14:08<11:16,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1216/2320 [14:09<11:06,  1.66it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1217/2320 [14:10<11:23,  1.61it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1218/2320 [14:10<11:29,  1.60it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1219/2320 [14:11<11:37,  1.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1220/2320 [14:12<11:40,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1221/2320 [14:12<11:44,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1222/2320 [14:13<11:44,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1223/2320 [14:13<11:51,  1.54it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1224/2320 [14:14<11:32,  1.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1225/2320 [14:15<11:40,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1226/2320 [14:15<11:25,  1.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1227/2320 [14:16<11:12,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1228/2320 [14:17<11:13,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1229/2320 [14:17<11:13,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1230/2320 [14:18<11:16,  1.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1231/2320 [14:18<11:08,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1232/2320 [14:19<11:15,  1.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1233/2320 [14:20<11:08,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1234/2320 [14:20<11:15,  1.61it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1235/2320 [14:21<11:21,  1.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1236/2320 [14:22<11:23,  1.59it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1237/2320 [14:22<11:26,  1.58it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1238/2320 [14:23<11:27,  1.57it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1239/2320 [14:23<11:32,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1240/2320 [14:24<11:34,  1.56it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1241/2320 [14:25<11:19,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1242/2320 [14:25<11:16,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1243/2320 [14:26<11:16,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1244/2320 [14:27<11:18,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1245/2320 [14:27<11:23,  1.57it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 1246/2320 [14:28<11:21,  1.58it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1247/2320 [14:29<11:20,  1.58it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1248/2320 [14:29<11:17,  1.58it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1249/2320 [14:30<11:25,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [14:30<11:24,  1.56it/s]                                                    54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1250/2320 [14:30<11:24,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1251/2320 [14:31<11:24,  1.56it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1252/2320 [14:32<11:13,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1253/2320 [14:32<11:10,  1.59it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1254/2320 [14:33<11:07,  1.60it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1255/2320 [14:34<11:06,  1.60it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1256/2320 [14:34<10:59,  1.61it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1257/2320 [14:35<10:54,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1258/2320 [14:35<10:56,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1259/2320 [14:36<10:54,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1260/2320 [14:37<10:53,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1261/2320 [14:37<10:51,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1262/2320 [14:38<10:44,  1.64it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1263/2320 [14:38<10:51,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1264/2320 [14:39<10:52,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1265/2320 [14:40<10:52,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1266/2320 [14:40<10:51,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1267/2320 [14:41<10:47,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1268/2320 [14:42<10:45,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1269/2320 [14:42<10:46,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1270/2320 [14:43<10:48,  1.62it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1271/2320 [14:43<11:03,  1.58it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1272/2320 [14:44<11:10,  1.56it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1273/2320 [14:45<11:17,  1.54it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1274/2320 [14:45<11:14,  1.55it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 1275/2320 [14:46<11:12,  1.55it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [14:46<10:12,  1.71it/s]{'eval_loss': 1.1607918739318848, 'eval_precision': 0.924812030075188, 'eval_recall': 0.6678268133092022, 'eval_f1': 0.7755860953920776, 'eval_report': {'PAGE_HEADER': {'precision': 0.4790697674418605, 'recall': 0.42213114754098363, 'f1-score': 0.44880174291938996, 'support': 244.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 6.0}, 'RECIPE_TITLE': {'precision': 0.44360902255639095, 'recall': 0.4338235294117647, 'f1-score': 0.43866171003717475, 'support': 136.0}, 'INGREDIENT_LINE': {'precision': 0.7189218921892189, 'recall': 0.7649985367281241, 'f1-score': 0.7412448603431164, 'support': 3417.0}, 'INSTRUCTION_STEP': {'precision': 0.7059028990569333, 'recall': 0.5995253633936517, 'f1-score': 0.6483798524222009, 'support': 3371.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8636425741221478, 'recall': 0.8833764237299979, 'f1-score': 0.8733980448374727, 'support': 14311.0}, 'accuracy': 0.8113427002884526, 'macro avg': {'precision': 0.4013932694208189, 'recall': 0.38798187510056525, 'f1-score': 0.39381077631991934, 'support': 21494.0}, 'weighted avg': {'precision': 0.8082705642001036, 'recall': 0.8113427002884526, 'f1-score': 0.8089181728768088, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[103, 0, 4, 49, 10, 0, 1, 77], [0, 0, 0, 0, 0, 0, 0, 6], [9, 0, 59, 25, 12, 0, 0, 31], [34, 1, 20, 2614, 79, 0, 7, 662], [1, 0, 2, 136, 2021, 0, 0, 1211], [0, 0, 0, 0, 0, 0, 0, 9], [0, 0, 0, 0, 0, 0, 0, 0], [68, 0, 48, 812, 741, 0, 0, 12642]], 'eval_PAGE_HEADER_precision': 0.1925287356321839, 'eval_PAGE_HEADER_recall': 0.3031674208144796, 'eval_PAGE_HEADER_f1': 0.2355008787346221, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1073170731707317, 'eval_RECIPE_TITLE_recall': 0.15492957746478872, 'eval_RECIPE_TITLE_f1': 0.12680115273775217, 'eval_header_false_positive_rate': 0.08860759493670886, 'eval_title_false_negative_rate': 0.15463917525773196, 'eval_header_title_confusion_count': 58, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 14496, 'INGREDIENT_LINE': 4294, 'INSTRUCTION_STEP': 2912, 'PAGE_HEADER': 348, 'RECIPE_TITLE': 205, 'SECTION_HEADER': 14, 'TEMP': 11}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 6.6067, 'eval_samples_per_second': 13.925, 'eval_steps_per_second': 3.481, 'epoch': 10.0}
{'loss': 0.198, 'grad_norm': 3.272210121154785, 'learning_rate': 2.681992337164751e-05, 'epoch': 10.34}
{'loss': 0.2005, 'grad_norm': 2.4742650985717773, 'learning_rate': 2.5622605363984675e-05, 'epoch': 10.78}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.67it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.36it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.37it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.18it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.00it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.93it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.83it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.80it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  3.02it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.14it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.19it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  3.06it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  3.00it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.09it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  3.11it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.15it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.59it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.73it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.69it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  2.80it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.87it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.22it/s][A                                                   
                                               [A 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1276/2320 [14:55<10:12,  1.71it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.22it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1277/2320 [15:00<1:19:05,  4.55s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1278/2320 [15:01<58:25,  3.36s/it]   55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1279/2320 [15:02<44:04,  2.54s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1280/2320 [15:02<34:07,  1.97s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1281/2320 [15:03<27:07,  1.57s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1282/2320 [15:03<22:24,  1.30s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1283/2320 [15:04<18:58,  1.10s/it] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1284/2320 [15:05<16:43,  1.03it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1285/2320 [15:05<14:55,  1.16it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1286/2320 [15:06<13:48,  1.25it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1287/2320 [15:07<13:04,  1.32it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1288/2320 [15:07<12:29,  1.38it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1289/2320 [15:08<12:10,  1.41it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1290/2320 [15:09<11:38,  1.47it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1291/2320 [15:09<11:30,  1.49it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1292/2320 [15:10<11:13,  1.53it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1293/2320 [15:11<11:28,  1.49it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1294/2320 [15:11<11:34,  1.48it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1295/2320 [15:12<11:52,  1.44it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1296/2320 [15:13<12:32,  1.36it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1297/2320 [15:14<12:39,  1.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1298/2320 [15:14<12:58,  1.31it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1299/2320 [15:15<13:06,  1.30it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [15:16<13:21,  1.27it/s]                                                    56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1300/2320 [15:16<13:21,  1.27it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1301/2320 [15:17<13:28,  1.26it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1302/2320 [15:18<13:07,  1.29it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1303/2320 [15:18<12:34,  1.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1304/2320 [15:19<12:23,  1.37it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1305/2320 [15:20<12:30,  1.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1306/2320 [15:20<12:28,  1.36it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1307/2320 [15:21<12:29,  1.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1308/2320 [15:22<12:34,  1.34it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1309/2320 [15:23<12:31,  1.35it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1310/2320 [15:23<12:28,  1.35it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1311/2320 [15:24<12:37,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1312/2320 [15:25<12:45,  1.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1313/2320 [15:26<12:43,  1.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1314/2320 [15:26<12:33,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1315/2320 [15:27<12:06,  1.38it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1316/2320 [15:28<11:52,  1.41it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1317/2320 [15:28<11:55,  1.40it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1318/2320 [15:29<12:10,  1.37it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1319/2320 [15:30<12:30,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1320/2320 [15:31<12:41,  1.31it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1321/2320 [15:32<12:31,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1322/2320 [15:32<12:53,  1.29it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1323/2320 [15:33<13:01,  1.28it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1324/2320 [15:34<13:06,  1.27it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1325/2320 [15:35<12:37,  1.31it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1326/2320 [15:35<12:28,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1327/2320 [15:36<12:42,  1.30it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1328/2320 [15:37<12:31,  1.32it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1329/2320 [15:38<12:24,  1.33it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1330/2320 [15:38<12:21,  1.34it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1331/2320 [15:39<12:18,  1.34it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1332/2320 [15:40<12:13,  1.35it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 1333/2320 [15:41<12:12,  1.35it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1334/2320 [15:41<12:01,  1.37it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1335/2320 [15:42<12:10,  1.35it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1336/2320 [15:43<12:27,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1337/2320 [15:44<12:26,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1338/2320 [15:44<12:22,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1339/2320 [15:45<12:29,  1.31it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1340/2320 [15:46<12:23,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1341/2320 [15:47<12:01,  1.36it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1342/2320 [15:47<11:53,  1.37it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1343/2320 [15:48<11:59,  1.36it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1344/2320 [15:49<12:11,  1.33it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1345/2320 [15:50<12:02,  1.35it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1346/2320 [15:50<12:09,  1.34it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1347/2320 [15:51<12:12,  1.33it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1348/2320 [15:52<12:23,  1.31it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1349/2320 [15:53<12:33,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [15:54<12:43,  1.27it/s]                                                    58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1350/2320 [15:54<12:43,  1.27it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1351/2320 [15:54<12:15,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1352/2320 [15:55<12:12,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1353/2320 [15:56<12:23,  1.30it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1354/2320 [15:57<12:26,  1.29it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1355/2320 [15:57<12:20,  1.30it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1356/2320 [15:58<12:08,  1.32it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1357/2320 [15:59<11:40,  1.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1358/2320 [15:59<11:23,  1.41it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1359/2320 [16:00<11:18,  1.42it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1360/2320 [16:01<11:32,  1.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1361/2320 [16:02<11:38,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 1362/2320 [16:02<11:41,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1363/2320 [16:03<11:41,  1.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1364/2320 [16:04<11:38,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1365/2320 [16:05<11:38,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1366/2320 [16:05<11:41,  1.36it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1367/2320 [16:06<11:33,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1368/2320 [16:07<11:32,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1369/2320 [16:07<11:29,  1.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1370/2320 [16:08<11:35,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1371/2320 [16:09<11:30,  1.37it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1372/2320 [16:10<11:26,  1.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1373/2320 [16:10<11:15,  1.40it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1374/2320 [16:11<11:20,  1.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1375/2320 [16:12<11:19,  1.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1376/2320 [16:12<11:17,  1.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1377/2320 [16:13<11:21,  1.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1378/2320 [16:14<11:15,  1.39it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1379/2320 [16:15<11:20,  1.38it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1380/2320 [16:15<11:21,  1.38it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1381/2320 [16:16<11:17,  1.39it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1382/2320 [16:17<11:27,  1.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1383/2320 [16:18<11:29,  1.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1384/2320 [16:18<11:30,  1.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1385/2320 [16:19<11:24,  1.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1386/2320 [16:20<11:22,  1.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1387/2320 [16:21<11:23,  1.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1388/2320 [16:21<11:18,  1.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1389/2320 [16:22<11:23,  1.36it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1390/2320 [16:23<11:19,  1.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 1391/2320 [16:23<10:50,  1.43it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [16:24<09:43,  1.59it/s]{'eval_loss': 1.2709730863571167, 'eval_precision': 0.9193264147248874, 'eval_recall': 0.695967981025793, 'eval_f1': 0.7922045051885599, 'eval_report': {'PAGE_HEADER': {'precision': 0.627906976744186, 'recall': 0.3708791208791209, 'f1-score': 0.46632124352331605, 'support': 364.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.7142857142857143, 'recall': 0.3333333333333333, 'f1-score': 0.45454545454545453, 'support': 285.0}, 'INGREDIENT_LINE': {'precision': 0.7010451045104511, 'recall': 0.8180359435173299, 'f1-score': 0.7550355450236966, 'support': 3116.0}, 'INSTRUCTION_STEP': {'precision': 0.6692280824310164, 'recall': 0.6440336134453781, 'f1-score': 0.6563891743747858, 'support': 2975.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 2.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8880311517966936, 'recall': 0.8814076484947111, 'f1-score': 0.8847070033349214, 'support': 14748.0}, 'accuracy': 0.8232064762259235, 'macro avg': {'precision': 0.45006212872100765, 'recall': 0.3809612074587342, 'f1-score': 0.40212480260027184, 'support': 21494.0}, 'weighted avg': {'precision': 0.8236821013162179, 'recall': 0.8232064762259235, 'f1-score': 0.8212707650707263, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[135, 0, 8, 41, 41, 0, 4, 135], [0, 0, 0, 0, 0, 0, 0, 4], [13, 0, 95, 23, 31, 0, 4, 119], [38, 1, 27, 2549, 71, 0, 0, 430], [0, 0, 0, 110, 1916, 0, 0, 949], [0, 0, 0, 0, 0, 0, 0, 2], [0, 0, 0, 0, 0, 0, 0, 0], [29, 0, 3, 913, 804, 0, 0, 12999]], 'eval_PAGE_HEADER_precision': 0.19743589743589743, 'eval_PAGE_HEADER_recall': 0.34841628959276016, 'eval_PAGE_HEADER_f1': 0.2520458265139116, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09907120743034056, 'eval_RECIPE_TITLE_recall': 0.22535211267605634, 'eval_RECIPE_TITLE_f1': 0.13763440860215054, 'eval_header_false_positive_rate': 0.13872832369942195, 'eval_title_false_negative_rate': 0.19444444444444445, 'eval_header_title_confusion_count': 90, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15231, 'INGREDIENT_LINE': 3927, 'INSTRUCTION_STEP': 2400, 'PAGE_HEADER': 390, 'RECIPE_TITLE': 323, 'SECTION_HEADER': 7, 'TEMP': 2}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.3921, 'eval_samples_per_second': 10.963, 'eval_steps_per_second': 2.741, 'epoch': 11.0}
{'loss': 0.2, 'grad_norm': 6.36073112487793, 'learning_rate': 2.442528735632184e-05, 'epoch': 11.21}
{'loss': 0.1678, 'grad_norm': 1.7532367706298828, 'learning_rate': 2.3227969348659002e-05, 'epoch': 11.64}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.33it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.71it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  3.94it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  3.66it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.58it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.48it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.32it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  3.19it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:04,  3.14it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.15it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.19it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:03,  3.17it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:02,  3.19it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.17it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.21it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.25it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.30it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.37it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.30it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.24it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:06<00:00,  3.22it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.51it/s][A                                                   
                                               [A 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1392/2320 [16:31<09:43,  1.59it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.51it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1393/2320 [16:36<1:04:16,  4.16s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1394/2320 [16:37<48:00,  3.11s/it]   60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1395/2320 [16:38<36:46,  2.39s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1396/2320 [16:38<28:46,  1.87s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1397/2320 [16:39<23:09,  1.51s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1398/2320 [16:40<19:12,  1.25s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1399/2320 [16:40<16:32,  1.08s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [16:41<14:40,  1.04it/s]                                                    60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1400/2320 [16:41<14:40,  1.04it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1401/2320 [16:42<13:21,  1.15it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1402/2320 [16:42<12:28,  1.23it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1403/2320 [16:43<12:03,  1.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1404/2320 [16:44<11:40,  1.31it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1405/2320 [16:44<11:25,  1.33it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1406/2320 [16:45<11:11,  1.36it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1407/2320 [16:46<11:56,  1.27it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1408/2320 [16:47<11:41,  1.30it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1409/2320 [16:47<11:31,  1.32it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1410/2320 [16:48<11:17,  1.34it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1411/2320 [16:49<11:24,  1.33it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1412/2320 [16:50<11:19,  1.34it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1413/2320 [16:50<11:20,  1.33it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1414/2320 [16:51<11:09,  1.35it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1415/2320 [16:52<10:51,  1.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1416/2320 [16:53<10:53,  1.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1417/2320 [16:53<10:51,  1.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1418/2320 [16:54<10:41,  1.41it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1419/2320 [16:55<10:52,  1.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 1420/2320 [16:55<10:46,  1.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1421/2320 [16:56<10:45,  1.39it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1422/2320 [16:57<10:51,  1.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1423/2320 [16:58<10:57,  1.37it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1424/2320 [16:58<11:04,  1.35it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1425/2320 [16:59<10:47,  1.38it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1426/2320 [17:00<10:55,  1.36it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1427/2320 [17:01<10:55,  1.36it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1428/2320 [17:01<10:36,  1.40it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1429/2320 [17:02<10:41,  1.39it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1430/2320 [17:03<10:39,  1.39it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1431/2320 [17:03<10:49,  1.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1432/2320 [17:04<10:26,  1.42it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1433/2320 [17:05<10:26,  1.42it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1434/2320 [17:06<10:35,  1.39it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1435/2320 [17:06<10:47,  1.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1436/2320 [17:07<10:50,  1.36it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1437/2320 [17:08<10:54,  1.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1438/2320 [17:09<10:53,  1.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1439/2320 [17:09<10:32,  1.39it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1440/2320 [17:10<10:43,  1.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1441/2320 [17:11<10:42,  1.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1442/2320 [17:11<10:55,  1.34it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1443/2320 [17:12<10:53,  1.34it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1444/2320 [17:13<10:32,  1.38it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1445/2320 [17:14<10:36,  1.37it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1446/2320 [17:14<10:40,  1.36it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1447/2320 [17:15<10:46,  1.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1448/2320 [17:16<10:43,  1.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1449/2320 [17:17<10:44,  1.35it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [17:17<10:42,  1.35it/s]                                                    62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1450/2320 [17:17<10:42,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1451/2320 [17:18<10:49,  1.34it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1452/2320 [17:19<10:57,  1.32it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1453/2320 [17:20<10:55,  1.32it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1454/2320 [17:20<10:55,  1.32it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1455/2320 [17:21<10:42,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1456/2320 [17:22<10:47,  1.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1457/2320 [17:23<10:46,  1.33it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1458/2320 [17:23<10:32,  1.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1459/2320 [17:24<10:27,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1460/2320 [17:25<10:33,  1.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1461/2320 [17:26<10:38,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1462/2320 [17:26<10:26,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1463/2320 [17:27<10:26,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1464/2320 [17:28<10:30,  1.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1465/2320 [17:28<10:33,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1466/2320 [17:29<10:30,  1.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1467/2320 [17:30<10:24,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1468/2320 [17:31<10:23,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1469/2320 [17:31<10:29,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1470/2320 [17:32<10:27,  1.35it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1471/2320 [17:33<10:24,  1.36it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1472/2320 [17:34<10:19,  1.37it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1473/2320 [17:34<10:15,  1.38it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1474/2320 [17:35<10:24,  1.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1475/2320 [17:36<10:30,  1.34it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1476/2320 [17:37<10:36,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1477/2320 [17:37<10:30,  1.34it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 1478/2320 [17:38<10:28,  1.34it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1479/2320 [17:39<10:20,  1.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1480/2320 [17:40<10:14,  1.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1481/2320 [17:40<10:11,  1.37it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1482/2320 [17:41<10:03,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1483/2320 [17:42<10:20,  1.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1484/2320 [17:43<10:19,  1.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1485/2320 [17:43<10:17,  1.35it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1486/2320 [17:44<10:14,  1.36it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1487/2320 [17:45<10:30,  1.32it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1488/2320 [17:46<10:23,  1.33it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1489/2320 [17:46<10:19,  1.34it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1490/2320 [17:47<09:56,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1491/2320 [17:48<09:53,  1.40it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1492/2320 [17:48<09:57,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1493/2320 [17:49<09:53,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1494/2320 [17:50<09:54,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1495/2320 [17:50<09:51,  1.39it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1496/2320 [17:51<09:48,  1.40it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1497/2320 [17:52<09:49,  1.40it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1498/2320 [17:53<09:50,  1.39it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1499/2320 [17:53<09:56,  1.38it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [17:54<09:49,  1.39it/s]                                                    65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1500/2320 [17:54<09:49,  1.39it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1501/2320 [17:55<09:49,  1.39it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1502/2320 [17:56<09:45,  1.40it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1503/2320 [17:56<09:48,  1.39it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1504/2320 [17:57<09:56,  1.37it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1505/2320 [17:58<09:58,  1.36it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1506/2320 [17:58<10:02,  1.35it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 1507/2320 [17:59<09:52,  1.37it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [18:00<08:49,  1.53it/s]{'eval_loss': 1.2726854085922241, 'eval_precision': 0.9200150914921713, 'eval_recall': 0.6462170398833974, 'eval_f1': 0.7591843088418431, 'eval_report': {'PAGE_HEADER': {'precision': 0.7023255813953488, 'recall': 0.3793969849246231, 'f1-score': 0.4926590538336052, 'support': 398.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.7819548872180451, 'recall': 0.33766233766233766, 'f1-score': 0.47165532879818595, 'support': 308.0}, 'INGREDIENT_LINE': {'precision': 0.7246974697469747, 'recall': 0.7706931851418544, 'f1-score': 0.7469879518072289, 'support': 3419.0}, 'INSTRUCTION_STEP': {'precision': 0.6940272441494936, 'recall': 0.5838965618571849, 'f1-score': 0.6342164060006383, 'support': 3403.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 14.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8465637382156033, 'recall': 0.8885064888506489, 'f1-score': 0.8670281616232289, 'support': 13947.0}, 'accuracy': 0.8034335163301386, 'macro avg': {'precision': 0.46869611509068315, 'recall': 0.3700194448045811, 'f1-score': 0.4015683627578609, 'support': 21494.0}, 'weighted avg': {'precision': 0.7986837026359522, 'recall': 0.8034335163301386, 'f1-score': 0.7977100656789746, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[151, 0, 6, 22, 30, 0, 3, 186], [0, 0, 0, 0, 0, 0, 0, 5], [20, 0, 104, 25, 32, 0, 4, 123], [34, 1, 23, 2635, 89, 0, 1, 636], [5, 0, 0, 129, 1987, 0, 0, 1282], [0, 0, 0, 0, 0, 0, 0, 14], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 825, 725, 0, 0, 12392]], 'eval_PAGE_HEADER_precision': 0.22033898305084745, 'eval_PAGE_HEADER_recall': 0.47058823529411764, 'eval_PAGE_HEADER_f1': 0.30014430014430016, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.12173913043478261, 'eval_RECIPE_TITLE_recall': 0.29577464788732394, 'eval_RECIPE_TITLE_f1': 0.17248459958932238, 'eval_header_false_positive_rate': 0.1402116402116402, 'eval_title_false_negative_rate': 0.18584070796460178, 'eval_header_title_confusion_count': 95, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2907, 'O': 14210, 'INGREDIENT_LINE': 4318, 'PAGE_HEADER': 472, 'RECIPE_TITLE': 345, 'SECTION_HEADER': 10, 'TEMP': 18}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 7.5399, 'eval_samples_per_second': 12.202, 'eval_steps_per_second': 3.05, 'epoch': 12.0}
{'loss': 0.1546, 'grad_norm': 3.280942440032959, 'learning_rate': 2.203065134099617e-05, 'epoch': 12.07}
{'loss': 0.1476, 'grad_norm': 1.3069523572921753, 'learning_rate': 2.0833333333333336e-05, 'epoch': 12.5}
{'loss': 0.1526, 'grad_norm': 1.7878440618515015, 'learning_rate': 1.9636015325670498e-05, 'epoch': 12.93}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.33it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.58it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:00<00:04,  3.97it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:04,  3.64it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:04,  3.48it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:01<00:04,  3.38it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.29it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  3.16it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:02<00:04,  3.12it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.13it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.16it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:03<00:03,  3.16it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:02,  3.19it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.24it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:04<00:02,  3.20it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.26it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.19it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:05<00:01,  3.23it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:05<00:00,  3.17it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.17it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:06<00:00,  3.24it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:06<00:00,  3.57it/s][A                                                   
                                               [A 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1508/2320 [18:07<08:49,  1.53it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.57it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1509/2320 [18:12<56:41,  4.19s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1510/2320 [18:13<42:10,  3.12s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1511/2320 [18:13<32:06,  2.38s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1512/2320 [18:14<25:06,  1.86s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1513/2320 [18:15<20:19,  1.51s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1514/2320 [18:15<16:55,  1.26s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1515/2320 [18:16<14:34,  1.09s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1516/2320 [18:17<12:57,  1.03it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1517/2320 [18:17<11:37,  1.15it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1518/2320 [18:18<10:56,  1.22it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1519/2320 [18:19<10:32,  1.27it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1520/2320 [18:20<10:17,  1.29it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1521/2320 [18:20<10:08,  1.31it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1522/2320 [18:21<09:41,  1.37it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1523/2320 [18:22<09:40,  1.37it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1524/2320 [18:22<09:30,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1525/2320 [18:23<09:37,  1.38it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1526/2320 [18:24<09:29,  1.39it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1527/2320 [18:25<09:26,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1528/2320 [18:25<09:20,  1.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1529/2320 [18:26<09:20,  1.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1530/2320 [18:27<09:22,  1.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1531/2320 [18:27<09:23,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1532/2320 [18:28<09:16,  1.42it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1533/2320 [18:29<09:23,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1534/2320 [18:29<09:14,  1.42it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1535/2320 [18:30<09:17,  1.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 1536/2320 [18:31<09:20,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1537/2320 [18:32<09:22,  1.39it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1538/2320 [18:32<09:17,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1539/2320 [18:33<09:19,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1540/2320 [18:34<09:13,  1.41it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1541/2320 [18:35<09:17,  1.40it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1542/2320 [18:35<09:25,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1543/2320 [18:36<09:22,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1544/2320 [18:37<09:12,  1.41it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1545/2320 [18:37<09:12,  1.40it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1546/2320 [18:38<09:14,  1.40it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1547/2320 [18:39<09:19,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1548/2320 [18:40<09:14,  1.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1549/2320 [18:40<09:13,  1.39it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [18:41<09:18,  1.38it/s]                                                    67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1550/2320 [18:41<09:18,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1551/2320 [18:42<09:21,  1.37it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1552/2320 [18:43<10:11,  1.26it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1553/2320 [18:43<09:52,  1.30it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1554/2320 [18:44<09:43,  1.31it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1555/2320 [18:45<09:32,  1.34it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1556/2320 [18:46<09:15,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1557/2320 [18:46<09:14,  1.37it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1558/2320 [18:47<09:12,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1559/2320 [18:48<09:11,  1.38it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1560/2320 [18:48<09:16,  1.37it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1561/2320 [18:49<08:57,  1.41it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1562/2320 [18:50<08:51,  1.43it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1563/2320 [18:51<08:57,  1.41it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1564/2320 [18:51<08:47,  1.43it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 1565/2320 [18:52<08:53,  1.41it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1566/2320 [18:53<09:03,  1.39it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1567/2320 [18:53<09:07,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1568/2320 [18:54<09:07,  1.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1569/2320 [18:55<09:05,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1570/2320 [18:56<09:02,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1571/2320 [18:56<09:00,  1.39it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1572/2320 [18:57<09:01,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1573/2320 [18:58<09:06,  1.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1574/2320 [18:59<09:08,  1.36it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1575/2320 [18:59<09:06,  1.36it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1576/2320 [19:00<09:03,  1.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1577/2320 [19:01<09:02,  1.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1578/2320 [19:01<09:00,  1.37it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1579/2320 [19:02<08:56,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1580/2320 [19:03<08:56,  1.38it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1581/2320 [19:04<08:53,  1.39it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1582/2320 [19:04<08:44,  1.41it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1583/2320 [19:05<08:38,  1.42it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1584/2320 [19:06<08:38,  1.42it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1585/2320 [19:06<08:30,  1.44it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1586/2320 [19:07<08:35,  1.42it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1587/2320 [19:08<08:43,  1.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1588/2320 [19:09<08:43,  1.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1589/2320 [19:09<08:49,  1.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1590/2320 [19:10<08:50,  1.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1591/2320 [19:11<08:53,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1592/2320 [19:11<08:51,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1593/2320 [19:12<08:49,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 1594/2320 [19:13<08:49,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1595/2320 [19:14<08:46,  1.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1596/2320 [19:14<08:49,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1597/2320 [19:15<08:47,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1598/2320 [19:16<08:28,  1.42it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1599/2320 [19:16<08:31,  1.41it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [19:17<08:34,  1.40it/s]                                                    69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1600/2320 [19:17<08:34,  1.40it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1601/2320 [19:18<08:33,  1.40it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1602/2320 [19:19<08:32,  1.40it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1603/2320 [19:19<08:35,  1.39it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1604/2320 [19:20<08:28,  1.41it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1605/2320 [19:21<08:28,  1.41it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1606/2320 [19:22<08:32,  1.39it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1607/2320 [19:22<08:34,  1.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1608/2320 [19:23<08:34,  1.38it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1609/2320 [19:24<08:31,  1.39it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1610/2320 [19:24<08:36,  1.37it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1611/2320 [19:25<08:49,  1.34it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1612/2320 [19:26<08:57,  1.32it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1613/2320 [19:27<09:01,  1.31it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1614/2320 [19:28<09:07,  1.29it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1615/2320 [19:28<09:09,  1.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1616/2320 [19:29<09:10,  1.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1617/2320 [19:30<09:07,  1.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1618/2320 [19:31<09:09,  1.28it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1619/2320 [19:31<09:02,  1.29it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1620/2320 [19:32<09:17,  1.25it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1621/2320 [19:33<09:28,  1.23it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1622/2320 [19:34<09:24,  1.24it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 1623/2320 [19:35<09:21,  1.24it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [19:35<08:24,  1.38it/s]{'eval_loss': 1.3087226152420044, 'eval_precision': 0.9231198808637379, 'eval_recall': 0.6413605794102432, 'eval_f1': 0.7568681318681318, 'eval_report': {'PAGE_HEADER': {'precision': 0.5116279069767442, 'recall': 0.3914590747330961, 'f1-score': 0.4435483870967742, 'support': 281.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 4.0}, 'RECIPE_TITLE': {'precision': 0.43609022556390975, 'recall': 0.29743589743589743, 'f1-score': 0.35365853658536583, 'support': 195.0}, 'INGREDIENT_LINE': {'precision': 0.7951045104510451, 'recall': 0.6840984382394699, 'f1-score': 0.7354362757568049, 'support': 4226.0}, 'INSTRUCTION_STEP': {'precision': 0.6636395389451624, 'recall': 0.628514720476348, 'f1-score': 0.6455997281685355, 'support': 3023.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8387757890422188, 'recall': 0.8921668362156663, 'f1-score': 0.8646478873239437, 'support': 13762.0}, 'accuracy': 0.8019447287615148, 'macro avg': {'precision': 0.4056547463723851, 'recall': 0.3617093708875597, 'f1-score': 0.38036135186642805, 'support': 21494.0}, 'weighted avg': {'precision': 0.7973542119680743, 'recall': 0.8019447287615148, 'f1-score': 0.7980127671146456, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[110, 0, 7, 33, 22, 0, 0, 109], [0, 0, 0, 0, 0, 0, 0, 4], [4, 0, 58, 19, 20, 0, 0, 94], [42, 1, 33, 2891, 106, 0, 8, 1145], [1, 0, 2, 115, 1900, 0, 0, 1005], [0, 0, 0, 0, 0, 0, 0, 3], [0, 0, 0, 0, 0, 0, 0, 0], [58, 0, 33, 578, 815, 0, 0, 12278]], 'eval_PAGE_HEADER_precision': 0.17313432835820897, 'eval_PAGE_HEADER_recall': 0.26244343891402716, 'eval_PAGE_HEADER_f1': 0.20863309352517986, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.06880733944954129, 'eval_RECIPE_TITLE_recall': 0.1056338028169014, 'eval_RECIPE_TITLE_f1': 0.08333333333333334, 'eval_header_false_positive_rate': 0.041237113402061855, 'eval_title_false_negative_rate': 0.12777777777777777, 'eval_header_title_confusion_count': 35, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2591, 'O': 14280, 'INGREDIENT_LINE': 4843, 'PAGE_HEADER': 335, 'RECIPE_TITLE': 218, 'SECTION_HEADER': 9, 'TEMP': 4}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 7.5838, 'eval_samples_per_second': 12.131, 'eval_steps_per_second': 3.033, 'epoch': 13.0}
{'loss': 0.1549, 'grad_norm': 1.4442459344863892, 'learning_rate': 1.8438697318007663e-05, 'epoch': 13.36}
{'loss': 0.0973, 'grad_norm': 3.154536008834839, 'learning_rate': 1.7241379310344828e-05, 'epoch': 13.79}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.32it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.76it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.27it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.12it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.04it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.98it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.87it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:05,  2.79it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.81it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.79it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:04<00:03,  2.78it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.76it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.72it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:05<00:02,  2.76it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.81it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.84it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:06<00:01,  2.84it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.86it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.83it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.86it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.90it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.15it/s][A                                                   
                                               [A 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1624/2320 [19:44<08:24,  1.38it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.15it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1625/2320 [19:49<52:47,  4.56s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1626/2320 [19:50<39:19,  3.40s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1627/2320 [19:50<29:55,  2.59s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1628/2320 [19:51<23:30,  2.04s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1629/2320 [19:52<18:56,  1.64s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1630/2320 [19:52<15:53,  1.38s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1631/2320 [19:53<13:50,  1.21s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1632/2320 [19:54<12:19,  1.08s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1633/2320 [19:55<11:11,  1.02it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1634/2320 [19:56<10:39,  1.07it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1635/2320 [19:56<10:17,  1.11it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1636/2320 [19:57<10:04,  1.13it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1637/2320 [19:58<09:44,  1.17it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1638/2320 [19:59<09:28,  1.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1639/2320 [20:00<09:14,  1.23it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1640/2320 [20:00<09:01,  1.26it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1641/2320 [20:01<08:52,  1.27it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1642/2320 [20:02<08:48,  1.28it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1643/2320 [20:03<08:45,  1.29it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1644/2320 [20:03<08:42,  1.29it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1645/2320 [20:04<08:37,  1.30it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1646/2320 [20:05<08:39,  1.30it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1647/2320 [20:06<08:35,  1.31it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1648/2320 [20:06<08:34,  1.31it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1649/2320 [20:07<08:31,  1.31it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [20:08<08:24,  1.33it/s]                                                    71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1650/2320 [20:08<08:24,  1.33it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1651/2320 [20:09<08:14,  1.35it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 1652/2320 [20:09<08:21,  1.33it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1653/2320 [20:10<08:18,  1.34it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1654/2320 [20:11<08:09,  1.36it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1655/2320 [20:12<08:10,  1.36it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1656/2320 [20:12<08:16,  1.34it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1657/2320 [20:13<08:19,  1.33it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1658/2320 [20:14<08:19,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1659/2320 [20:15<08:20,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1660/2320 [20:15<08:23,  1.31it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1661/2320 [20:16<08:20,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1662/2320 [20:17<08:17,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1663/2320 [20:18<08:15,  1.33it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1664/2320 [20:18<08:17,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1665/2320 [20:19<08:04,  1.35it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1666/2320 [20:20<08:14,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1667/2320 [20:21<08:14,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1668/2320 [20:22<08:17,  1.31it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1669/2320 [20:22<08:27,  1.28it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1670/2320 [20:23<08:21,  1.30it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1671/2320 [20:24<08:11,  1.32it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1672/2320 [20:25<08:19,  1.30it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1673/2320 [20:25<08:28,  1.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1674/2320 [20:26<08:33,  1.26it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1675/2320 [20:27<08:30,  1.26it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1676/2320 [20:28<08:26,  1.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1677/2320 [20:29<08:27,  1.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1678/2320 [20:29<08:27,  1.26it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1679/2320 [20:30<08:30,  1.26it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1680/2320 [20:31<08:24,  1.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1681/2320 [20:32<08:22,  1.27it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1682/2320 [20:33<08:27,  1.26it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1683/2320 [20:33<08:22,  1.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1684/2320 [20:34<08:19,  1.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1685/2320 [20:35<08:19,  1.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1686/2320 [20:36<08:22,  1.26it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1687/2320 [20:37<08:23,  1.26it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1688/2320 [20:37<08:18,  1.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1689/2320 [20:38<08:11,  1.28it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1690/2320 [20:39<08:10,  1.29it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1691/2320 [20:40<08:03,  1.30it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1692/2320 [20:40<08:06,  1.29it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1693/2320 [20:41<08:03,  1.30it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1694/2320 [20:42<07:45,  1.34it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1695/2320 [20:43<07:50,  1.33it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1696/2320 [20:43<07:58,  1.30it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1697/2320 [20:44<07:51,  1.32it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1698/2320 [20:45<08:47,  1.18it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1699/2320 [20:46<08:22,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [20:47<08:19,  1.24it/s]                                                    73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1700/2320 [20:47<08:19,  1.24it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1701/2320 [20:47<08:14,  1.25it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1702/2320 [20:48<08:11,  1.26it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1703/2320 [20:49<08:04,  1.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1704/2320 [20:50<08:00,  1.28it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1705/2320 [20:51<07:56,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1706/2320 [20:51<07:46,  1.32it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1707/2320 [20:52<07:47,  1.31it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1708/2320 [20:53<07:49,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1709/2320 [20:54<07:46,  1.31it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 1710/2320 [20:54<07:33,  1.35it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1711/2320 [20:55<07:35,  1.34it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1712/2320 [20:56<07:40,  1.32it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1713/2320 [20:57<07:46,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1714/2320 [20:57<07:45,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1715/2320 [20:58<07:45,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1716/2320 [20:59<07:44,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1717/2320 [21:00<07:54,  1.27it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1718/2320 [21:01<07:59,  1.26it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1719/2320 [21:01<07:52,  1.27it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1720/2320 [21:02<07:49,  1.28it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1721/2320 [21:03<07:45,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1722/2320 [21:04<07:40,  1.30it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1723/2320 [21:04<07:43,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1724/2320 [21:05<07:41,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1725/2320 [21:06<07:39,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1726/2320 [21:07<07:31,  1.32it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1727/2320 [21:07<07:38,  1.29it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1728/2320 [21:08<07:35,  1.30it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1729/2320 [21:09<07:34,  1.30it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1730/2320 [21:10<07:36,  1.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1731/2320 [21:11<07:49,  1.25it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1732/2320 [21:11<07:44,  1.27it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1733/2320 [21:12<07:39,  1.28it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1734/2320 [21:13<07:36,  1.28it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1735/2320 [21:14<07:34,  1.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1736/2320 [21:15<07:34,  1.29it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1737/2320 [21:15<07:25,  1.31it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1738/2320 [21:16<07:19,  1.32it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 1739/2320 [21:17<07:21,  1.32it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [21:17<06:37,  1.46it/s]{'eval_loss': 1.4365851879119873, 'eval_precision': 0.9145660958245141, 'eval_recall': 0.6921508664627931, 'eval_f1': 0.7879641909814323, 'eval_report': {'PAGE_HEADER': {'precision': 0.8046511627906977, 'recall': 0.38963963963963966, 'f1-score': 0.5250379362670713, 'support': 444.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.7142857142857143, 'recall': 0.3667953667953668, 'f1-score': 0.4846938775510204, 'support': 259.0}, 'INGREDIENT_LINE': {'precision': 0.742024202420242, 'recall': 0.7408017572762219, 'f1-score': 0.7414124759549326, 'support': 3642.0}, 'INSTRUCTION_STEP': {'precision': 0.6241704505763186, 'recall': 0.7108194112967383, 'f1-score': 0.6646829086851405, 'support': 2514.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.885913376144282, 'recall': 0.88657961304437, 'f1-score': 0.8862463693832223, 'support': 14627.0}, 'accuracy': 0.8244626407369499, 'macro avg': {'precision': 0.47138061327715686, 'recall': 0.3868294735065421, 'f1-score': 0.4127591959801734, 'support': 21494.0}, 'weighted avg': {'precision': 0.8268417570998823, 'recall': 0.8244626407369499, 'f1-score': 0.8231606621763746, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[173, 0, 19, 45, 48, 0, 1, 158], [0, 0, 0, 0, 0, 0, 0, 5], [7, 0, 95, 30, 22, 0, 0, 105], [29, 1, 18, 2698, 94, 0, 7, 795], [1, 0, 1, 121, 1787, 0, 0, 604], [0, 0, 0, 0, 0, 0, 0, 3], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 742, 912, 0, 0, 12968]], 'eval_PAGE_HEADER_precision': 0.2404040404040404, 'eval_PAGE_HEADER_recall': 0.5384615384615384, 'eval_PAGE_HEADER_f1': 0.33240223463687146, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1, 'eval_RECIPE_TITLE_recall': 0.2112676056338028, 'eval_RECIPE_TITLE_f1': 0.13574660633484162, 'eval_header_false_positive_rate': 0.09333333333333334, 'eval_title_false_negative_rate': 0.23893805309734514, 'eval_header_title_confusion_count': 89, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2090, 'O': 14968, 'INGREDIENT_LINE': 4413, 'PAGE_HEADER': 495, 'RECIPE_TITLE': 300, 'SECTION_HEADER': 10, 'TEMP': 4}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.5519, 'eval_samples_per_second': 10.758, 'eval_steps_per_second': 2.689, 'epoch': 14.0}
{'loss': 0.1061, 'grad_norm': 1.213252305984497, 'learning_rate': 1.6044061302681994e-05, 'epoch': 14.22}
{'loss': 0.1121, 'grad_norm': 6.147680759429932, 'learning_rate': 1.4846743295019159e-05, 'epoch': 14.66}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.07it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.05it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.48it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.27it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.20it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.14it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.01it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.95it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.95it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.92it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.95it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.91it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.90it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.92it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.92it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.97it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.96it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  3.00it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.89it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  2.89it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.90it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.16it/s][A                                                   
                                               [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1740/2320 [21:26<06:37,  1.46it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.16it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1741/2320 [21:31<43:45,  4.53s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1742/2320 [21:31<32:34,  3.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1743/2320 [21:32<24:41,  2.57s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1744/2320 [21:33<19:10,  2.00s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1745/2320 [21:33<15:20,  1.60s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1746/2320 [21:34<12:50,  1.34s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1747/2320 [21:35<10:57,  1.15s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1748/2320 [21:36<09:35,  1.01s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1749/2320 [21:36<08:41,  1.10it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [21:37<08:05,  1.17it/s]                                                    75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1750/2320 [21:37<08:05,  1.17it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1751/2320 [21:38<07:50,  1.21it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1752/2320 [21:38<07:31,  1.26it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1753/2320 [21:39<07:21,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1754/2320 [21:40<07:21,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1755/2320 [21:41<07:16,  1.29it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1756/2320 [21:41<06:58,  1.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1757/2320 [21:42<06:52,  1.36it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1758/2320 [21:43<06:56,  1.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1759/2320 [21:44<06:56,  1.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1760/2320 [21:44<06:57,  1.34it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1761/2320 [21:45<06:53,  1.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1762/2320 [21:46<06:49,  1.36it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1763/2320 [21:47<06:39,  1.40it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1764/2320 [21:47<06:40,  1.39it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1765/2320 [21:48<06:41,  1.38it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1766/2320 [21:49<06:49,  1.35it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1767/2320 [21:50<07:05,  1.30it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 1768/2320 [21:50<07:11,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1769/2320 [21:51<07:10,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1770/2320 [21:52<07:08,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1771/2320 [21:53<07:13,  1.27it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1772/2320 [21:54<07:08,  1.28it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1773/2320 [21:54<07:09,  1.27it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1774/2320 [21:55<07:07,  1.28it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1775/2320 [21:56<07:07,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1776/2320 [21:57<07:06,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1777/2320 [21:57<06:59,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1778/2320 [21:58<06:57,  1.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1779/2320 [21:59<06:58,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1780/2320 [22:00<06:57,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1781/2320 [22:01<06:54,  1.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1782/2320 [22:01<06:53,  1.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1783/2320 [22:02<06:55,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1784/2320 [22:03<06:58,  1.28it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1785/2320 [22:04<06:56,  1.28it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1786/2320 [22:04<06:54,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1787/2320 [22:05<06:53,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1788/2320 [22:06<06:55,  1.28it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1789/2320 [22:07<06:56,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1790/2320 [22:08<06:57,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1791/2320 [22:08<06:46,  1.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1792/2320 [22:09<06:48,  1.29it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1793/2320 [22:10<06:54,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1794/2320 [22:11<06:49,  1.28it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1795/2320 [22:11<06:51,  1.27it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1796/2320 [22:12<06:43,  1.30it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 1797/2320 [22:13<06:44,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1798/2320 [22:14<06:46,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1799/2320 [22:15<06:48,  1.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [22:15<06:45,  1.28it/s]                                                    78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1800/2320 [22:15<06:45,  1.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1801/2320 [22:16<06:42,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1802/2320 [22:17<06:42,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1803/2320 [22:18<06:39,  1.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1804/2320 [22:18<06:40,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1805/2320 [22:19<06:33,  1.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1806/2320 [22:20<06:33,  1.31it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1807/2320 [22:21<06:33,  1.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1808/2320 [22:21<06:37,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1809/2320 [22:22<06:37,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1810/2320 [22:23<06:36,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1811/2320 [22:24<06:35,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1812/2320 [22:25<06:32,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1813/2320 [22:25<06:31,  1.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1814/2320 [22:26<06:29,  1.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1815/2320 [22:27<06:31,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1816/2320 [22:28<06:29,  1.29it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1817/2320 [22:28<06:27,  1.30it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1818/2320 [22:29<06:31,  1.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1819/2320 [22:30<06:30,  1.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1820/2320 [22:31<06:30,  1.28it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1821/2320 [22:32<06:28,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1822/2320 [22:32<06:28,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1823/2320 [22:33<06:26,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1824/2320 [22:34<06:27,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1825/2320 [22:35<06:27,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 1826/2320 [22:35<06:26,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1827/2320 [22:36<06:26,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1828/2320 [22:37<06:27,  1.27it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1829/2320 [22:38<06:28,  1.26it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1830/2320 [22:39<06:19,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1831/2320 [22:39<06:22,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1832/2320 [22:40<06:19,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1833/2320 [22:41<06:19,  1.28it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1834/2320 [22:42<06:22,  1.27it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1835/2320 [22:43<06:15,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1836/2320 [22:43<06:13,  1.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1837/2320 [22:44<06:11,  1.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1838/2320 [22:45<06:11,  1.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1839/2320 [22:46<06:12,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1840/2320 [22:46<06:10,  1.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1841/2320 [22:47<06:09,  1.30it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1842/2320 [22:48<06:11,  1.29it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1843/2320 [22:49<06:02,  1.32it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1844/2320 [22:49<06:05,  1.30it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1845/2320 [22:50<06:06,  1.30it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1846/2320 [22:51<06:03,  1.30it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1847/2320 [22:52<06:07,  1.29it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1848/2320 [22:53<06:07,  1.28it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1849/2320 [22:53<06:05,  1.29it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [22:54<06:05,  1.29it/s]                                                    80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1850/2320 [22:54<06:05,  1.29it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1851/2320 [22:55<06:10,  1.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1852/2320 [22:56<06:08,  1.27it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1853/2320 [22:57<06:10,  1.26it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1854/2320 [22:57<06:09,  1.26it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 1855/2320 [22:58<06:35,  1.18it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [22:59<05:48,  1.33it/s]{'eval_loss': 1.4094765186309814, 'eval_precision': 0.9236097748701174, 'eval_recall': 0.6931407942238267, 'eval_f1': 0.7919485233459825, 'eval_report': {'PAGE_HEADER': {'precision': 0.44651162790697674, 'recall': 0.4067796610169492, 'f1-score': 0.42572062084257206, 'support': 236.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.37593984962406013, 'recall': 0.31645569620253167, 'f1-score': 0.3436426116838488, 'support': 158.0}, 'INGREDIENT_LINE': {'precision': 0.7406490649064906, 'recall': 0.7661450924608819, 'f1-score': 0.7531813732345126, 'support': 3515.0}, 'INSTRUCTION_STEP': {'precision': 0.6849458609849808, 'recall': 0.6519281914893617, 'f1-score': 0.6680292965423267, 'support': 3008.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8819510862139637, 'recall': 0.8861280801702245, 'f1-score': 0.8840346492279249, 'support': 14569.0}, 'accuracy': 0.8239508700102354, 'macro avg': {'precision': 0.391249686204559, 'recall': 0.37842959016749356, 'f1-score': 0.3843260689413981, 'support': 21494.0}, 'weighted avg': {'precision': 0.8224443671939621, 'recall': 0.8239508700102354, 'f1-score': 0.8230729996596801, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[96, 0, 5, 21, 11, 0, 0, 103], [0, 0, 0, 0, 0, 0, 0, 5], [5, 0, 50, 15, 12, 0, 0, 76], [43, 1, 29, 2693, 54, 0, 8, 687], [17, 0, 16, 160, 1961, 0, 0, 854], [0, 0, 0, 0, 0, 0, 0, 3], [0, 0, 0, 0, 0, 0, 0, 0], [54, 0, 33, 747, 825, 0, 0, 12910]], 'eval_PAGE_HEADER_precision': 0.19558359621451105, 'eval_PAGE_HEADER_recall': 0.28054298642533937, 'eval_PAGE_HEADER_f1': 0.2304832713754647, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.07291666666666667, 'eval_RECIPE_TITLE_recall': 0.09859154929577464, 'eval_RECIPE_TITLE_f1': 0.08383233532934131, 'eval_header_false_positive_rate': 0.034129692832764506, 'eval_title_false_negative_rate': 0.10857142857142857, 'eval_header_title_confusion_count': 29, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2521, 'O': 14986, 'INGREDIENT_LINE': 4252, 'PAGE_HEADER': 317, 'RECIPE_TITLE': 192, 'SECTION_HEADER': 8, 'TEMP': 4}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.3193, 'eval_samples_per_second': 11.059, 'eval_steps_per_second': 2.765, 'epoch': 15.0}
{'loss': 0.0842, 'grad_norm': 34.28795623779297, 'learning_rate': 1.3649425287356324e-05, 'epoch': 15.09}
{'loss': 0.0774, 'grad_norm': 3.4652435779571533, 'learning_rate': 1.2452107279693487e-05, 'epoch': 15.52}
{'loss': 0.0739, 'grad_norm': 0.7767611742019653, 'learning_rate': 1.1254789272030653e-05, 'epoch': 15.95}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.98it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.38it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.56it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.27it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.07it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.04it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.98it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.86it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.86it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.88it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.84it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.86it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.87it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.88it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.88it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.96it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.03it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  3.08it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:00,  3.06it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.03it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  3.03it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.31it/s][A                                                   
                                               [A 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1856/2320 [23:07<05:48,  1.33it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.31it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1857/2320 [23:12<35:16,  4.57s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1858/2320 [23:13<26:12,  3.40s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1859/2320 [23:14<19:50,  2.58s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1860/2320 [23:14<15:38,  2.04s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1861/2320 [23:15<12:31,  1.64s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1862/2320 [23:16<10:19,  1.35s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1863/2320 [23:17<08:51,  1.16s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1864/2320 [23:17<07:51,  1.03s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1865/2320 [23:18<07:12,  1.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1866/2320 [23:19<06:49,  1.11it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1867/2320 [23:20<06:29,  1.16it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1868/2320 [23:20<06:21,  1.19it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1869/2320 [23:21<06:10,  1.22it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1870/2320 [23:22<06:04,  1.23it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1871/2320 [23:23<06:02,  1.24it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1872/2320 [23:23<05:54,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1873/2320 [23:24<05:52,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1874/2320 [23:25<05:52,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1875/2320 [23:26<05:50,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1876/2320 [23:27<05:46,  1.28it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1877/2320 [23:27<05:45,  1.28it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1878/2320 [23:28<05:49,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1879/2320 [23:29<05:46,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1880/2320 [23:30<05:45,  1.27it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1881/2320 [23:30<05:40,  1.29it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1882/2320 [23:31<05:41,  1.28it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1883/2320 [23:32<05:36,  1.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 1884/2320 [23:33<05:35,  1.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1885/2320 [23:34<05:35,  1.30it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1886/2320 [23:34<05:38,  1.28it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1887/2320 [23:35<05:24,  1.33it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1888/2320 [23:36<05:26,  1.33it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1889/2320 [23:37<05:26,  1.32it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1890/2320 [23:37<05:27,  1.31it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1891/2320 [23:38<05:30,  1.30it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1892/2320 [23:39<05:32,  1.29it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1893/2320 [23:40<05:31,  1.29it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1894/2320 [23:41<05:38,  1.26it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1895/2320 [23:41<05:41,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1896/2320 [23:42<05:43,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1897/2320 [23:43<05:42,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1898/2320 [23:44<05:42,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1899/2320 [23:45<05:41,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [23:45<05:40,  1.24it/s]                                                    82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1900/2320 [23:45<05:40,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1901/2320 [23:46<05:32,  1.26it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1902/2320 [23:47<05:31,  1.26it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1903/2320 [23:48<05:34,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1904/2320 [23:49<05:33,  1.25it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1905/2320 [23:49<05:34,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1906/2320 [23:50<05:33,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1907/2320 [23:51<05:31,  1.25it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1908/2320 [23:52<05:35,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1909/2320 [23:53<05:30,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1910/2320 [23:53<05:32,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1911/2320 [23:54<05:31,  1.24it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1912/2320 [23:55<05:31,  1.23it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1913/2320 [23:56<05:39,  1.20it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1914/2320 [23:57<05:35,  1.21it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1915/2320 [23:58<05:31,  1.22it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1916/2320 [23:58<05:26,  1.24it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1917/2320 [23:59<05:22,  1.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1918/2320 [24:00<05:21,  1.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1919/2320 [24:01<05:21,  1.25it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1920/2320 [24:02<05:16,  1.26it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1921/2320 [24:02<05:14,  1.27it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1922/2320 [24:03<05:11,  1.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1923/2320 [24:04<05:09,  1.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1924/2320 [24:05<05:07,  1.29it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1925/2320 [24:05<05:07,  1.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1926/2320 [24:06<05:06,  1.29it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1927/2320 [24:07<05:04,  1.29it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1928/2320 [24:08<04:59,  1.31it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1929/2320 [24:08<05:01,  1.30it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1930/2320 [24:09<04:58,  1.31it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1931/2320 [24:10<04:50,  1.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1932/2320 [24:11<04:50,  1.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1933/2320 [24:11<04:52,  1.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1934/2320 [24:12<04:56,  1.30it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1935/2320 [24:13<05:01,  1.28it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1936/2320 [24:14<04:53,  1.31it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1937/2320 [24:15<04:51,  1.31it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1938/2320 [24:15<04:51,  1.31it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1939/2320 [24:16<04:56,  1.29it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1940/2320 [24:17<04:53,  1.29it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1941/2320 [24:18<04:51,  1.30it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 1942/2320 [24:18<04:52,  1.29it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1943/2320 [24:19<04:42,  1.34it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1944/2320 [24:20<04:43,  1.32it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1945/2320 [24:21<04:45,  1.31it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1946/2320 [24:21<04:48,  1.30it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1947/2320 [24:22<04:51,  1.28it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1948/2320 [24:23<04:51,  1.28it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1949/2320 [24:24<04:52,  1.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [24:25<04:52,  1.27it/s]                                                    84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1950/2320 [24:25<04:52,  1.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1951/2320 [24:25<04:57,  1.24it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1952/2320 [24:26<04:59,  1.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1953/2320 [24:27<04:59,  1.23it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1954/2320 [24:28<04:54,  1.24it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1955/2320 [24:29<04:48,  1.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1956/2320 [24:29<04:46,  1.27it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1957/2320 [24:30<04:47,  1.26it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1958/2320 [24:31<04:43,  1.28it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1959/2320 [24:32<04:42,  1.28it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1960/2320 [24:33<04:41,  1.28it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1961/2320 [24:33<04:41,  1.28it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1962/2320 [24:34<04:46,  1.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1963/2320 [24:35<04:46,  1.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1964/2320 [24:36<04:45,  1.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1965/2320 [24:37<04:43,  1.25it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1966/2320 [24:37<04:34,  1.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1967/2320 [24:38<04:37,  1.27it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1968/2320 [24:39<04:32,  1.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1969/2320 [24:40<04:32,  1.29it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1970/2320 [24:40<04:34,  1.27it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 1971/2320 [24:41<04:33,  1.28it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [24:42<04:07,  1.40it/s]{'eval_loss': 1.5561282634735107, 'eval_precision': 0.9211925560197494, 'eval_recall': 0.6823744549163033, 'eval_f1': 0.784, 'eval_report': {'PAGE_HEADER': {'precision': 0.7674418604651163, 'recall': 0.4342105263157895, 'f1-score': 0.5546218487394958, 'support': 380.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.7142857142857143, 'recall': 0.38, 'f1-score': 0.4960835509138381, 'support': 250.0}, 'INGREDIENT_LINE': {'precision': 0.7326732673267327, 'recall': 0.7701647875108413, 'f1-score': 0.7509513742071882, 'support': 3459.0}, 'INSTRUCTION_STEP': {'precision': 0.6730702060775411, 'recall': 0.6429763096429764, 'f1-score': 0.657679180887372, 'support': 2997.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8740948216969532, 'recall': 0.8894681960375391, 'f1-score': 0.8817145022912862, 'support': 14385.0}, 'accuracy': 0.8209732948729878, 'macro avg': {'precision': 0.4701957337315072, 'recall': 0.38960247743839327, 'f1-score': 0.4176313071298975, 'support': 21494.0}, 'weighted avg': {'precision': 0.8186266672074256, 'recall': 0.8209732948729878, 'f1-score': 0.8182211600545145, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[165, 0, 11, 55, 28, 0, 0, 121], [0, 0, 0, 0, 0, 0, 0, 5], [9, 0, 95, 28, 22, 0, 0, 96], [31, 1, 24, 2664, 59, 0, 8, 672], [5, 0, 2, 132, 1927, 0, 0, 931], [0, 0, 0, 0, 0, 0, 0, 18], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 1, 757, 827, 0, 0, 12795]], 'eval_PAGE_HEADER_precision': 0.23893805309734514, 'eval_PAGE_HEADER_recall': 0.48868778280542985, 'eval_PAGE_HEADER_f1': 0.3209509658246657, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1111111111111111, 'eval_RECIPE_TITLE_recall': 0.21830985915492956, 'eval_RECIPE_TITLE_f1': 0.14726840855106887, 'eval_header_false_positive_rate': 0.10840108401084012, 'eval_title_false_negative_rate': 0.2100456621004566, 'eval_header_title_confusion_count': 86, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2484, 'O': 14752, 'INGREDIENT_LINE': 4279, 'PAGE_HEADER': 452, 'RECIPE_TITLE': 279, 'SECTION_HEADER': 9, 'TEMP': 25}, 'eval_title_anchor_accuracy': 0.8333333333333334, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 5, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.2127, 'eval_samples_per_second': 11.202, 'eval_steps_per_second': 2.801, 'epoch': 16.0}
{'loss': 0.0738, 'grad_norm': 1.620253086090088, 'learning_rate': 1.0057471264367816e-05, 'epoch': 16.38}
{'loss': 0.0659, 'grad_norm': 3.447070837020874, 'learning_rate': 8.860153256704981e-06, 'epoch': 16.81}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.06it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.10it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.44it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.15it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  2.96it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  2.93it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.90it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.86it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.77it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.81it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.90it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.91it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.90it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.93it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.98it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.07it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.00it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  3.04it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:00,  3.01it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.13it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  3.08it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.32it/s][A                                                   
                                               [A 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1972/2320 [24:50<04:07,  1.40it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.32it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1973/2320 [24:55<26:19,  4.55s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1974/2320 [24:56<19:32,  3.39s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1975/2320 [24:57<14:52,  2.59s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1976/2320 [24:57<11:29,  2.00s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1977/2320 [24:58<09:18,  1.63s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1978/2320 [24:59<07:46,  1.36s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1979/2320 [25:00<06:37,  1.17s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1980/2320 [25:00<05:53,  1.04s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1981/2320 [25:01<05:23,  1.05it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1982/2320 [25:02<05:04,  1.11it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1983/2320 [25:03<04:51,  1.15it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1984/2320 [25:03<04:39,  1.20it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1985/2320 [25:04<04:30,  1.24it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1986/2320 [25:05<04:26,  1.25it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1987/2320 [25:06<04:23,  1.26it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1988/2320 [25:07<04:40,  1.18it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1989/2320 [25:07<04:34,  1.20it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1990/2320 [25:08<04:26,  1.24it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1991/2320 [25:09<04:19,  1.27it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1992/2320 [25:10<04:18,  1.27it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1993/2320 [25:11<04:21,  1.25it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1994/2320 [25:11<04:15,  1.27it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1995/2320 [25:12<04:14,  1.28it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1996/2320 [25:13<04:10,  1.29it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1997/2320 [25:14<04:08,  1.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1998/2320 [25:14<04:05,  1.31it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 1999/2320 [25:15<03:57,  1.35it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [25:16<03:56,  1.35it/s]                                                    86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 2000/2320 [25:16<03:56,  1.35it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2001/2320 [25:17<03:58,  1.34it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2002/2320 [25:17<04:04,  1.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2003/2320 [25:18<04:03,  1.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2004/2320 [25:19<04:04,  1.29it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2005/2320 [25:20<04:03,  1.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2006/2320 [25:21<04:08,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2007/2320 [25:21<04:05,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2008/2320 [25:22<04:03,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2009/2320 [25:23<04:02,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2010/2320 [25:24<03:59,  1.29it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2011/2320 [25:24<03:58,  1.30it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2012/2320 [25:25<04:01,  1.28it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2013/2320 [25:26<04:04,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2014/2320 [25:27<04:06,  1.24it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2015/2320 [25:28<04:07,  1.23it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2016/2320 [25:28<04:04,  1.24it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2017/2320 [25:29<04:03,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2018/2320 [25:30<03:58,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2019/2320 [25:31<03:58,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2020/2320 [25:32<04:00,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2021/2320 [25:32<03:58,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2022/2320 [25:33<03:56,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2023/2320 [25:34<03:56,  1.26it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2024/2320 [25:35<03:55,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2025/2320 [25:36<03:51,  1.27it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2026/2320 [25:36<03:54,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2027/2320 [25:37<03:53,  1.25it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2028/2320 [25:38<03:49,  1.27it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 2029/2320 [25:39<03:49,  1.27it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2030/2320 [25:39<03:46,  1.28it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2031/2320 [25:40<03:43,  1.29it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2032/2320 [25:41<03:41,  1.30it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2033/2320 [25:42<03:41,  1.29it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2034/2320 [25:43<03:41,  1.29it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2035/2320 [25:43<03:42,  1.28it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2036/2320 [25:44<03:42,  1.28it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2037/2320 [25:45<03:42,  1.27it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2038/2320 [25:46<03:43,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2039/2320 [25:47<03:42,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2040/2320 [25:47<03:43,  1.25it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2041/2320 [25:48<03:48,  1.22it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2042/2320 [25:49<03:46,  1.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2043/2320 [25:50<03:46,  1.23it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2044/2320 [25:51<03:43,  1.24it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2045/2320 [25:51<03:39,  1.25it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2046/2320 [25:52<03:40,  1.24it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2047/2320 [25:53<03:39,  1.24it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2048/2320 [25:54<03:35,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2049/2320 [25:55<03:32,  1.27it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [25:55<03:34,  1.26it/s]                                                    88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2050/2320 [25:55<03:34,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2051/2320 [25:56<03:33,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2052/2320 [25:57<03:32,  1.26it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2053/2320 [25:58<03:35,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2054/2320 [25:59<03:33,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2055/2320 [25:59<03:31,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2056/2320 [26:00<03:30,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2057/2320 [26:01<03:32,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 2058/2320 [26:02<03:34,  1.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2059/2320 [26:03<03:35,  1.21it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2060/2320 [26:04<03:35,  1.20it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2061/2320 [26:04<03:31,  1.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2062/2320 [26:05<03:26,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2063/2320 [26:06<03:24,  1.26it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2064/2320 [26:07<03:23,  1.26it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2065/2320 [26:07<03:23,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2066/2320 [26:08<03:24,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2067/2320 [26:09<03:23,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2068/2320 [26:10<03:24,  1.23it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2069/2320 [26:11<03:24,  1.23it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2070/2320 [26:12<03:24,  1.23it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2071/2320 [26:12<03:23,  1.22it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2072/2320 [26:13<03:18,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2073/2320 [26:14<03:19,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2074/2320 [26:15<03:17,  1.25it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2075/2320 [26:16<03:18,  1.24it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2076/2320 [26:17<03:28,  1.17it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2077/2320 [26:17<03:21,  1.21it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2078/2320 [26:18<03:25,  1.17it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2079/2320 [26:19<03:25,  1.17it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2080/2320 [26:20<03:32,  1.13it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2081/2320 [26:21<03:27,  1.15it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2082/2320 [26:22<03:23,  1.17it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2083/2320 [26:22<03:19,  1.19it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2084/2320 [26:23<03:09,  1.24it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2085/2320 [26:24<03:08,  1.25it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2086/2320 [26:25<03:11,  1.22it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 2087/2320 [26:26<03:07,  1.24it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [26:26<02:47,  1.39it/s]{'eval_loss': 1.6652601957321167, 'eval_precision': 0.9195598558148359, 'eval_recall': 0.6590970900190373, 'eval_f1': 0.7678415841584159, 'eval_report': {'PAGE_HEADER': {'precision': 0.7023255813953488, 'recall': 0.4241573033707865, 'f1-score': 0.5288966725043783, 'support': 356.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.6992481203007519, 'recall': 0.38271604938271603, 'f1-score': 0.4946808510638298, 'support': 243.0}, 'INGREDIENT_LINE': {'precision': 0.7824532453245324, 'recall': 0.6653414405986904, 'f1-score': 0.7191607684529828, 'support': 4276.0}, 'INSTRUCTION_STEP': {'precision': 0.6140412155082082, 'recall': 0.7146341463414634, 'f1-score': 0.6605297764418561, 'support': 2460.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 14.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8576991392266703, 'recall': 0.887906647807638, 'f1-score': 0.8725415247758704, 'support': 14140.0}, 'accuracy': 0.8096212896622313, 'macro avg': {'precision': 0.45697091271943896, 'recall': 0.3843444484376618, 'f1-score': 0.40947619915486466, 'support': 21494.0}, 'weighted avg': {'precision': 0.8097200379656107, 'recall': 0.8096212896622313, 'f1-score': 0.8070283110869451, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[151, 0, 11, 26, 25, 0, 3, 140], [0, 0, 0, 0, 0, 0, 0, 5], [7, 0, 93, 13, 21, 0, 1, 108], [45, 1, 28, 2845, 141, 0, 4, 1212], [7, 0, 1, 90, 1758, 0, 0, 604], [0, 0, 0, 0, 0, 0, 0, 14], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 662, 918, 0, 0, 12555]], 'eval_PAGE_HEADER_precision': 0.24170616113744076, 'eval_PAGE_HEADER_recall': 0.46153846153846156, 'eval_PAGE_HEADER_f1': 0.31726283048211507, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.11235955056179775, 'eval_RECIPE_TITLE_recall': 0.2112676056338028, 'eval_RECIPE_TITLE_f1': 0.14669926650366746, 'eval_header_false_positive_rate': 0.10526315789473684, 'eval_title_false_negative_rate': 0.21100917431192662, 'eval_header_title_confusion_count': 84, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2030, 'O': 14499, 'INGREDIENT_LINE': 5035, 'PAGE_HEADER': 422, 'RECIPE_TITLE': 267, 'SECTION_HEADER': 9, 'TEMP': 18}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.316, 'eval_samples_per_second': 11.063, 'eval_steps_per_second': 2.766, 'epoch': 17.0}
{'loss': 0.0609, 'grad_norm': 1.9111589193344116, 'learning_rate': 7.662835249042145e-06, 'epoch': 17.24}
{'loss': 0.0539, 'grad_norm': 2.2151741981506348, 'learning_rate': 6.465517241379311e-06, 'epoch': 17.67}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.44it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.13it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.50it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.24it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.18it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.10it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  2.96it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.87it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.88it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.84it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.82it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.82it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.81it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.85it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.84it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.01it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  3.18it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  3.19it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:00,  3.10it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.07it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  3.00it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.29it/s][A                                                   
                                               [A 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2088/2320 [26:35<02:47,  1.39it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.29it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2089/2320 [26:40<17:55,  4.66s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2090/2320 [26:41<13:15,  3.46s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2091/2320 [26:41<10:03,  2.63s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2092/2320 [26:42<07:45,  2.04s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2093/2320 [26:43<06:10,  1.63s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2094/2320 [26:43<05:06,  1.36s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2095/2320 [26:44<04:20,  1.16s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2096/2320 [26:45<03:49,  1.02s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2097/2320 [26:45<03:24,  1.09it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2098/2320 [26:46<03:10,  1.17it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2099/2320 [26:47<02:58,  1.23it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [26:48<02:50,  1.29it/s]                                                    91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2100/2320 [26:48<02:50,  1.29it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2101/2320 [26:48<02:44,  1.33it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2102/2320 [26:49<02:37,  1.38it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2103/2320 [26:50<02:36,  1.38it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2104/2320 [26:50<02:37,  1.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2105/2320 [26:51<02:38,  1.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2106/2320 [26:52<02:38,  1.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2107/2320 [26:53<02:39,  1.33it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2108/2320 [26:53<02:35,  1.36it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2109/2320 [26:54<02:35,  1.36it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2110/2320 [26:55<02:36,  1.34it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2111/2320 [26:56<02:36,  1.33it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2112/2320 [26:56<02:36,  1.33it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2113/2320 [26:57<02:34,  1.34it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2114/2320 [26:58<02:32,  1.35it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2115/2320 [26:59<02:29,  1.37it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 2116/2320 [26:59<02:25,  1.40it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2117/2320 [27:00<02:23,  1.41it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2118/2320 [27:01<02:21,  1.42it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2119/2320 [27:01<02:24,  1.39it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2120/2320 [27:02<02:25,  1.38it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2121/2320 [27:03<02:25,  1.36it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2122/2320 [27:04<02:26,  1.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2123/2320 [27:04<02:23,  1.38it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2124/2320 [27:05<02:24,  1.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2125/2320 [27:06<02:23,  1.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2126/2320 [27:07<02:23,  1.35it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2127/2320 [27:07<02:23,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2128/2320 [27:08<02:22,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2129/2320 [27:09<02:22,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2130/2320 [27:10<02:20,  1.35it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2131/2320 [27:10<02:21,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2132/2320 [27:11<02:20,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2133/2320 [27:12<02:19,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2134/2320 [27:13<02:19,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2135/2320 [27:13<02:18,  1.34it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2136/2320 [27:14<02:19,  1.32it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2137/2320 [27:15<02:18,  1.32it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2138/2320 [27:16<02:17,  1.33it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2139/2320 [27:16<02:16,  1.33it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2140/2320 [27:17<02:12,  1.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2141/2320 [27:18<02:11,  1.36it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2142/2320 [27:18<02:08,  1.38it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2143/2320 [27:19<02:07,  1.38it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2144/2320 [27:20<02:05,  1.40it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2145/2320 [27:21<02:05,  1.40it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2146/2320 [27:22<02:19,  1.25it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2147/2320 [27:22<02:15,  1.28it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2148/2320 [27:23<02:13,  1.29it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2149/2320 [27:24<02:09,  1.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [27:25<02:09,  1.32it/s]                                                    93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2150/2320 [27:25<02:09,  1.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2151/2320 [27:25<02:08,  1.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2152/2320 [27:26<02:07,  1.32it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2153/2320 [27:27<02:05,  1.33it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2154/2320 [27:28<02:03,  1.34it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2155/2320 [27:28<02:02,  1.34it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2156/2320 [27:29<02:03,  1.33it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2157/2320 [27:30<02:04,  1.31it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2158/2320 [27:31<02:01,  1.34it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2159/2320 [27:31<01:58,  1.36it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2160/2320 [27:32<01:56,  1.37it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2161/2320 [27:33<01:55,  1.37it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2162/2320 [27:33<01:56,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2163/2320 [27:34<01:55,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2164/2320 [27:35<01:55,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2165/2320 [27:36<01:54,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2166/2320 [27:36<01:54,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2167/2320 [27:37<01:52,  1.36it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2168/2320 [27:38<01:52,  1.35it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2169/2320 [27:39<01:49,  1.38it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2170/2320 [27:39<01:49,  1.37it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2171/2320 [27:40<01:50,  1.34it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2172/2320 [27:41<01:49,  1.36it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2173/2320 [27:42<01:47,  1.37it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 2174/2320 [27:42<01:48,  1.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2175/2320 [27:43<01:47,  1.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2176/2320 [27:44<01:46,  1.35it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2177/2320 [27:45<01:44,  1.37it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2178/2320 [27:45<01:43,  1.38it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2179/2320 [27:46<01:40,  1.40it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2180/2320 [27:47<01:38,  1.42it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2181/2320 [27:47<01:41,  1.37it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2182/2320 [27:48<01:42,  1.34it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2183/2320 [27:49<01:44,  1.32it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2184/2320 [27:50<01:46,  1.27it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2185/2320 [27:51<01:46,  1.27it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2186/2320 [27:51<01:46,  1.26it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2187/2320 [27:52<01:45,  1.27it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2188/2320 [27:53<01:44,  1.26it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2189/2320 [27:54<01:43,  1.27it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2190/2320 [27:55<01:43,  1.26it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2191/2320 [27:55<01:42,  1.26it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2192/2320 [27:56<01:42,  1.25it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2193/2320 [27:57<01:41,  1.25it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2194/2320 [27:58<01:41,  1.24it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2195/2320 [27:59<01:40,  1.25it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2196/2320 [27:59<01:40,  1.24it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2197/2320 [28:00<01:39,  1.23it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2198/2320 [28:01<01:39,  1.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2199/2320 [28:02<01:39,  1.21it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [28:03<01:38,  1.22it/s]                                                    95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2200/2320 [28:03<01:38,  1.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2201/2320 [28:04<01:37,  1.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2202/2320 [28:04<01:36,  1.22it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 2203/2320 [28:05<01:34,  1.24it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [28:06<01:23,  1.38it/s]{'eval_loss': 1.6525229215621948, 'eval_precision': 0.9330825579093249, 'eval_recall': 0.7255233990147784, 'eval_f1': 0.8163159262146011, 'eval_report': {'PAGE_HEADER': {'precision': 0.7162790697674418, 'recall': 0.4624624624624625, 'f1-score': 0.5620437956204379, 'support': 333.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.6240601503759399, 'recall': 0.3672566371681416, 'f1-score': 0.4623955431754875, 'support': 226.0}, 'INGREDIENT_LINE': {'precision': 0.7505500550055005, 'recall': 0.7806064073226545, 'f1-score': 0.7652832305103757, 'support': 3496.0}, 'INSTRUCTION_STEP': {'precision': 0.6101990918616835, 'recall': 0.722199255890864, 'f1-score': 0.6614918591442636, 'support': 2419.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 17.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.9012843284601721, 'recall': 0.8796506200826777, 'f1-score': 0.8903360777432852, 'support': 14998.0}, 'accuracy': 0.8330696938680562, 'macro avg': {'precision': 0.4502965869338422, 'recall': 0.40152192286585003, 'f1-score': 0.4176938132742312, 'support': 21494.0}, 'weighted avg': {'precision': 0.8373041536231424, 'recall': 0.8330696938680562, 'f1-score': 0.8337443682807901, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[154, 0, 8, 28, 16, 0, 1, 126], [0, 0, 0, 0, 0, 0, 0, 5], [7, 0, 83, 18, 19, 0, 0, 99], [36, 1, 27, 2729, 61, 0, 7, 635], [9, 0, 4, 96, 1747, 0, 0, 563], [0, 0, 0, 0, 0, 0, 0, 17], [0, 0, 0, 0, 0, 0, 0, 0], [9, 0, 11, 765, 1020, 0, 0, 13193]], 'eval_PAGE_HEADER_precision': 0.24941176470588236, 'eval_PAGE_HEADER_recall': 0.4796380090497738, 'eval_PAGE_HEADER_f1': 0.3281733746130031, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.09236947791164658, 'eval_RECIPE_TITLE_recall': 0.1619718309859155, 'eval_RECIPE_TITLE_f1': 0.11764705882352942, 'eval_header_false_positive_rate': 0.08913649025069638, 'eval_title_false_negative_rate': 0.20673076923076922, 'eval_header_title_confusion_count': 75, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'O': 15278, 'INGREDIENT_LINE': 4291, 'INSTRUCTION_STEP': 2008, 'PAGE_HEADER': 425, 'RECIPE_TITLE': 249, 'SECTION_HEADER': 9, 'TEMP': 20}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.3696, 'eval_samples_per_second': 10.992, 'eval_steps_per_second': 2.748, 'epoch': 18.0}
{'loss': 0.0471, 'grad_norm': 2.852728843688965, 'learning_rate': 5.268199233716475e-06, 'epoch': 18.1}
{'loss': 0.0613, 'grad_norm': 2.9949374198913574, 'learning_rate': 4.07088122605364e-06, 'epoch': 18.53}
{'loss': 0.0496, 'grad_norm': 1.4622173309326172, 'learning_rate': 2.8735632183908046e-06, 'epoch': 18.97}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  5.69it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.19it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.41it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.30it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.19it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.08it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:05,  3.00it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.98it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  3.08it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:03,  3.11it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  3.05it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.86it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.78it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.85it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.76it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.74it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.76it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.78it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.80it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:07<00:00,  2.82it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.81it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.07it/s][A                                                   
                                               [A 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2204/2320 [28:14<01:23,  1.38it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:08<00:00,  3.07it/s][A
                                               [A/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2205/2320 [28:26<12:48,  6.68s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2206/2320 [28:27<09:17,  4.89s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2207/2320 [28:28<06:52,  3.65s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2208/2320 [28:28<05:08,  2.76s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2209/2320 [28:29<03:57,  2.14s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2210/2320 [28:30<03:07,  1.71s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2211/2320 [28:31<02:34,  1.41s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2212/2320 [28:31<02:10,  1.21s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2213/2320 [28:32<01:53,  1.06s/it] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2214/2320 [28:33<01:40,  1.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2215/2320 [28:33<01:32,  1.13it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2216/2320 [28:34<01:26,  1.20it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2217/2320 [28:35<01:23,  1.24it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2218/2320 [28:36<01:20,  1.26it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2219/2320 [28:36<01:19,  1.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2220/2320 [28:37<01:17,  1.30it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2221/2320 [28:38<01:16,  1.30it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2222/2320 [28:39<01:16,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2223/2320 [28:39<01:15,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2224/2320 [28:40<01:13,  1.31it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2225/2320 [28:41<01:11,  1.33it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2226/2320 [28:42<01:11,  1.32it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2227/2320 [28:42<01:11,  1.31it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2228/2320 [28:43<01:11,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2229/2320 [28:44<01:11,  1.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2230/2320 [28:45<01:10,  1.28it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2231/2320 [28:46<01:08,  1.30it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 2232/2320 [28:46<01:08,  1.29it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2233/2320 [28:47<01:08,  1.26it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2234/2320 [28:48<01:08,  1.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2235/2320 [28:49<01:08,  1.25it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2236/2320 [28:50<01:07,  1.24it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2237/2320 [28:50<01:06,  1.24it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2238/2320 [28:51<01:06,  1.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2239/2320 [28:52<01:05,  1.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2240/2320 [28:53<01:04,  1.23it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2241/2320 [28:54<01:03,  1.24it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2242/2320 [28:55<01:03,  1.23it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2243/2320 [28:55<01:01,  1.25it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2244/2320 [28:56<00:59,  1.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2245/2320 [28:57<00:58,  1.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2246/2320 [28:58<00:57,  1.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2247/2320 [28:58<00:54,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2248/2320 [28:59<00:51,  1.39it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2249/2320 [29:00<00:51,  1.37it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [29:00<00:52,  1.34it/s]                                                    97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2250/2320 [29:00<00:52,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2251/2320 [29:01<00:51,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2252/2320 [29:02<00:51,  1.33it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2253/2320 [29:03<00:50,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2254/2320 [29:03<00:49,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2255/2320 [29:04<00:48,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2256/2320 [29:05<00:47,  1.34it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2257/2320 [29:06<00:46,  1.36it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2258/2320 [29:06<00:46,  1.33it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2259/2320 [29:07<00:46,  1.30it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2260/2320 [29:08<00:46,  1.29it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 2261/2320 [29:09<00:44,  1.32it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2262/2320 [29:09<00:44,  1.31it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2263/2320 [29:10<00:43,  1.30it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2264/2320 [29:11<00:43,  1.29it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2265/2320 [29:12<00:42,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2266/2320 [29:13<00:41,  1.29it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2267/2320 [29:13<00:41,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2268/2320 [29:14<00:40,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2269/2320 [29:15<00:39,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2270/2320 [29:16<00:39,  1.25it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2271/2320 [29:17<00:39,  1.26it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2272/2320 [29:17<00:37,  1.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2273/2320 [29:18<00:37,  1.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2274/2320 [29:19<00:36,  1.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2275/2320 [29:20<00:35,  1.26it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2276/2320 [29:21<00:34,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2277/2320 [29:21<00:33,  1.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2278/2320 [29:22<00:33,  1.27it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2279/2320 [29:23<00:32,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2280/2320 [29:24<00:31,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2281/2320 [29:24<00:30,  1.28it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2282/2320 [29:25<00:29,  1.29it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2283/2320 [29:26<00:27,  1.35it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2284/2320 [29:27<00:26,  1.36it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2285/2320 [29:27<00:26,  1.34it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2286/2320 [29:28<00:25,  1.34it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2287/2320 [29:29<00:24,  1.34it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2288/2320 [29:30<00:24,  1.31it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2289/2320 [29:30<00:24,  1.27it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 2290/2320 [29:31<00:24,  1.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2291/2320 [29:32<00:24,  1.19it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2292/2320 [29:33<00:24,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2293/2320 [29:34<00:23,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2294/2320 [29:35<00:22,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2295/2320 [29:36<00:21,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2296/2320 [29:37<00:21,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2297/2320 [29:38<00:20,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2298/2320 [29:39<00:19,  1.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2299/2320 [29:39<00:18,  1.13it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [29:40<00:17,  1.14it/s]                                                    99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2300/2320 [29:40<00:17,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2301/2320 [29:41<00:16,  1.14it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2302/2320 [29:42<00:15,  1.15it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2303/2320 [29:43<00:15,  1.11it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2304/2320 [29:44<00:14,  1.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2305/2320 [29:45<00:13,  1.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2306/2320 [29:46<00:12,  1.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2307/2320 [29:47<00:11,  1.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2308/2320 [29:47<00:10,  1.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2309/2320 [29:48<00:09,  1.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2310/2320 [29:49<00:08,  1.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2311/2320 [29:50<00:08,  1.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2312/2320 [29:51<00:07,  1.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2313/2320 [29:52<00:06,  1.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2314/2320 [29:53<00:05,  1.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2315/2320 [29:54<00:04,  1.04it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2316/2320 [29:55<00:03,  1.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2317/2320 [29:55<00:02,  1.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2318/2320 [29:56<00:01,  1.18it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 2319/2320 [29:57<00:00,  1.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [29:58<00:00,  1.37it/s]/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.6129248142242432, 'eval_precision': 0.9311278777326368, 'eval_recall': 0.6958218881017783, 'eval_f1': 0.7964587125599868, 'eval_report': {'PAGE_HEADER': {'precision': 0.6930232558139535, 'recall': 0.44345238095238093, 'f1-score': 0.5408348457350273, 'support': 336.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.6766917293233082, 'recall': 0.3879310344827586, 'f1-score': 0.4931506849315068, 'support': 232.0}, 'INGREDIENT_LINE': {'precision': 0.7568756875687569, 'recall': 0.7389903329752954, 'f1-score': 0.7478260869565218, 'support': 3724.0}, 'INSTRUCTION_STEP': {'precision': 0.6363953894516242, 'recall': 0.7002305918524212, 'f1-score': 0.6667886550777676, 'support': 2602.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8805847793414401, 'recall': 0.884269740001372, 'f1-score': 0.8824234126304981, 'support': 14577.0}, 'accuracy': 0.823625197729599, 'macro avg': {'precision': 0.45544635518738535, 'recall': 0.3943592600330285, 'f1-score': 0.4163779606664152, 'support': 21494.0}, 'weighted avg': {'precision': 0.8235153292768141, 'recall': 0.823625197729599, 'f1-score': 0.8225135377930719, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[149, 0, 8, 21, 22, 0, 1, 135], [0, 0, 0, 0, 0, 0, 0, 5], [5, 0, 90, 16, 18, 0, 0, 103], [47, 1, 31, 2752, 57, 0, 7, 829], [9, 0, 4, 109, 1822, 0, 0, 658], [0, 0, 0, 0, 0, 0, 0, 18], [0, 0, 0, 0, 0, 0, 0, 0], [5, 0, 0, 738, 944, 0, 0, 12890]], 'eval_PAGE_HEADER_precision': 0.24691358024691357, 'eval_PAGE_HEADER_recall': 0.45248868778280543, 'eval_PAGE_HEADER_f1': 0.31948881789137384, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1124031007751938, 'eval_RECIPE_TITLE_recall': 0.20422535211267606, 'eval_RECIPE_TITLE_f1': 0.145, 'eval_header_false_positive_rate': 0.10335195530726257, 'eval_title_false_negative_rate': 0.20093457943925233, 'eval_header_title_confusion_count': 80, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2190, 'O': 14941, 'INGREDIENT_LINE': 4454, 'PAGE_HEADER': 405, 'RECIPE_TITLE': 258, 'SECTION_HEADER': 9, 'TEMP': 23}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.5621, 'eval_samples_per_second': 10.745, 'eval_steps_per_second': 2.686, 'epoch': 19.0}
{'loss': 0.0386, 'grad_norm': 4.987672328948975, 'learning_rate': 1.6762452107279694e-06, 'epoch': 19.4}
{'loss': 0.0483, 'grad_norm': 6.413251876831055, 'learning_rate': 4.789272030651341e-07, 'epoch': 19.83}

  0%|          | 0/23 [00:00<?, ?it/s][A
  9%|â–Š         | 2/23 [00:00<00:03,  6.16it/s][A
 13%|â–ˆâ–Ž        | 3/23 [00:00<00:04,  4.40it/s][A
 17%|â–ˆâ–‹        | 4/23 [00:01<00:05,  3.60it/s][A
 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.38it/s][A
 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.29it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.15it/s][A
 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.03it/s][A
 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  2.95it/s][A
 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.96it/s][A
 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.97it/s][A
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.93it/s][A
 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.90it/s][A
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.87it/s][A
 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  2.86it/s][A
 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  2.90it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:02,  2.91it/s][A
 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.91it/s][A
 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  2.96it/s][A
 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:01,  2.87it/s][A
 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  2.87it/s][A
 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  2.87it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.27it/s][A                                                   
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [30:21<00:00,  1.37it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.27it/s][A
                                               [A                                                   100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [30:26<00:00,  1.37it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2320/2320 [30:26<00:00,  1.27it/s]
2026-01-13 11:41:47,547 [INFO] Saving final model to models/layoutlmv3_v3_manual...
2026-01-13 11:41:52,722 [INFO] 
================================================================================
2026-01-13 11:41:52,723 [INFO] FINAL EVALUATION
2026-01-13 11:41:52,723 [INFO] ================================================================================
2026-01-13 11:41:52,724 [INFO] 
Evaluating on validation...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
{'eval_loss': 1.6549062728881836, 'eval_precision': 0.9317292644757433, 'eval_recall': 0.7193777375018879, 'eval_f1': 0.8118980652859457, 'eval_report': {'PAGE_HEADER': {'precision': 0.6511627906976745, 'recall': 0.4472843450479233, 'f1-score': 0.5303030303030303, 'support': 313.0}, 'SECTION_HEADER': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5.0}, 'RECIPE_TITLE': {'precision': 0.6090225563909775, 'recall': 0.391304347826087, 'f1-score': 0.4764705882352941, 'support': 207.0}, 'INGREDIENT_LINE': {'precision': 0.75, 'recall': 0.7833955759839126, 'f1-score': 0.7663341295489673, 'support': 3481.0}, 'INSTRUCTION_STEP': {'precision': 0.633950401676563, 'recall': 0.6988833269156719, 'f1-score': 0.6648351648351648, 'support': 2597.0}, 'TEMP': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18.0}, 'SERVINGS': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 0.0}, 'O': {'precision': 0.8969121464680967, 'recall': 0.8827405365427284, 'f1-score': 0.8897699163023958, 'support': 14873.0}, 'accuracy': 0.8324183493067833, 'macro avg': {'precision': 0.44263098690416397, 'recall': 0.4004510165395404, 'f1-score': 0.41596410365310654, 'support': 21494.0}, 'weighted avg': {'precision': 0.8340362505925069, 'recall': 0.8324183493067833, 'f1-score': 0.8324345516633462, 'support': 21494.0}}, 'eval_labels': ['PAGE_HEADER', 'SECTION_HEADER', 'RECIPE_TITLE', 'INGREDIENT_LINE', 'INSTRUCTION_STEP', 'TEMP', 'SERVINGS', 'O'], 'eval_confusion_matrix': [[140, 0, 7, 25, 15, 0, 1, 125], [0, 0, 0, 0, 0, 0, 0, 5], [5, 0, 81, 14, 16, 0, 0, 91], [48, 1, 31, 2727, 55, 0, 7, 612], [11, 0, 7, 106, 1815, 0, 0, 658], [0, 0, 0, 0, 0, 0, 0, 18], [0, 0, 0, 0, 0, 0, 0, 0], [11, 0, 7, 764, 962, 0, 0, 13129]], 'eval_PAGE_HEADER_precision': 0.24242424242424243, 'eval_PAGE_HEADER_recall': 0.4343891402714932, 'eval_PAGE_HEADER_f1': 0.31118314424635335, 'eval_SECTION_HEADER_precision': 0.0, 'eval_SECTION_HEADER_recall': 0.0, 'eval_SECTION_HEADER_f1': 0.0, 'eval_RECIPE_TITLE_precision': 0.1078838174273859, 'eval_RECIPE_TITLE_recall': 0.18309859154929578, 'eval_RECIPE_TITLE_f1': 0.13577023498694518, 'eval_header_false_positive_rate': 0.09943181818181818, 'eval_title_false_negative_rate': 0.18840579710144928, 'eval_header_title_confusion_count': 74, 'eval_total_tokens': 22280, 'eval_true_label_distribution': {'O': 14856, 'INGREDIENT_LINE': 4167, 'INSTRUCTION_STEP': 2885, 'PAGE_HEADER': 221, 'RECIPE_TITLE': 142, 'SERVINGS': 8, 'SECTION_HEADER': 1}, 'eval_pred_label_distribution': {'INSTRUCTION_STEP': 2178, 'O': 15168, 'INGREDIENT_LINE': 4265, 'PAGE_HEADER': 396, 'RECIPE_TITLE': 241, 'SECTION_HEADER': 9, 'TEMP': 23}, 'eval_title_anchor_accuracy': 0.6666666666666666, 'eval_pages_with_title': 6, 'eval_pages_with_correct_anchor': 4, 'eval_anchor_iou_threshold': 0.3, 'eval_runtime': 8.5636, 'eval_samples_per_second': 10.743, 'eval_steps_per_second': 2.686, 'epoch': 20.0}
{'train_runtime': 1826.1561, 'train_samples_per_second': 5.071, 'train_steps_per_second': 1.27, 'train_loss': 0.48783283092338464, 'epoch': 20.0}
  0%|          | 0/23 [00:00<?, ?it/s]  9%|â–Š         | 2/23 [00:00<00:03,  5.61it/s] 13%|â–ˆâ–Ž        | 3/23 [00:00<00:05,  3.66it/s] 17%|â–ˆâ–‹        | 4/23 [00:01<00:06,  3.14it/s] 22%|â–ˆâ–ˆâ–       | 5/23 [00:01<00:05,  3.10it/s] 26%|â–ˆâ–ˆâ–Œ       | 6/23 [00:01<00:05,  3.10it/s] 30%|â–ˆâ–ˆâ–ˆ       | 7/23 [00:02<00:05,  3.11it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 8/23 [00:02<00:04,  3.07it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 9/23 [00:02<00:04,  3.02it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 10/23 [00:03<00:04,  2.97it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 11/23 [00:03<00:04,  2.90it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 12/23 [00:03<00:03,  2.95it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 13/23 [00:04<00:03,  2.94it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 14/23 [00:04<00:03,  2.94it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 15/23 [00:04<00:02,  3.03it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 16/23 [00:05<00:02,  3.03it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 17/23 [00:05<00:01,  3.00it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 18/23 [00:05<00:01,  2.98it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 19/23 [00:06<00:01,  3.04it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 20/23 [00:06<00:00,  3.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 21/23 [00:06<00:00,  3.12it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 22/23 [00:07<00:00,  3.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  3.50it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 23/23 [00:07<00:00,  2.97it/s]
2026-01-13 11:42:01,123 [INFO] 
Evaluating on test...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/16 [00:00<?, ?it/s] 12%|â–ˆâ–Ž        | 2/16 [00:00<00:02,  5.84it/s] 19%|â–ˆâ–‰        | 3/16 [00:00<00:03,  4.10it/s] 25%|â–ˆâ–ˆâ–Œ       | 4/16 [00:01<00:03,  3.42it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 5/16 [00:01<00:03,  3.25it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 6/16 [00:01<00:03,  3.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 7/16 [00:02<00:03,  2.99it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 8/16 [00:02<00:02,  2.97it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 9/16 [00:02<00:02,  2.92it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 10/16 [00:03<00:02,  2.87it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 11/16 [00:03<00:01,  2.92it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 12/16 [00:03<00:01,  2.91it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 13/16 [00:04<00:01,  2.82it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 14/16 [00:04<00:00,  2.82it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 15/16 [00:04<00:00,  3.15it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 16/16 [00:05<00:00,  3.07it/s]
2026-01-13 11:42:06,804 [INFO] 
Evaluating on demo_eval...
/home/jerome/projects/cookbookAI/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py:1126: FutureWarning: The `device` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
  0%|          | 0/2 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 12.68it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  9.53it/s]
2026-01-13 11:42:07,485 [INFO] âœ“ Training complete!
2026-01-13 11:42:07,485 [INFO] âœ“ Model saved to: models/layoutlmv3_v3_manual
2026-01-13 11:42:07,485 [INFO] âœ“ Report saved to: models/layoutlmv3_v3_manual/training_report.json

================================================================================
DEMO SCORECARD - Header-Aware Evaluation
================================================================================

ðŸ“ Title Anchor Accuracy
  Anchor Accuracy (IoU >= 0.3): 0.0%
  Pages with correct anchor: 0 / 0

ðŸŽ¯ Recipe Title Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ“„ Page Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

ðŸ”€ Section Header Performance
  Precision: 0.0%
  Recall:    0.0%
  F1:        0.0%

âš ï¸  Critical Errors
  Headerâ†’Title confusion count: 0
  Header false positive rate:   0.0%
  Title false negative rate:    0.0%

ðŸ“Š Ingredient & Instruction F1
  Ingredients: 0.0%
  Instructions: 0.0%
================================================================================


================================================================================
TRAINING SUMMARY
================================================================================
Best checkpoint: models/layoutlmv3_v3_manual
Demo eval title anchor accuracy: 0.0%
Demo eval headerâ†’title confusion: 0 tokens
================================================================================

